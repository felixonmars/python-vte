2009-03-31  Adam Jackson  <ajax@redhat.com>

	* src/deepinvteapp.c:
	Add gopher:// to the dingus-click regexes.

2009-03-26  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (always_selected):
	* src/deepinvtepangocairo.c (_deepinvte_pangocairo_set_background_image):
	* src/deepinvteskel.c (_deepinvte_skel_draw_text):
	Minor fixes from Richard Russon.

2009-03-26  Behdad Esfahbod  <behdad@gnome.org>

	Bug 576797 – Double-click sometimes stops working

	* src/deepinvte.c (deepinvte_terminal_extend_selection): Invalidate selection
	if forced.

2009-03-26  Behdad Esfahbod  <behdad@gnome.org>

	Bug 573674 – reset resets width to 80 chars

	* src/deepinvteseq.c (deepinvte_sequence_handler_decset_internal): Disable
	resizing on decreset.

2009-03-23  Behdad Esfahbod  <behdad@gnome.org>

	Bug 576504 – deepinvte does not pass its testsuite.

	* src/deepinvte.c:
	* src/deepinvtedraw.h:
	Fix "make check".

2009-03-15  Christian Persch  <chpe@gnome.org>

	Bug 574491 – gnome-pty-helper can prevent volumes from being unmounted

	* gnome-pty-helper/gnome-pty-helper.c: (main): chdir to /.

2009-03-15  Christian Persch  <chpe@gnome.org>

	* configure.in: Prepare version 0.20.0.

2009-03-15  Christian Persch  <chpe@gnome.org>

	Bug 575398 – configure warns about term.h under OpenSolaris

	* configure.in: Fix curses detection on solaris. Patch by David	Adam.

2009-03-09  Behdad Esfahbod  <behdad@gnome.org>

	Bug 574616 – "real" transparency not working from python bindings

	* src/deepinvtepangocairo.c (_deepinvte_pangocairo_destroy),
	(_deepinvte_pangocairo_set_background_image): Better handle failure of
	creating pixmap.

	* src/deepinvtebg.c (deepinvte_bg_get_pixmap): Get rid of unused mask parameter.

2009-03-07  Behdad Esfahbod  <behdad@gnome.org>

	Bug 574025 – Crash in _deepinvte_terminal_insert_char

	* src/deepinvte.c (_deepinvte_terminal_insert_char): Don't crash.

2009-03-02  Christian Persch  <chpe@gnome.org>

	* NEWS:
	* configure.in: Updated for version 0.19.5.

2009-03-02  Christian Persch  <chpe@gnome.org>

	* src/deepinvteaccess.c: (deepinvte_terminal_accessible_set_size),
	(deepinvte_terminal_accessible_ref_accessible_at_point):
	* src/deepinvteapp.c: (button_pressed): Correct use of padding returned
        by deepinvte_terminal_get_padding().

2009-03-02  Christian Persch  <chpe@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_refresh_size), (deepinvte_terminal_set_size):
	Use g_strerror() instead of strerror().

2009-02-12  Behdad Esfahbod  <behdad@gnome.org>

	Bug 54926 – Should try bold version of font before pseudo-bolding

	Patch from Kees Cook <kees@outflux.net>

	* src/deepinvte.c (_deepinvte_invalidate_cell), (_deepinvte_invalidate_cursor_once),
	(deepinvte_terminal_unichar_is_local_graphic),
	(deepinvte_terminal_draw_graphic), (deepinvte_terminal_draw_cells),
	(deepinvte_terminal_draw_rows), (deepinvte_terminal_paint_cursor):
	* src/deepinvtedraw.c (_deepinvte_draw_get_char_width), (_deepinvte_draw_text),
	(_deepinvte_draw_char), (_deepinvte_draw_has_char):
	* src/deepinvtedraw.h:
	* src/deepinvtepangocairo.c (_deepinvte_pangocairo_set_text_font),
	(_deepinvte_pangocairo_get_char_width), (_deepinvte_pangocairo_has_bold),
	(_deepinvte_pangocairo_draw_text), (_deepinvte_pangocairo_draw_has_char):
	* src/deepinvteskel.c:
	Try bold font before pseudo-bolding.

2009-02-02  Christian Persch  <chpe@gnome.org>

	Bug 570208 – deepinvte fails to build outside source tree

	* python/Makefile.am: Build fix.

2009-02-01  Christian Persch  <chpe@gnome.org>

	* src/marshal.list:
	* src/deepinvte.c: (deepinvte_terminal_class_init):
	* src/deepinvtebg.c: (deepinvte_bg_class_init): Remove marshalers that have stock
	ones in gobject, and use the stock ones instead.

2009-02-01  Behdad Esfahbod  <behdad@gnome.org>

	* configure.in: Require GTK+ >= 2.14, for "gtk-fontconfig-timestamp"
	settings property.

	* src/deepinvte.c (deepinvte_terminal_style_set),
	(deepinvte_terminal_set_font_full_internal), (deepinvte_terminal_init),
	(deepinvte_terminal_class_init):  Use style_set class method instead of
	hooking to style-set signal.  Also, proceed to recreating the font
	even if neither description nor antialias setting changed.  This is
	necessary to pick up fontconfig configuration changes as well as font
	install/uninstallations or GNOME font preferences changes.

	* src/deepinvtepangocairo.c (font_info_destroy),
	(fontconfig_timestamp_quark),
	(deepinvte_pango_cairo_set_fontconfig_timestamp),
	(deepinvte_pango_cairo_get_fontconfig_timestamp), (context_hash),
	(context_equal), (font_info_create_for_context),
	(font_info_create_for_screen):
	Use fontconfig_timestamp in the font object hash, such that we respond
	to fontconfig configuration changes.

2009-01-22  Saleem Abdulrasool <compnerd@compnerd.org>

	* src/deepinvteseq.c (deepinvte_sequence_handler_window_manipulation):
		Tweak output for OSC 13, 14, 18, 19, 20, 21.  Bug #548272.

2009-01-20  Christian Persch  <chpe@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_realize): Use GDK_BLANK_CURSOR for the
	invisible cursor on gtk+ >= 2.15.

2009-01-20  Christian Persch  <chpe@gnome.org>

	* gnome-pty-helper/gnome-pty-helper.c: (init_term_with_defaults),
	(open_ptys), (close_pty_pair): Use ttyname() as recommended in the
	glibc manual. Bug #565688.

2009-01-06  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c (deepinvte_parse_color),
	(deepinvte_sequence_handler_change_color),
	(deepinvte_sequence_handler_request_terminal_parameters),
	(deepinvte_sequence_handler_send_primary_device_attributes),
	(deepinvte_sequence_handler_send_secondary_device_attributes),
	(deepinvte_sequence_handler_device_status_report),
	(deepinvte_sequence_handler_dec_device_status_report),
	(deepinvte_sequence_handler_window_manipulation),
	(deepinvte_sequence_handler_change_cursor_color):
	Convert some g_strdup_printf() uses to g_snprintf() when
	the buffer was fixed-size and freed immediately.
	Also fix g_snprintf usage by not using its return value.
	*If* the buffer is short, the returned len is not what we
	are interested in.
	Finally, pass -1 as len to deepinvte_terminal_feed_child() in
	most places.  This means a bit more work for the processor,
	but cleaner code.

2009-01-06  Behdad Esfahbod  <behdad@gnome.org>

	Bug 566795 – DEEPINVTE fails to build in trunk

	* src/deepinvteseq.c (deepinvte_sequence_handler_change_cursor_color):
	Fix build.

2009-01-06  Saleem Abdulrasool <compnerd@compnerd.org>

	* src/deepinvteseq-n.gperf:
	* src/deepinvteseq.c (deepinvte_ucs4_to_utf8), (deepinvte_parse_color),
	(deepinvte_terminal_emit_deiconify_window), (deepinvte_sequence_handler_change_color),
	(deepinvte_sequence_handler_change_cursor_color):

	Bug #524170 - Pull out ucs4_to_utf8 and use in new functions.  Add support
	for OSC 4 (initc) and OSC 12 (change cursor color).

2009-01-06  Behdad Esfahbod  <behdad@gnome.org>

	Bug 566730 – deepinvte_terminal_set_color_cursor() calls invalidate_all but
	it doesn't have to

	* src/deepinvte.c (deepinvte_terminal_set_color_internal): If color is DEEPINVTE_CUR_BG,
	invalidate_cursor_once instead of invalidate_all.

2008-12-26  Halton Huo  <halton.huo@sun.com>

	Bug 565679 – alloca is discouraged

	* gnome-pty-helper/gnome-pty-helper.c: use malloc replace alloca.

2008-12-26  Christian Persch  <chpe@gnome.org>

	* configure.in: Fix the same typo also in the libinfo check.

2008-12-26  Halton Huo  <halton.huo@sun.com>

	Bug 565675 – typo in configure.in cause ncurses checking fail

	* configure.in: Fix typo for ncurses. s/ncuses/ncurses

2008-12-25  Behdad Esfahbod  <behdad@gnome.org>

	* src/interpret.c (main):
	* src/slowcat.c (catfile):
	* src/table.c (_deepinvte_table_addi), (_deepinvte_table_add):
	* src/trie.c (_deepinvte_trie_matchx):
	* src/deepinvte.c (_deepinvte_invalidate_cell), (_deepinvte_terminal_insert_char):
	* src/deepinvteaccess.c (offset_from_xy),
	(deepinvte_terminal_accessible_finalize),
	(deepinvte_terminal_accessible_get_text),
	(deepinvte_terminal_accessible_get_text_somewhere):
	* src/deepinvteapp.c (main):
	* src/deepinvtebg.c (deepinvte_bg_cache_item_free), (deepinvte_bg_cache_add):
	Fix warnings.

2008-12-25  Behdad Esfahbod  <behdad@gnome.org>

	Bug 565663 – compile failure because use static function in another .h
	file

	* src/deepinvte.c: Don't mark extern function inline.

2008-12-17  Behdad Esfahbod  <behdad@gnome.org>

	Bug 149631 – gnome-terminal doesn't combine combining chars in utf8

	* src/deepinvteunistr.c:
	Limit to 9 combining marks per unistr, and a total of 100,000 unistrs.
	All to prevent OOM.

2008-12-15  Behdad Esfahbod  <behdad@gnome.org>

	* NEWS:
	* configure.in:
	Released 0.19.4.

2008-12-14  Behdad Esfahbod  <behdad@gnome.org>

	Bug 564535 – check for gperf on build

	* autogen.sh: Check for gperf.

2008-12-12  Behdad Esfahbod  <behdad@gnome.org>

	* doc/reference/Makefile.am:
	* src/deepinvteunistr.c (unistr_comp_hash), (unistr_comp_equal),
	(_deepinvte_unistr_append_unichar), (_deepinvte_unistr_get_base),
	(_deepinvte_unistr_append_to_string), (_deepinvte_unistr_strlen):
	* src/deepinvteunistr.h:
	Document deepinvteunistr.

2008-12-12  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteunistr.h: Minor cleanup.

2008-12-12  Behdad Esfahbod  <behdad@gnome.org>

	* src/iso2022.c (_deepinvte_iso2022_ambiguous_width): Avoid pointers in the
	const array.

2008-12-12  Behdad Esfahbod  <behdad@gnome.org>

	Bug 149631 – gnome-terminal doesn't combine combining chars in utf8

	* src/deepinvteunistr.c:
	* src/deepinvteunistr.h:
	An extended UTF-32 type that assigns numeric values to UTF-8 sequences
	on demand.  Can be used to efficiently store a string, instead of one
	character, at each cell.

	* src/deepinvte-private.h:
	* src/deepinvte.c:
	* src/deepinvtedraw.c:
	* src/deepinvtedraw.h:
	* src/deepinvtepangocairo.c:
	Port to deepinvteunistr instead of gunichar for cell content.
	
	* src/deepinvte.c:
	Handle zerowidth insertions by sticking it on the previous cell.

	* src/iso2022.h:
	* src/iso2022.c:
	Cleanup ambiguous-width handling.  Handle zero-width chars.

2008-12-11  Christian Persch  <chpe@gnome.org>

	Bug 564057 – src/pty.c does not compile with
	--disable-gnome-pty-helper
	
	* src/pty.c: Build with --disable-gnome-pty-helper. Patch by
	yselkowitz at users.sourceforge.net .

2008-12-11  Christian Persch  <chpe@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_class_init): Update set-scroll-adjustement
	docs.

2008-12-10  Paolo Borelli  <pborelli@katamail.com>

	Bug 562695 - ship pkg-config file for python bindings

	* configure.in:
	* python/Makefile.am:
	* python/pydeepinvte.pc.in:

2008-12-08  Behdad Esfahbod  <behdad@gnome.org>

	Bug 563752 – pangocairo backend recreates cairo_surface_t for
	background drawing

	* src/deepinvte.c (deepinvte_terminal_paint),
	(deepinvte_terminal_set_scroll_background),
	(deepinvte_terminal_background_update):
	* src/deepinvtedraw.c (_deepinvte_draw_new), (_deepinvte_draw_set_background_solid),
	(_deepinvte_draw_set_background_image),
	(_deepinvte_draw_set_background_scroll), (_deepinvte_draw_draw_rectangle):
	* src/deepinvtedraw.h:
	* src/deepinvtepangocairo.c (_deepinvte_pangocairo_destroy),
	(_deepinvte_pangocairo_set_background_solid),
	(_deepinvte_pangocairo_set_background_image),
	(_deepinvte_pangocairo_set_background_scroll), (_deepinvte_pangocairo_clear),
	(_deepinvte_pangocairo_clip), (set_source_color_alpha):
	* src/deepinvteskel.c:
	Cleanup deepinvte_draw background API.  Use a cached cairo_pattern_t in
	pangocairo backend.

	Also, queue background update on scroll_background change.

2008-12-07  Behdad Esfahbod  <behdad@gnome.org>

	Bug 163213 – Cursor should remain visible when selected

	* src/deepinvte.c (deepinvte_terminal_paint_cursor): Do a reverse hollow cursor
	if selected but not focused.

2008-12-05  Christian Persch  <chpe@gnome.org>

	* src/deepinvtebg.c: (deepinvte_bg_get_pixmap): Don't modify source_pixbuf. If
	we're going to change the saturation, first make a copy. Fixes
	switching background type between fauxtransparency and image in
	gnome-terminal trunk.

2008-12-05  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtepangocairo.c (_deepinvte_pangocairo_clear): Fix scrolling offset.
	Ray Strode reported that background offset was being done incorrectly.
	A negation did it.

2008-12-05  Behdad Esfahbod  <behdad@gnome.org>

	* Makefile.am:
	* configure.in:
	Hook up perf/.

	Also adjust svn:ignore props.

2008-12-05  Behdad Esfahbod  <behdad@gnome.org>

	* NEWS:
	* configure.in:
	Released 0.19.3.

2008-12-05  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (_deepinvte_new_row_data), (_deepinvte_new_row_data_sized),
	(deepinvte_terminal_match_contents_refresh),
	(deepinvte_terminal_process_incoming), (deepinvte_terminal_init),
	(deepinvte_terminal_set_word_chars):
	Always call g_array_new() with clear flag set.  It incurs no overhead
	but avoids heisenbugs.

2008-12-05  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (_deepinvte_terminal_insert_char):
	* src/deepinvteseq.c (deepinvte_sequence_handler_screen_alignment_test):
	Use structure assignment instead of memcpy().

2008-12-05  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (_deepinvte_terminal_cleanup_tab_fragments_at_cursor): Remove
	unneeded checks.  They were masking bugs.

2008-12-05  Behdad Esfahbod  <behdad@gnome.org>

	Red Hat Bug 474618 -  gnome-terminal sometime leaves empty begining
	of the line

	* src/deepinvte.c (_deepinvte_terminal_insert_char): Really fix the bug this time.

2008-12-05  Behdad Esfahbod  <behdad@gnome.org>

	* src/Makefile.am:
	Build fixes.

	* NEWS:
	* configure.in:
	Released 0.19.2.

2008-12-05  Behdad Esfahbod  <behdad@gnome.org>

	Red Hat Bug 474618 -  gnome-terminal sometime leaves empty begining
	of the line

	* src/deepinvte.c (_deepinvte_terminal_cleanup_tab_fragments_at_cursor): continue
	instead of break'ing out of the loop.

2008-12-04  Behdad Esfahbod  <behdad@gnome.org>

	Bug 563274 – Misspelled word in src code

	* src/deepinvte.c (deepinvte_terminal_process_incoming): Fix typo.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	Bug 563024 – In alternate-screen, selection can copy out of screen
	boundaries

	* src/deepinvte.c (deepinvte_terminal_extend_selection_expand),
	(deepinvte_terminal_extend_selection): Make sure current selection row is in the
	visible screen.

	I have a deja vu of fixing this bug like two years ago...

2008-12-02  Christian Persch  <chpe@gnome.org>

	Bug 552096 – Detect tgetent if provided by libtinfo

	* configure.in: Rewrote tgetent checks to be more readable. Also check
	for tgetent in libtinfo.
	* src/keymap.c: (_deepinvte_keymap_map), (_deepinvte_keymap_key_is_modifier):
	* src/ssfe.c: Adjust includes accordingly.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_start_selection),
	(deepinvte_terminal_extend_selection): Don't do fancy rounding for row
	selection, only for column.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_invalidate_selection),
	(deepinvte_terminal_start_selection): Call function instead of open coding.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtedraw.h:
	* src/deepinvtepangocairo.c (font_info_cache_ascii):
	Cache the full ASCII range if Latin uses the default language.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtepangocairo.c (context_hash), (context_equal),
	(font_info_create_for_context), (font_info_create_for_screen),
	(font_info_create_for_widget): Respect PangoLanguage set on a widget's
	PangoContext.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtepangocairo.c (font_info_measure_font): Remove CJK fullwidth
	measurement hacks.  Pango doesn't need these.  We're down to one
	FcFontSort() instead of two during initialization.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	Bug 559818 – redundant selection-changed signal on deselection

	* src/deepinvte.c (deepinvte_terminal_start_selection),
	(deepinvte_terminal_extend_selection): Fix all redundant selection-changed
	signals.  Including those on double-click.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte-private.h:
	* src/deepinvte.c:
	Rewrite text selection.  In particular, fix block_mode.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* HACKING: Update.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte-private.h:
	* src/deepinvte.c (_deepinvte_terminal_set_pointer_visible),
	(deepinvte_terminal_get_mouse_tracking_info),
	(deepinvte_terminal_send_mouse_button_internal),
	(deepinvte_terminal_maybe_send_mouse_button),
	(deepinvte_terminal_maybe_send_mouse_drag), (deepinvte_terminal_motion_notify),
	(deepinvte_terminal_button_press), (deepinvte_terminal_button_release),
	(deepinvte_terminal_scroll), (deepinvte_terminal_reset):
	* src/deepinvteseq.c (deepinvte_sequence_handler_decset_internal):
	Mouse tracking cleanup.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* configure.in: Add -Wno-switch-enum warning flag as we are not
	-Wswitch-enum clean.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_extend_selection_on_type),
	(deepinvte_terminal_extend_selection):
	Cut one third of the 400-line function out into a function of its own.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_extend_selection): Revert previous change.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_extend_selection):  Add a shortcircuit
	check.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_terminal_send_mouse_button_internal),
	(deepinvte_terminal_maybe_send_mouse_drag), (cursor_inside_match),
	(deepinvte_terminal_match_hilite_show),
	(deepinvte_terminal_match_hilite_update), (deepinvte_terminal_match_hilite),
	(deepinvte_terminal_extend_selection), (deepinvte_terminal_autoscroll),
	(deepinvte_terminal_motion_notify), (deepinvte_terminal_button_press),
	(deepinvte_terminal_button_release):
	Change mouse coordinates type from double to long.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_terminal_start_selection),
	(deepinvte_terminal_extend_selection):
	Cleanup selection code a bit more.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_terminal_start_selection),
	(deepinvte_terminal_extend_selection):
	Merge selection_origin and selection_restart_origin as only one was
	being used at a time.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	Bug 471480 – select single character
	Bug 110371 – Cannot select newline at end of full line

	* src/deepinvte-private.h:
	* src/deepinvte.c (find_start_column), (find_end_column),
	(deepinvte_terminal_start_selection), (math_div),
	(deepinvte_terminal_extend_selection):
	Make selection work more I-beam-like.

2008-12-02  Christian Persch  <chpe@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_class_init): Show the correct version in
	Since: and Deprecated: annotations.

2008-12-02  Christian Persch  <chpe@gnome.org>

	Bug 112172 – Get rid of DeepinvteReaper

	* src/reaper.h: Deprecate.

2008-12-02  Christian Persch  <chpe@gnome.org>

	* configure.in: Enable maintainer mode by default. Define more
	deprecation defines, and define the *_DISABLE_SINGLE_INCLUDES defines.
	Enable deprecations by default in maintainer mode.
	* src/deepinvteapp.c: Undef DEEPINVTE_DISABLE_DEPRECATED here.

2008-12-02  Christian Persch  <chpe@gnome.org>

	* configure.in:
	* src/deepinvte-private.h: Move DEEPINVTE_UTF8_BPC definition from configure to
	deepinvte-private.h.
	* src/deepinvteconv.c: Include deepinvte-private.h here.

2008-12-02  Christian Persch  <chpe@gnome.org>

	* src/deepinvte-private.h:
	* src/deepinvte.c: (mark_input_source_invalid),
	(_deepinvte_terminal_connect_pty_read), (mark_output_source_invalid),
	(_deepinvte_terminal_connect_pty_write),
	(_deepinvte_terminal_disconnect_pty_read),
	(_deepinvte_terminal_disconnect_pty_write),
	(_deepinvte_terminal_enable_input_source), (remove_cursor_timeout),
	(deepinvte_terminal_key_press), (deepinvte_terminal_focus_in),
	(deepinvte_terminal_focus_out), (deepinvte_terminal_init),
	(deepinvte_terminal_unrealize), (deepinvte_terminal_expose),
	(deepinvte_terminal_background_update), (add_update_timeout),
	(remove_from_active_list), (deepinvte_terminal_add_process_timeout),
	(process_timeout), (update_repeat_timeout), (update_timeout): Remove
	DEEPINVTE_INVALID_SOURCE definition and just use 0 directly.

2008-12-02  Christian Persch  <chpe@gnome.org>

	Bug 560667 – invalid definition of DEEPINVTE_INVALID_SOURCE

	* src/deepinvte-private.h: Fix DEEPINVTE_INVALID_SOURCE define to use 0 instead of
	-1.

2008-12-02  Christian Persch  <chpe@gnome.org>

	* configure.in: Remove two AC_DEFINEs from here.
	* src/deepinvte-private.h: Define DEEPINVTE_INVALID_SOURCE here for now.

2008-12-02  Christian Persch  <chpe@gnome.org>

	Bug 112172 – Get rid of DeepinvteReaper

	* src/reaper.c: (deepinvte_reaper_child_watch_cb),
	(deepinvte_reaper_add_child), (deepinvte_reaper_init),
	(deepinvte_reaper_constructor), (deepinvte_reaper_finalize),
	(deepinvte_reaper_class_init), (deepinvte_reaper_get), (child_exited), (main):
	* src/reaper.h: Prepare for removal of Reaper in deepinvte1.0 by removing
	the unused pre-glib-2.4 code from Reaper.

2008-12-02  Christian Persch  <chpe@gnome.org>

	* src/deepinvteapp.c: (main): Catch the child-exited signal to the child's
	exit code.

2008-12-02  Christian Persch  <chpe@gnome.org>

	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_class_init): Intern the signal names.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_motion_notify): Do not discard motion notify
	events with coordinates out of our allocation, or when the cell under
	the cursor didn't change.  These are useful for extending selection
	and for sub-cell selection details, as well as app-requested all
	motion tracking.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	Bug 541441 – Dehighlight links on visibility notify?

	* src/deepinvte.c (deepinvte_terminal_focus_in), (deepinvte_terminal_enter):  Move match
	highlight enabling into "enter" event instead of "focus in".

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte-private.h:
	* src/deepinvte.c (_deepinvte_terminal_set_pointer_visible),
	(deepinvte_terminal_maybe_send_mouse_button),
	(deepinvte_terminal_maybe_send_mouse_drag), (deepinvte_terminal_motion_notify),
	(deepinvte_terminal_button_press), (deepinvte_terminal_button_release),
	(deepinvte_terminal_scroll), (deepinvte_terminal_reset):
	* src/deepinvteseq.c (deepinvte_sequence_handler_decset_internal):
	Simplify mouse event tracking by using a single int instead of five
	booleans.

2008-12-02  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_terminal_deselect_all),
	(deepinvte_terminal_process_incoming), (deepinvte_cell_is_selected),
	(deepinvte_terminal_copy), (deepinvte_terminal_start_selection),
	(deepinvte_terminal_extend_selection), (deepinvte_terminal_select_all),
	(deepinvte_terminal_paint), (_deepinvte_terminal_get_start_selection),
	(_deepinvte_terminal_get_end_selection), (_deepinvte_terminal_select_text):
	Rename struct selection_cell_coords members from x,y to col,row for
	clarity.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* NEWS:
	* configure.in:
	Released 0.19.1.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* doc/reference/Makefile.am:
	* doc/reference/check-doc-syntax.sh:
	* src/Makefile.am:
	* src/check-doc-syntax.sh:
	* src/deepinvte.c (deepinvte_terminal_catch_child_exited),
	(deepinvte_terminal_class_init):
	* src/deepinvte.h:
	* src/deepinvtepangocairo.c:
	Copy check-doc-syntax.sh tests from cairo and fix doc bugs.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* doc/reference/tmpl/deepinvte-unused.sgml:
	* doc/reference/deepinvte-sections.txt:
	Remove reaper docs.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	Bug 562806 – crash in Terminal: Typing "cd " just after ...

	* src/deepinvte.c (_deepinvte_terminal_cleanup_tab_fragments_at_cursor):
	Fix possible NULL dereference.

	* src/deepinvteseq.c (deepinvte_sequence_handler_ta):
	Fix tab fragments to have \t as c.

2008-12-01  Christian Persch  <chpe@gnome.org>

	* NEWS:
	* configure.in: Prepare 0.19.0.

2008-12-01  Christian Persch  <chpe@gnome.org>

	Bug 562511 – scrollbar doesn't sit at the bottom

	* src/deepinvte.c: (deepinvte_terminal_init),
	(deepinvte_terminal_set_scrollback_lines): Always update the scrollback
	lines, even if the setting hasn't changed. Work-around to fix bug
	#562511.

2008-12-01  Christian Persch  <chpe@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_class_init): Fix visible-bell property.

2008-12-01  Christian Persch  <chpe@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_set_font_full_internal),
	(deepinvte_terminal_class_init): Rename font property to "font-desc" to be
	more in line with other properties of this type in gtk.

2008-12-01  Christian Persch  <chpe@gnome.org>

	* src/deepinvteapp.c: (main): Add gobject notification debugging.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c (deepinvte_terminal_termcap_string_same_as_for),
	(deepinvte_sequence_handler_se), (deepinvte_sequence_handler_so):
	Simplify standout handling code.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c: Rip out DEEPINVTE_SEQUENCE_HANDLER_PROTO.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c: Rip out deepinvte_sequence_handler_invoke.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c: Rip out DEEPINVTE_SEQUENCE_HANDLER_INVOKE.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c: Rip out DEEPINVTE_SEQUENCE_HANDLER_REFERENCE.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c (_deepinvte_terminal_handle_sequence): Rip out the gcc label
	vtable code.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c (display_control_sequence),
	(_deepinvte_terminal_handle_sequence):
	Some cleanup of the gcc label vtable code before I rip it out.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c (deepinvte_sequence_handler_set_title_internal),
	(deepinvte_sequence_handler_set_mode_internal),
	(deepinvte_sequence_handler_invoke_internal):
	Move some code around.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteskel.c: Remove excess initializer.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/buffer.c:
	* src/caps.c:
	* src/dumpkeys.c:
	* src/interpret.c:
	* src/iso2022.c:
	* src/keymap.c:
	* src/matcher.c:
	* src/mev.c:
	* src/pty.c:
	* src/reaper.c:
	* src/reflect.c:
	* src/ring.c:
	* src/slowcat.c:
	* src/ssfe.c:
	* src/table.c:
	* src/trie.c:
	* src/deepinvteaccess.c:
	* src/deepinvtebg.c:
	* src/deepinvteconv.c:
	* src/deepinvtedraw.c:
	* src/deepinvteseq.c:
	* src/deepinvteskel.c:
	* src/xticker.c:
	#include <config.h> instead of "../config.h".

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c: Some wild crack to build the vtable using gcc
	extension for labels as values.  The advantage is that we get down to
	an empty .data for deepinvteseq.o but .text grows considerably.  And we have
	to use nested functions, and #define static auto.  It's really ugly.
	I'm going to remove it in the next commit or the one after.  Just
	wanted to record it here for posterity.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c (deepinvte_sequence_handler_invoke),
	(deepinvte_sequence_handler_offset), (deepinvte_sequence_handler_multiple),
	(deepinvte_sequence_handler_decset_internal),
	(DEEPINVTE_SEQUENCE_HANDLER_PROTO), (_deepinvte_terminal_handle_sequence):
	Almost there.  Towards a .data-free vtable.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c: Finish decoupling handle type from function type.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte-private.h:
	* src/deepinvteseq.c (deepinvte_sequence_handler_offset),
	(deepinvte_sequence_handler_multiple),
	(deepinvte_sequence_handler_decset_internal),
	(deepinvte_sequence_handler_set_mode_internal),
	(DEEPINVTE_SEQUENCE_HANDLER_PROTO), (_deepinvte_terminal_handle_sequence):
	Make sequence handlers return void instead of gboolean.  The return
	value was unused.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c (deepinvte_sequence_handler_offset),
	(deepinvte_sequence_handler_multiple),
	(deepinvte_sequence_handler_decset_internal),
	(DEEPINVTE_SEQUENCE_HANDLER_PROTO), (_deepinvte_terminal_handle_sequence):
	Switch to calling other handlers using two macros.
	Get rid of match and match_quark arguments to sequence handlers.
	They were unused.

2008-12-01  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c (deepinvte_sequence_handler_set_title_internal):
	Cleanup deepinvte_sequence_handler_set_title_internal.

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c (DEEPINVTE_SEQUENCE_HANDLER_PROTO): Use a macro to define
	type of sequence handlers.

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/Makefile.am:
	* src/deepinvteseq-2.c:
	* src/deepinvteseq-n.c:
	Remove gperf-generated files from SVN, but still distribute them in
	the tarball.

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte-private.h:
	* src/deepinvte.c:
	* src/deepinvteseq.c (_deepinvte_terminal_scroll_text),
	(deepinvte_sequence_handler_scroll_down),
	(deepinvte_sequence_handler_scroll_up):
	More code shufflling.

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/Makefile.am:
	* src/deepinvteseq-list.h:
	Remove deepinvteseq-list.h from SVN, but still distribute it in the tarball.

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/Makefile.am:
	* src/deepinvteseq-list.h:
	Autogenerate deepinvteseq-list.h.

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq-list.h:
	* src/deepinvteseq.c (_deepinvte_terminal_home_cursor),
	(_deepinvte_terminal_clear_screen), (_deepinvte_terminal_clear_current_line),
	(_deepinvte_terminal_clear_above_current),
	(deepinvte_sequence_handler_decset_internal), (deepinvte_sequence_handler_cl),
	(deepinvte_sequence_handler_ho), (deepinvte_sequence_handler_erase_in_display),
	(deepinvte_sequence_handler_erase_in_line):
	Sync deepinvteseql-list.h with actual handlers used in gperf files.

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq-list.h:
	* src/deepinvteseq.c (deepinvte_sequence_handler_scroll_down),
	(deepinvte_sequence_handler_scroll_up):
	Implement these calling deepinvte_terminal_scroll() directly instead of
	multiple'ing.

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte-private.h:
	* src/deepinvte.c (_deepinvte_terminal_scroll), (_deepinvte_terminal_scroll_region):
	* src/deepinvteseq.c (deepinvte_sequence_handler_scroll_down_one),
	(deepinvte_sequence_handler_scroll_up_one):
	Move deepinvte_terminal_scroll to deepinvte.c

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq-2.c (deepinvteseq_2_hash), (deepinvteseq_2_lookup):
	* src/deepinvteseq-2.gperf:
	* src/deepinvteseq-list.h:
	* src/deepinvteseq.c:
	Remove deepinvte_sequence_handler_complain_key.  The idea was to warn about
	receiving control-sequence handling request for escape sequences that
	actually belong to a key stroke.  Kinda like a debugging feature.
	Remove it as the number of sequences being handle that way was
	greater than the number of sequences handled in the real sense.
	Saves 2k .data!

	The actual list is still in deepinvteseq-2.gperf, but commented out.

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c (_deepinvte_sequence_get_handler),
	(display_control_sequence):
	Remove stale comment.

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/Makefile.am:
	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_terminal_process_incoming):
	* src/deepinvteseq.c (display_control_sequence),
	(_deepinvte_terminal_handle_sequence):
	* src/deepinvteseq.h:
	Move _deepinvte_terminal_handle_sequence() into deepinvteseq.c

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_insert_line_internal), (deepinvte_remove_line_internal),
	(_deepinvte_terminal_cursor_down), (_deepinvte_terminal_insert_char),
	(_deepinvte_terminal_audible_beep), (_deepinvte_terminal_visible_beep),
	(_deepinvte_terminal_beep), (deepinvte_terminal_key_press):
	* src/deepinvteseq.c (deepinvte_insert_line_internal),
	(deepinvte_remove_line_internal), (deepinvte_unichar_strlen),
	(deepinvte_sequence_handler_bl), (deepinvte_sequence_handler_sf),
	(deepinvte_sequence_handler_SF), (deepinvte_sequence_handler_vb):
	* src/deepinvteseq.h:
	Some code reshuffling to remove deepinvte.c calls to deepinvteseq.c functions.

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq-2.gperf:
	* src/deepinvteseq.c:
	Minor.

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c (deepinvte_terminal_beep): Move helper function out of the
	way.

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq-2.c (deepinvteseq_2_lookup):
	* src/deepinvteseq-2.gperf:
	* src/deepinvteseq-n.c (deepinvteseq_n_lookup):
	* src/deepinvteseq-n.gperf:
	* src/deepinvteseq.c:
	Add a macro around sequence handler citations, for future table
	tricks.

2008-11-30  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq-n.gperf:
	* src/deepinvteseq-n.c (deepinvteseq_n_hash), (deepinvteseq_n_lookup):
	Remove bogus entry that accidentally made it into the gperf list.

2008-11-30  Christian Persch  <chpe@gnome.org>

	* acinclude.m4: Remove more crufty macros.

2008-11-30  Christian Persch  <chpe@gnome.org>

	* acinclude.m4: Remove FT2 check macro.

2008-11-30  Christian Persch  <chpe@gnome.org>

	Bug 540951 – The gnome-pty-helper is spawn when its not needed
	
	* src/pty.c: (_deepinvte_pty_open): Don't use the pty helper when we don't
	need to update any of utmp, wtmp, lastlog. Patch by Alex Cornejo.

2008-11-30  Christian Persch  <chpe@gnome.org>

	Bug 465036 – gnome-pty-helper locks /var/run/utmp

	* gnome-pty-helper/gnome-utmp.c: (update_utmp): Close the utmp
	database after updating it. Patch by Kevin W. Rudd.

2008-11-29  Behdad Esfahbod  <behdad@gnome.org>

	Bug 127870 – terminal garbled and needs 'reset' after cat'ing file

	* src/iso2022.c (_deepinvte_iso2022_state_new): Initialize all four maps
	(G0, G1, G2, G3) in USASCII mode, like xterm does.

2008-11-29  Christian Persch  <chpe@gnome.org>

	* python/deepinvtemodule.c: (initdeepinvte): Register the constants too!

2008-11-29  Christian Persch  <chpe@gnome.org>

	* src/debug.c: (_deepinvte_debug_init):
	* src/debug.h:
	* src/deepinvte.c: (deepinvte_terminal_size_request),
	(deepinvte_terminal_size_allocate): Add a specific debug flag for widget
	size-request/size-allocation.

2008-11-29  Christian Persch  <chpe@gnome.org>

	* src/deepinvteapp.c: (main): Add options to use a GtkScrolledWindow as the
	terminal's container, and to set its vertical scrollbar policy, to
	allow testing DeepinvteTerminal in a scrolled window.

2008-11-29  Behdad Esfahbod  <behdad@gnome.org>

	Bug 317236 – deepinvte resynchrones too late on invalid UTF-8

	* src/deepinvteconv.c (_deepinvte_conv_utf8_utf8): In our UTF-8 to UTF-8 converter
	differentiate between an incomplete sequence and an ill sequence at
	the end of the buffer.  Also cleanup some minor inaccuracies (return
	value).

2008-11-29  Behdad Esfahbod  <behdad@gnome.org>

	Bug 107031 – device-control-string error

	* src/table.c (_deepinvte_table_addi):
	* src/deepinvte.c (deepinvte_terminal_handle_sequence):
	* src/deepinvteseq.c (deepinvte_sequence_handler_decset_internal):
	Replace some g_warning's with deepinvte debug output.

2008-11-29  Behdad Esfahbod  <behdad@gnome.org>

	Bug 521420 – deepinvte closes connection to child before all output is read
	Patch from Thomas Leonard

	* src/reaper.c (deepinvte_reaper_add_child): Install child watch at low
	priority instead of high.

2008-11-29  Behdad Esfahbod  <behdad@gnome.org>

	* configure.in: Require glib >= 2.18.0 as earlier glib versions
	had a totally bogus g_unichar_iswide_cjk().

	* perf/vim.sh: Don't use builting time command.

2008-11-29  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_emit_char_size_changed),
	(_deepinvte_terminal_emit_status_line_changed), (deepinvte_terminal_init),
	(deepinvte_terminal_background_update):
	Remove C++-style comment markers.

2008-11-29  Behdad Esfahbod  <behdad@gnome.org>

	Bug 514632 – Problem with cursor in emacs in gnome-terminal

	* src/deepinvte-private.h:
	* src/deepinvte.c (_deepinvte_terminal_cleanup_tab_fragments_at_cursor),
	(_deepinvte_terminal_insert_char):
	* src/deepinvteseq.c (deepinvte_sequence_handler_ch),
	(deepinvte_sequence_handler_cm), (deepinvte_sequence_handler_le),
	(deepinvte_sequence_handler_cursor_character_absolute):
	Break "smart tabs" into multiple empty cells when cursor moves
	into them or inserting character there.

2008-11-28  Behdad Esfahbod  <behdad@gnome.org>

	* src/debug.c (_deepinvte_debug_init):
	* src/debug.h:
	* src/deepinvtepangocairo.c (font_info_cache_ascii),
	(font_info_allocate), (font_info_free),
	(font_info_find_for_context), (font_info_get_unichar_info):
	Port deepinvtepangocairo profiling and lifecycle logging to deepinvtedebug
	facilities under debug domain "pangocairo".

2008-11-28  Behdad Esfahbod  <behdad@gnome.org>

	* src/debug.c (_deepinvte_debug_init): Rename debug env var from
	DEEPINVTE_DEBUG_FLAGS to DEEPINVTE_DEBUG.

2008-11-28  Behdad Esfahbod  <behdad@gnome.org>

	* src/debug.c (_deepinvte_debug_init):
	* src/debug.h:
	Make _deepinvte_debug_on() inline.

2008-11-28  Christian Persch  <chpe@gnome.org>

	* src/deepinvte.c: Remove backward compat define for gtk 2.0, since we
	already depend on a much higher version.

2008-11-28  Christian Persch  <chpe@gnome.org>

	* src/debug.c: (_deepinvte_debug_on): Revert behaviour change of
	_deepinvte_debug_on() from last commit.

2008-11-28  Behdad Esfahbod  <behdad@gnome.org>

	Bug 459553 – gnome-terminal cannot shows circled digits with the
	correct width on ja_JP.PCK
	Patch from Takao Fujiwara

	* src/iso2022.c (_deepinvte_iso2022_ambiguous_width): Recognize Shift_JIS
	as East Asian locale for width considerations.

2008-11-28  Christian Persch  <chpe@gnome.org>

	* src/debug.c: (_deepinvte_debug_init), (_deepinvte_debug_on):
	* src/debug.h:
	* src/interpret.c: (main):
	* src/pty.c: (main):
	* src/reaper.c: (main):
	* src/trie.c: (main):
	* src/deepinvte.c: (deepinvte_terminal_new), (deepinvte_terminal_class_init): Use
	g_parse_debug_string to parse the debug flags.

2008-11-28  Christian Persch  <chpe@gnome.org>

	* src/deepinvteregex.c: (compare_matches), (_deepinvte_regex_compile),
	(_deepinvte_regex_free), (_deepinvte_regex_exec): Remove the unused GNU regex
	code too.

2008-11-28  Christian Persch  <chpe@gnome.org>

	* src/deepinvteregex.c: (_deepinvte_regex_compile), (_deepinvte_regex_free),
	(_deepinvte_regex_exec): Remove unused PCRE code. If you want PCRE regexes,
	use the new APIs that take GRegex.

2008-11-28  Christian Persch  <chpe@gnome.org>

	Bug 562385 – gnome-pty-helper goes to 100% cpu usage

	* gnome-pty-helper/gnome-pty-helper.c: (pass_fd), (pty_free),
	(main): Make sure data structures are correctly aligned and of the
	right size. 

2008-11-27  Behdad Esfahbod  <behdad@gnome.org>

	* configure.in:
	* src/Makefile.am:
	More cleanup.

2008-11-27  Behdad Esfahbod  <behdad@gnome.org>

	* src/Makefile.am:
	Run some of the utilities in "make check", and build the others.

	* src/nativeecho.c:
	* src/utf8echo.c:
	Remove more useless trivial utilities.

2008-11-27  Behdad Esfahbod  <behdad@gnome.org>

	* src/Makefile.am:
	* src/iso8859mode.c:
	* src/utf8mode.c:
	Remove useless trivial utilities.

2008-11-27  Behdad Esfahbod  <behdad@gnome.org>

	* src/Makefile.am: Update EXTRA_DIST.

2008-11-27  Behdad Esfahbod  <behdad@gnome.org>

	* HACKING: Update :P.

2008-11-26  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c (_deepinvte_sequence_get_handler): Safely handle input of
	length 1.

2008-11-26  Behdad Esfahbod  <behdad@gnome.org>

	* src/Makefile.am:
	* src/deepinvteseq-2.c (deepinvteseq_2_hash), (deepinvteseq_2_lookup):
	* src/deepinvteseq-2.gperf:
	* src/deepinvteseq-n.c (deepinvteseq_n_lookup):
	* src/deepinvteseq-n.gperf:
	Don't use switch in gperf-generated code.  This increases .data by 1k
	but decreases .text by 6k AND the lookup code is MUCH faster.  It used
	to do tens of compares before.

2008-11-26  Behdad Esfahbod  <behdad@gnome.org>

	* src/Makefile.am:
	* src/deepinvteseq-2.c (deepinvteseq_2_hash), (deepinvteseq_2_lookup):
	* src/deepinvteseq-n.c (deepinvteseq_n_lookup):
	* src/deepinvteseq.c (_deepinvte_sequence_get_handler):
	Revert previous commit, fix NULL dereference that it was trying to
	fix, and make lookup functions inline.

2008-11-26  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/Makefile.am:
	* src/deepinvteseq-2.c (deepinvteseq_2_hash), (deepinvteseq_2_lookup):
	* src/deepinvteseq-n.c (deepinvteseq_n_lookup):
	* src/deepinvteseq.c (_deepinvte_sequence_get_handler):
	Manually modify (and record those modifications in the Makefile)
	the autogenerated gperf source code so that we return the sequence
	handler directly from the lookup function, or NULL on failure.
	So is this pain worth it?

2008-11-26  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtepangocairo.c (font_info_get_unichar_info):
	Free internal layout resources.

2008-11-26  Behdad Esfahbod  <behdad@gnome.org>

	Bug 562332 – cleanup font infos on exit?

	* src/deepinvtepangocairo.c
	(cleanup_delayed_font_info_destroys_predicate),
	(cleanup_delayed_font_info_destroys), (ensure_quit_handler),
	(font_info_register), (font_info_reference),
	(font_info_destroy_delayed), (font_info_destroy):
	Use gtk_quit_add() to complete delayed font_info destroys.

2008-11-26  Christian Persch  <chpe@gnome.org>

	Bug 562338 – don't need to connect to bunch of xft settings

	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_style_changed), (add_cursor_timeout),
	(deepinvte_terminal_init), (deepinvte_terminal_size_allocate),
	(deepinvte_terminal_finalize), (deepinvte_terminal_realize): Don't listen to
	changes on the gtk-xft-* GtkSettings properties. Just calling
	deepinvte_terminal_set_font_full in the style-set handler works fine.

2008-11-26  Christian Persch  <chpe@gnome.org>

	Bug 488960 – gnome-terminal on Solaris 10 does not clean up utmpx on
	exit (intermittent)

	* gnome-pty-helper/gnome-pty-helper.c: (main):
	* gnome-pty-helper/gnome-pty.h:
	* src/pty.c: (_deepinvte_pty_close): Add new GNOME_PTY_SYNCH operation to
	gnome-pty-helper. Patch from Behdad.

2008-11-26  Christian Persch  <chpe@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_style_changed),
	(deepinvte_terminal_ensure_font), (deepinvte_terminal_set_font_full),
	(deepinvte_terminal_set_font_from_string_full_internal),
	(deepinvte_terminal_set_font_from_string_full),
	(deepinvte_terminal_reset_rowdata), (deepinvte_terminal_set_property): Add
	deepinvte_terminal_set_font_*full_internal so we don't use deprecated
	symbols internally.

2008-11-26  Christian Persch  <chpe@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_sync_settings),
	(deepinvte_terminal_screen_changed): Remove gtk 2.12 version checks, since
	we already depend on 2.12.

2008-11-26  Christian Persch  <chpe@gnome.org>

	Bug 561366 – remove antialias setting for 1.0
	
	* src/deepinvte.c: (deepinvte_terminal_set_font_full),
	(deepinvte_terminal_get_property), (deepinvte_terminal_class_init):
	* src/deepinvte.h: Deprecate the font antialias setting, and remove the
	(existing only on trunk) font-antialias property already.

2008-11-25  Behdad Esfahbod  <behdad@gnome.org>

	* src/Makefile.am:
	* src/deepinvteseq-2.c (deepinvteseq_2_hash), (deepinvteseq_2_lookup):
	* src/deepinvteseq-2.gperf:
	* src/deepinvteseq-n.c (deepinvteseq_n_hash), (deepinvteseq_n_lookup):
	* src/deepinvteseq-n.gperf:
	* src/deepinvteseq.c (_deepinvte_sequence_get_handler):
	Cleanup gperf stuff.

2008-11-24  Behdad Esfahbod  <behdad@gnome.org>

	Bug 562187 – Add make rules for calling gperf

	* src/Makefile.am: Add a "gperf" target to be run manually.

	* src/deepinvteseq-2.gperf:
	* src/deepinvteseq-n.gperf:
	Add comment about "make gperf".

	* src/deepinvteseq-2.c:
	* src/deepinvteseq-n.c:
	Regenerate using newer gperf.

2008-11-24  Behdad Esfahbod  <behdad@gnome.org>

	Bug 416518 – Do something about uniwidths

	* src/iso2022.c (_deepinvte_iso2022_is_ambiguous):
	Call into glib to determine ambiguous-width chars.

	* src/genwidths.py:
	* src/uniwidths:
	Remove.

2008-11-24  Behdad Esfahbod  <behdad@gnome.org>

	Bug 500191 – Remove deepinvteseq-table.h?

	* src/Makefile.am:
	* src/deepinvteseq-gen.c:
	* src/deepinvteseq-table.h:
	Remove the old table implementation.  We use gperf-generated tables
	now.

2008-11-24  Behdad Esfahbod  <behdad@gnome.org>

	Bug 514457 – Use g_strv_length()

	* src/deepinvte.c (_deepinvte_terminal_fork_basic): Do it.

2008-11-24  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtepangocairo.c (font_info_create_for_widget): No need to check
	widget font desc here as deepinvte.c does that for us already.

2008-11-24  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtepangocairo.c (font_info_destroy): Modify GTK_CHECK_VERSION
	handling to make my vim syntax highlighter happy.

2008-11-23  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_ensure_cursor): Refactor duplicate code.

2008-11-22  Christian Persch  <chpe@gnome.org>

	* src/deepinvte.h: Move all the deprecated stuff into one place.

2008-11-22  Christian Persch  <chpe@gnome.org>

	Bug 542561 – Doesn't build when disabling gnome-pty-helper

	* src/pty.c: Always include sys/socket.h. Patch by Loïc Minier.

2008-11-22  Christian Persch  <chpe@gnome.org>

	* src/deepinvteapp.c: (main): Fix --blink; the flag is inverted.

2008-11-22  Christian Persch  <chpe@gnome.org>

	* src/deepinvteapp.c: (main): Use deepinvte_terminal_set_cursor_blink_mode instead
	of the deprecated set_cursor_blinks here.

2008-11-22  Christian Persch  <chpe@gnome.org>

	Bug 560766 – Deprecate and remove deepinvte_terminal_get_using_xft()

	* src/deepinvte.c: (deepinvte_terminal_get_using_xft):
	* src/deepinvte.h:
	* src/deepinvtedraw.c: (_deepinvte_draw_text):
	* src/deepinvtedraw.h:
	* src/deepinvtepangocairo.c: Deprecate deepinvte_terminal_get_using_xft() as preparation for
	bug #560766. Remove the internal deepinvtedraw method already.

2008-11-22  Christian Persch  <chpe@gnome.org>

	Bug 536894 – Confusing use of "free" as variable-name in ring
	functions

	* src/ring.c: (_deepinvte_ring_new), (_deepinvte_ring_new_with_delta),
	(_deepinvte_ring_remove):
	* src/ring.h: Don't shadow global declarations. Patch by dmacks at 
	netspace.org. 

2008-11-22  Christian Persch  <chpe@gnome.org>

	* python/deepinvte.override: Fix missing-prototypes warnings.

2008-11-22  Christian Persch  <chpe@gnome.org>

	* src/deepinvtepangocairo.c: No need to include gi18n-lib.h here.

2008-11-22  Christian Persch  <chpe@gnome.org>

	* configure.in:
	* deepinvte-uninstalled.pc.in:
	* deepinvte.pc.in: Clean up the pkgs declared for use in the .pc files.

2008-11-22  Christian Persch  <chpe@gnome.org>

	* configure.in: Depend on gtk 2.12. Bug #398862.

2008-11-22  Christian Persch  <chpe@gnome.org>

	* src/table.c: (print_array): Fix the build (broken since r1622).

2008-11-22  Christian Persch  <chpe@gnome.org>

	* src/reaper.c: Don't include gtk.h here, it's unneeded.

2008-11-22  Christian Persch  <chpe@gnome.org>

	* src/iso2022.c: (main): Make iso2022 programme build again; it was
	broken since r1612.

2008-11-22  Christian Persch  <chpe@gnome.org>

	* src/Makefile.am: Separate CFLAGS and CPPFLAGS.

2008-11-22  Christian Persch  <chpe@gnome.org>

	* src/Makefile.am: Don't add LDFLAGS to *_LDADD, that's wrong and
	broken.

2008-11-22  Christian Persch  <chpe@gnome.org>

	* configure.in:
	* src/Makefile.am:
	* deepinvte-uninstalled.pc.in:
	* deepinvte.pc.in: Remove more configure cruft: OTHERCFLAGS, OTHERLIBS,
	X_CFLAGS and X_LIBS.

2008-11-21  Christian Persch  <chpe@gnome.org>

        * src/deepinvtepangocairo.c: (font_info_destroy_delayed),
        (font_info_destroy): Use gdk_threads_add_timeout_seconds() for
        complete threadsafety.

2008-11-21  Chris Wilson  <chris@chris-wilson.co.uk>

	* deepinvte.pc.in: Remove FT2_LIBS and FT2_CFLAGS

2008-11-21  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/iso2022.c (_deepinvte_iso2022_is_ambiguous): Break out of interval
	search as early as possible. Exploit the strict ordering of the 
	ambiguous/unambiguous ranges to break out of the for loop as soon
	as the character is less than a range start. (As the arrays only
	contain 2/3 elements, it is not worth adding the overhead of calling
	bsearch()).

2008-11-21  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/iso2022.c (process_cdata): Copy the gunichars directly to the
	array from the incoming chunk.

2008-11-20  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/Makefile.am: Remove FT2_FLAGS

2008-11-20  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtepangocairo.c (font_info_destroy_delayed): Remove obsolete
	check.

2008-11-20  Behdad Esfahbod  <behdad@gnome.org>

	Bug 561713 – crash on font cache cleanup

	* src/deepinvtepangocairo.c (font_info_reference), (font_info_destroy):
	Remove destroy timeout when resurrecting a font info.

2008-11-20  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtepangocairo.c (font_info_cache_ascii),
	(font_info_allocate), (font_info_free),
	(font_info_find_for_context):
	Make profiling messages print the info pointer.

2008-11-20  Behdad Esfahbod  <behdad@gnome.org>

	* configure.in:  Remove more cruft.

2008-11-20  Behdad Esfahbod  <behdad@gnome.org>

	Bug 560819 – Remove obsolete backends

	* configure.in:
	* src/Makefile.am:
	* src/deepinvtebg.c (deepinvte_bg_get_pixmap):
	* src/deepinvtebg.h:
	* src/deepinvtedraw.c:
	* src/deepinvtefc.c:
	* src/deepinvtefc.h:
	* src/deepinvteft2.c:
	* src/deepinvteft2.h:
	* src/deepinvtegl.c:
	* src/deepinvtegl.h:
	* src/deepinvteglyph.c:
	* src/deepinvteglyph.h:
	* src/deepinvterdb.c:
	* src/deepinvterdb.h:
	* src/deepinvtergb.c:
	* src/deepinvtergb.h:
	* src/deepinvtexft.c:
	* src/deepinvtexft.h:
	Remove all backends except for pangocairo.  Saves so much code.

2008-11-20  Behdad Esfahbod  <behdad@gnome.org>

	Bug 560819 – Remove obsolete backends

	* src/Makefile.am:
	* src/deepinvtedraw.c:
	* src/deepinvtepango.c:
	* src/deepinvtepango.h:
	Remove pango backend.

2008-11-20  Behdad Esfahbod  <behdad@gnome.org>

	Bug 560819 – Remove obsolete backends

	* configure.in:
	* src/Makefile.am:
	* src/deepinvtedraw.c:
	* src/deepinvtepangox.c:
	* src/deepinvtepangox.h:
	Remove pangox backend.

2008-11-20  Behdad Esfahbod  <behdad@gnome.org>

	Bug 560818 – pangocairo backend doesn't share font cache across
	widgets

	* src/deepinvtepangocairo.c (font_info_cache_ascii),
	(font_info_allocate), (font_info_free), (font_info_register),
	(font_info_unregister), (font_info_reference),
	(font_info_destroy_delayed), (font_info_destroy), (context_hash),
	(context_equal), (font_info_find_for_context),
	(font_info_create_for_context), (font_info_create_for_screen),
	(font_info_get_unichar_info): Cache font info and use it for multiple
	widgets.

2008-11-19  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtepangocairo.c (font_info_create_for_screen),
	(font_info_destroy): Remove unused PangoCoverage.

2008-11-19  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtepangocairo.c (font_info_find_unichar_info),
	(font_info_cache_ascii), (font_info_measure_font),
	(font_info_get_unichar_info): Cache ASCII characters when building
	font.

2008-11-18  Christian Persch  <chpe@gnome.org>

	Remove glib usage from gnome-pty-helper. Bug #560977.

	* gnome-pty-helper/Makefile.am: Remove GLIB CFLAGS/LIBS.
	* gnome-pty-helper/configure.in: Remove glib check, and do some auto*
	modernisation.
	* gnome-pty-helper/gnome-pty-helper.c: (open_ptys), (exit_handler),
	(main): Use alloca instead of g_alloca, and use int instead of
	gboolean.

2008-11-18  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtepangocairo.c (font_info_create_for_screen),
	(font_info_destroy): Remove copy of font desc and antialias from font
	info object as they were not used.

2008-11-18  Behdad Esfahbod  <behdad@gnome.org>

	Bug 561185 – pangocairo backend sets antialias incorrectly

	* src/deepinvtepangocairo.c (font_info_create_for_screen): Handle
	FORCE_ENABLE correctly.

2008-11-16  Behdad Esfahbod  <behdad@gnome.org>

	Bug 560817 – pagocairo backend doesn't have correct opacity support	

	* src/deepinvtepangocairo.c (_deepinvte_pangocairo_clear),
	(_deepinvte_pangocairo_draw_text), (_deepinvte_pangocairo_draw_rectangle),
	(_deepinvte_pangocairo_fill_rectangle): Fix opacity support by using
	SOURCE operator.

2008-11-16  Behdad Esfahbod  <behdad@gnome.org>

	Bug 560991 – Unsetting background doesn't work

	* src/deepinvte.c (deepinvte_terminal_set_background_image): Correctly unset
	background if image==NULL.

2008-11-14 Christian Persch <chpe@gnome.org>

	* src/deepinvteskel.c: Fix missing prototype warning.

2008-11-14  Behdad Esfahbod  <behdad@gnome.org>

	Bug 395599 – Add pangocairo backend

	* configure.in:
	Require pango >= 1.22.0

	* src/Makefile.am:
	* src/deepinvtedraw.c:
	* src/deepinvtepangocairo.c:
	* src/deepinvtepangocairo.h:
	Add a pangocairo drawing backend.  Use it by default.  This is as fast
	as the xft backend.  Doesn't share font caches across widgets yet.
	Also, the transparent background stuff doesn't match xft backend's
	yet.

2008-11-14  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_ensure_font):
	* src/deepinvtedraw.c (_deepinvte_draw_new), (_deepinvte_draw_free),
	(_deepinvte_draw_set_background_opacity),
	(_deepinvte_draw_set_background_color), (_deepinvte_draw_set_text_font),
	(_deepinvte_draw_get_text_metrics), (_deepinvte_draw_get_char_width),
	(_deepinvte_draw_char), (_deepinvte_draw_draw_rectangle),
	(_deepinvte_draw_set_scroll):
	* src/deepinvtedraw.h:
	* src/deepinvteft2.c (_deepinvte_ft2_destroy), (_deepinvte_ft2_start),
	(_deepinvte_ft2_end), (_deepinvte_ft2_set_background_image), (_deepinvte_ft2_clear),
	(_deepinvte_ft2_set_text_font), (_deepinvte_ft2_get_text_metrics),
	(_deepinvte_ft2_get_char_width), (_deepinvte_ft2_draw_text),
	(_deepinvte_ft2_draw_has_char), (_deepinvte_ft2_draw_rectangle),
	(_deepinvte_ft2_fill_rectangle):
	* src/deepinvtegl.c (_deepinvte_gl_destroy), (_deepinvte_gl_get_visual),
	(_deepinvte_gl_start), (_deepinvte_gl_end), (_deepinvte_gl_set_background_image),
	(_deepinvte_gl_clear), (_deepinvte_gl_set_text_font),
	(_deepinvte_gl_get_text_metrics), (_deepinvte_gl_get_char_width),
	(_deepinvte_gl_draw_text), (_deepinvte_gl_draw_has_char), (_deepinvte_gl_rectangle):
	* src/deepinvtepango.c (_deepinvte_pango_set_text_font),
	(_deepinvte_pango_get_text_metrics):
	* src/deepinvtepangox.c (_deepinvte_pangox_create), (_deepinvte_pangox_destroy),
	(_deepinvte_pangox_start), (_deepinvte_pangox_end),
	(_deepinvte_pangox_set_background_image), (_deepinvte_pangox_clip),
	(_deepinvte_pangox_clear), (_deepinvte_pangox_set_text_font),
	(_deepinvte_pangox_get_text_metrics), (_deepinvte_pangox_get_using_fontconfig),
	(_deepinvte_pangox_draw_text), (_deepinvte_pangox_draw_has_char),
	(_deepinvte_pangox_draw_rectangle), (_deepinvte_pangox_fill_rectangle):
	* src/deepinvtepangox.h:
	* src/deepinvteskel.c (_deepinvte_skel_clear), (_deepinvte_skel_get_text_metrics),
	(_deepinvte_skel_draw_text), (_deepinvte_skel_fill_rectangle):
	* src/deepinvtexft.c (_deepinvte_xft_set_text_font),
	(_deepinvte_xft_get_text_metrics), (_deepinvte_xft_draw_text):
	Remove unneeded draw methods.

2008-11-14  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtedraw.c (_deepinvte_draw_get_char_width): Minor fix.

	* src/deepinvtepangox.c (_deepinvte_pango_x_create), (_deepinvte_pango_x_start),
	(_deepinvte_pango_x_clear): Cleanup here too.

2008-11-13  Behdad Esfahbod  <behdad@gnome.org>

	* configure.in:
	* src/deepinvte-private.h:
	Undo previous change instead of cleanly fix it for now.

2008-11-13  Behdad Esfahbod  <behdad@gnome.org>

	* configure.in:
	* src/deepinvte-private.h:
	Why do we let people configure random things?

2008-11-13  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_background_update):
	* src/deepinvtedraw.c (_deepinvte_draw_update_requires_clear), (_deepinvte_draw_new),
	(_deepinvte_draw_set_background_opacity),
	(_deepinvte_draw_set_background_color), (_deepinvte_draw_set_background_image),
	(_deepinvte_draw_char), (_deepinvte_draw_set_scroll):
	* src/deepinvtedraw.h:
	* src/deepinvteft2.c (_deepinvte_ft2_set_background_image), (_deepinvte_ft2_clear),
	(_deepinvte_ft2_get_char_width):
	* src/deepinvtegl.c (_deepinvte_gl_create), (_deepinvte_gl_clear),
	(_deepinvte_gl_get_char_width), (_deepinvte_gl_draw_text):
	* src/deepinvtepango.c (_deepinvte_pango_create), (_deepinvte_pango_start),
	(_deepinvte_pango_set_background_image), (_deepinvte_pango_clear):
	* src/deepinvtexft.c (_deepinvte_xft_create), (_deepinvte_xft_set_background_image),
	(_deepinvte_xft_clear), (_deepinvte_xft_get_char_width):
	Simplify backends by relying more on defaults.

2008-11-13  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtedraw.c (_deepinvte_draw_init_user), (_deepinvte_draw_init_default):
	Accept draw impl if impl->check is NULL.

2008-11-13  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtedraw.h:
	* src/deepinvtedraw.c (_deepinvte_draw_new), (_deepinvte_draw_get_visual),
	(_deepinvte_draw_get_colormap), (_deepinvte_draw_start), (_deepinvte_draw_end),
	(_deepinvte_draw_set_background_color), (_deepinvte_draw_set_background_image),
	(_deepinvte_draw_requires_repaint), (_deepinvte_draw_clip), (_deepinvte_draw_clear),
	(_deepinvte_draw_set_text_font), (_deepinvte_draw_get_text_width),
	(_deepinvte_draw_get_text_height), (_deepinvte_draw_get_text_ascent),
	(_deepinvte_draw_get_char_width), (_deepinvte_draw_get_using_fontconfig),
	(_deepinvte_draw_text), (_deepinvte_draw_char), (_deepinvte_draw_has_char),
	(_deepinvte_draw_fill_rectangle), (_deepinvte_draw_draw_rectangle),
	(_deepinvte_draw_set_scroll):
	Use sensical defaults instead of g_return_if_fail'ing when backend
	functions are not implemented.

2008-10-31  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 557375 – >=deepinvte-0.16.14 breaks highlighting on activity

	* src/deepinvte.c (deepinvte_terminal_deselect_all):
	Preserve the copy of the selection until it is replace by a new
	selection, so that we can perform asynchronous copies from the
	clipboard.

2008-10-23  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 557375 – >=deepinvte-0.16.14 breaks highlighting on activity

	* src/deepinvte.c (deepinvte_terminal_deselect_all),
	(deepinvte_terminal_extend_selection):
	After the user modifies the selection, copy it to PRIMARY and store
	it on the terminal. This ensures that after a screen redraw, we
	compare the contents of the selected region with the current
	selection, instead of stale data.

2008-10-23  Christian Persch  <chpe@gnome.org>

        * configure.in:
        * src/Makefile.am: Use glib-genmarshal --internal directly instead
        of checking the glib version, since we now depend on a glib version
        that provides this.

2008-10-23  Christian Persch  <chpe@gnome.org>

        Bug 556398 – maybe deprecate deepinvte_terminal_get_char_ascent/descent

        * src/deepinvte.[ch]: Deprecate deepinvte_terminal_get_char_ascent/descent.

2008-10-23  Christian Persch  <chpe@gnome.org>

        Bug 339819 – LibDEEPINVTE terminals in GLADE

        A glade/*:
        * Makefile.am
        * configure.in: Add glade catalogue.

2008-10-23  Christian Persch  <chpe@gnome.org>

        Bug 399364 – Implement properties

        * src/deepinvte.c: Add gobject properties.

2008-10-19  Christian Persch  <chpe@gnome.org>

        Bug 556328 – Document set-scroll-adjustment parameters

        * src/deepinvte.c: Document the set-scroll-adjustments signal.

2008-10-15  Behdad Esfahbod  <behdad@gnome.org>

	* doc/reference/Makefile.am:
	* doc/reference/check-doc-coverage.sh:
	* doc/reference/check.docs:
	Update doc coverage test from cairo.

2008-10-14  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_set_cursor_shape):
	Invalidate cursor upon shape change.

2008-10-15  Christian Persch  <chpe@gnome.org>

	* python/deepinvte.defs: Add new API to the binding.

2008-10-14  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_terminal_draw_line), (deepinvte_terminal_paint_cursor):
	Remove DEEPINVTE_CURSOR_OUTLINE in favor of DEEPINVTE_LINE_WIDTH.

2008-10-14  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_paint_cursor):
	Supposedly handle reverse video during cursor drawing.

2008-10-14  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_paint_im_preedit_string),
	(deepinvte_terminal_paint):
	Move IM preedit string drawing into its own function for code
	clarity.

2008-10-14  Behdad Esfahbod  <behdad@gnome.org>

	Bug 549835 – Feature Request: Configurable cursor appearance

	* src/deepinvte.h:
	New public api:

		DeepinvteTerminalCursorShape
		deepinvte_terminal_set_cursor_shape
		deepinvte_terminal_get_cursor_shape

	* src/deepinvte-private.h:
	* src/deepinvte.c (_deepinvte_terminal_insert_char), (deepinvte_terminal_init),
	(deepinvte_terminal_paint_cursor), (deepinvte_terminal_paint),
	(deepinvte_terminal_set_cursor_shape), (deepinvte_terminal_get_cursor_shape):
	Implement new API.  Also clean up cursor drawing in general.

	* doc/reference/Makefile.am:
	* doc/reference/tmpl/reaper.sgml:
	* doc/reference/tmpl/deepinvte-unused.sgml:
	* doc/reference/tmpl/deepinvte.sgml:
	* doc/reference/deepinvte-sections.txt:
	Doc new symbols.  Also add some missing docs.

2008-10-13  Christian Persch  <chpe@gnome.org>

	* src/deepinvte.c: Add gobject property infrastructure.

2008-10-13  Christian Persch  <chpe@gnome.org>

	* src/Makefile.am: Fix missing prototypes compiler warning in
	marshal.c.

2008-10-06  Christian Persch  <chpe@gnome.org>

	* src/deepinvteconv.c: (_deepinvte_conv_open): Fix compiler warning.

2008-10-06  Christian Persch  <chpe@gnome.org>

        Bug 509204 – child-exited signal does not provide exit code

	* python/deepinvte.defs: Add the new function to the bindings.

2008-10-06  Christian Persch  <chpe@gnome.org>

        Bug 539130 – building g-t fails due to GtkType etc. deprecation

        * src/deepinvte.h: Deprecate useless macros.

2008-10-06  Christian Persch  <chpe@gnome.org>

        Bug 509204 – child-exited signal does not provide exit code

        * src/deepinvte-private.h:
        * src/deepinvte.h:
        * src/deepinvte.c: Add function to get the child's exit status.

2008-10-06  Christian Persch  <chpe@gnome.org>

	* configure.in: Bump version to 0.17.5.

2008-09-08  Christian Persch  <chpe@gnome.org>

        Release 0.17.3.

        * NEWS:
	* configure.in: Updated.

2008-09-07  Christian Persch  <chpe@gnome.org>

	* python/deepinvte.defs: Update python bindings.

2008-08-20  Sébastien Granjoux  <seb.sfo@free.fr>

	Bug 538344 – Anjuta hangs when program is executed in terminal

	* src/deepinvte.c: Ensure the output channel exists when we need to write.

2008-08-20  Christian Persch  <chpe@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_match_check_internal_gregex): Plug a mem
	leak.

2008-08-15  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (deepinvte_terminal_set_pty):
	fcntl(2) specifies that the flags argument is a long. Make it so.

2008-08-13  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_terminal_match_check_internal_deepinvte),
	(deepinvte_terminal_ensure_cursor), (deepinvte_terminal_set_colors),
	(_deepinvte_terminal_insert_char), (deepinvte_terminal_feed),
	(deepinvte_terminal_key_press), (deepinvte_terminal_match_hilite_update),
	(deepinvte_terminal_extend_selection):
	* src/deepinvteseq.c (deepinvte_terminal_find_charcell),
	(deepinvte_sequence_handler_set_title_internal),
	(deepinvte_sequence_handler_decset_internal), (deepinvte_sequence_handler_cb),
	(deepinvte_sequence_handler_cd), (deepinvte_sequence_handler_ce),
	(deepinvte_sequence_handler_ec), (deepinvte_sequence_handler_ta),
	(deepinvte_sequence_handler_set_mode),
	(deepinvte_sequence_handler_window_manipulation):
	Fix all "signed vs unsigned comparison" warnings.

2008-08-13  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (regex_match_clear_cursor),
	(deepinvte_terminal_set_cursor_from_regex_match):
	Fix uninitialized cursor warning.  Setting to NULL sounds
	right to me.  ChPe?

2008-08-13  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c: Remove useless "inline" decorators.  Gcc has been
	rightfully complaining.

2008-08-13  Behdad Esfahbod  <behdad@gnome.org>

	Bug 546940 – Crash when selecting text

	* src/deepinvte.c (deepinvte_terminal_extend_selection): Fix crash with 64-bit
	systems.  Note to self:

		unsigned int len = 0;
		long i = len - 1;
		assert (i < 0);

	fails on 64-bit systems.

2008-08-05  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.17.1.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.17.1.
	Bumped libtool version to 12:0:3.

2008-08-05  Behdad Esfahbod  <behdad@gnome.org>

	Bug 546366 – hard to select last tab char on a line

	* src/deepinvte.c (deepinvte_terminal_extend_selection):
	* src/deepinvteseq.c (deepinvte_sequence_handler_ta):
	Handle fragment cells.

2008-08-05  Behdad Esfahbod  <behdad@gnome.org>

	Bug 545924 – tab characters not handled correctly after ncurses clear	
	Patch from Patryk Zawadzki

	* src/deepinvteseq.c (deepinvte_sequence_handler_ta): Ignore empty cells at end of
	line.

2008-07-14  Behdad Esfahbod  <behdad@gnome.org>

	Bug 542795 – DEEPINVTE_CJK_WIDTH don't work

	* src/iso2022.c (_deepinvte_iso2022_ambiguous_width): Fix DEEPINVTE_CJK_WIDTH env
	handling.

2008-06-27  Christian Persch  <chpe@gnome.org>

        Bug 399744 – Hide more font-aa implementation details

        * src/deepinvtexft.c: Disable antialiasing if using the default antialias
        setting and the XRender extension is not available.

2008-06-27  Christian Persch  <chpe@gnome.org>

        Bug 510903 – use gtk-cursor-blink setting

        * doc/reference/tmpl/deepinvte.sgml:
        * doc/reference/deepinvte-sections.txt:
        * src/deepinvte-private.h:
        * src/deepinvte.c:
        * src/deepinvte.h: Make the cursor blinking follow the gtk setting by
        default, with a possible override.

2008-06-26  Christian Persch  <chpe@gnome.org>

	* src/deepinvte.h: Remove the enum type declarations that are now in
        deepinvtetypebuiltins.h.

2008-06-26  Christian Persch  <chpe@gnome.org>

        * Makefile.am:
        * autogen.sh: Fix the build from svn and make dist when using
        intltool 0.40.0. Tarball builds still only require 0.35.0.

2008-06-26  Christian Persch  <chpe@gnome.org>

	* src/deepinvteversion.h.in: Disallow direct inclusion of the new
	deepinvteversion.h file.

2008-06-26  Christian Persch  <chpe@gnome.org>

	* configure.in:
	* src/Makefile.am:
	* src/deepinvte.c:
	* src/deepinvte.h:
	* src/deepinvtetypebuiltins.c.template:
	* src/deepinvtetypebuiltins.h.template: Use glib-mkenums to generate the
	enum types; makes it easier to add more enum types.

2008-06-26  Christian Persch  <chpe@gnome.org>

        Bug 539130 – building g-t fails due to GtkType etc. deprecation

        * src/reaper.h:
        * src/deepinvte.c:
        * src/deepinvteaccess.[ch]: 
        * src/deepinvtebg.h: Also remove the deprecated GtkType macros from here.

2008-06-25  Christian Persch  <chpe@gnome.org>

	Bug 540182 – crash in geany with deepinvte trunk

	* src/deepinvte.c: Make sure that match_attributes always exist even if
	there haven't been any matches added.

2008-06-23  Christian Persch  <chpe@gnome.org>

	Bug 535552 – deepinvte_terminal_set_allow_bold doesn't queue redraw

	* src/deepinvte.c: Invalidate all when changing the allow-bold property.

2008-06-23  Christian Persch  <chpe@gnome.org>

        Bug 535469 – support named cursors on matches

        * src/deepinvte-private.h
        * src/deepinvte.c
        * src/deepinvte.h: Implement named cursors on matches.

2008-06-23  Christian Persch  <chpe@gnome.org>

        Bug 418918 – Switch to GRegex

        * src/deepinvte-private.h
        * src/deepinvte.c
        * src/deepinvte.h: Implement GRegex matching, to be used alternatively
        to the old deepinvteregex matching.

2008-06-23  Christian Persch  <chpe@gnome.org>

        Bug 535467 – implement set-scroll-adjustments signal

        * src/deepinvte.c: Add set-scroll-adjustments signal, needed to allow
        adding a DeepinvteTerminal into a GtkScrolledWindow.

2008-06-23  Christian Persch  <chpe@gnome.org>

        Bug 535468 – need version check macros

        * configure.in
        * doc/reference/tmpl/deepinvteversion.sgml
        * doc/reference/deepinvte-sections.txt
        * doc/reference/deepinvte.types
        * src/Makefile.am
        * src/deepinvte.h
        A src/deepinvteversion.h.in: Add version check macro.

2008-06-21  Kjartan Maraas  <kmaraas@gnome.org>

	* src/deepinvte.h: Don't use GTK_CHECK* macros.

2008-06-04  Christian Persch  <chpe@gnome.org>

	Bug 515972 – Bold black is black in deepinvte's default palette

	* src/deepinvte.c: (deepinvte_terminal_set_colors): Correctly set the value of
	'bold black' in the palette. Patch by Santtu Lakkala.

2008-06-04  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.16.14.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.16.14.
	Bumped libtool version to 11:18:2.

2008-06-04  Behdad Esfahbod  <behdad@gnome.org>

	Bug 536632 – deepinvte build failure in ring.c:210: error: expected
	expression before 'do'

	* src/debug.h:
	* src/ring.c:
	* src/ring.h:
	With latest glib (after bug #519026), g_error is expanding to
	"do {...} while(0)" instead of "{...}".  This breaks build in
	debugging mode.  Use g_critical instead.  Also add some
	G_STMT_START/END to some macros.

2008-05-29  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/pty.c (merge_environ): Replace previous commit with the
	better patch by Christian Persch.

2008-05-29  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/pty.c (merge_environ): Fix bug in patch to use g_listenv()
	as it only returns the variable name and we need to use g_getenv()
	to retrieve its value.

2008-05-27  Behdad Esfahbod  <behdad@gnome.org>

	* src/iso2022.c (_deepinvte_iso2022_ambiguous_width): Oops.  Fix thinko
	in last commit.

2008-05-27  Behdad Esfahbod  <behdad@gnome.org>

	Bug 535022 – ambiguous width in utf8 locale

	* src/iso2022.c (_deepinvte_iso2022_ambiguous_width): Recognize
	env var settings DEEPINVTE_CJK_WIDTH=narrow and DEEPINVTE_CJK_WIDTH=wide.
	Any other value means "auto" based on locale, as it was doing
	previously.

2008-05-21  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/pty.c (merge_environ): Silence compiler warning about using
	environ as a local variable name.

2008-05-21  Richard Hult  <richard@imendio.com>

	Bug 534148 – Use g_listenv() instead of environ

	* src/pty.c: (merge_environ): Use g_listenv() instead of
	non-portable environ extern.

2008-05-19  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.in: automake doesn't like to substitute more
	than one variable at a time.
	* src/deepinvtedraw.c: (_deepinvte_draw_get_using_fontconfig):
	* src/deepinvtetc.c: (_deepinvte_termcap_find_boolean):
	Fix two compiler warnings.

2008-05-09  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvtedraw.c (_deepinvte_draw_text):
	    Add the text to draw to the debug output.

2008-05-09  Chris Wilson  <chris@chris-wilson.co.uk>

	Fix "GLib-CRITICAL **: g_io_add_watch_full: assertion
	                       `channel != NULL' failed"

	* src/debug.c (_deepinvte_debug_parse_string):
	* src/debug.h:
	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_terminal_emit_adjustment_changed),
	(_deepinvte_terminal_adjust_adjustments_full),
	(deepinvte_terminal_scroll_lines), (deepinvte_terminal_maybe_scroll_to_bottom),
	(_deepinvte_terminal_insert_char), (deepinvte_terminal_catch_child_exited),
	(mark_input_source_invalid), (_deepinvte_terminal_connect_pty_read),
	(mark_output_source_invalid), (_deepinvte_terminal_connect_pty_write),
	(_deepinvte_terminal_disconnect_pty_read),
	(_deepinvte_terminal_disconnect_pty_write), (_deepinvte_terminal_fork_basic),
	(deepinvte_terminal_eof), (_deepinvte_terminal_enable_input_source),
	(deepinvte_terminal_io_read), (deepinvte_terminal_handle_scroll),
	(deepinvte_terminal_finalize), (deepinvte_terminal_class_init),
	(deepinvte_terminal_set_pty), (process_timeout), (update_repeat_timeout),
	(update_timeout):
	It was possible for _deepinvte_terminal_enable_input_source() to be called
	after the input closed with G_IO_HUP. The minimal change would just
	have been to add a guard to check the pty_master was still valid
	before reattaching the source. Instead I removed the redundant
	duplication of the input and output channels and added lots of
	debugging.

2008-05-08  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 516869 – deepinvte displays nothing on GTK+/DirectFB

	Original patch by Jérémy Bobbio.

	* src/deepinvte.c (deepinvte_terminal_class_init), (update_regions),
	(update_repeat_timeout), (update_timeout):
	gdk_window_process_all_updates() is ineffective on the gtk+-directfb
	and gtk+-quartz backends, so in order to process updates immediately
	one must call gdk_window_process_updates() on the desired GdkWindows
	instead.

2008-03-10  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.16.13.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.16.13.
	Bumped libtool version to 11:17:2.

2008-02-20  Behdad Esfahbod  <behdad@gnome.org>

	Bug 517709 – DEEPINVTE's pty.c makes 4096 getrlimit calls when it only needs
	one

	* src/pty.c (_deepinvte_pty_start_helper): Only close fds 0, 1, and 2.
	gnome-pty-helper closes all fds anyway.

2008-02-08  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c:
	* src/deepinvteapp.c:
	* src/deepinvtergb.c:
	Remove unneeded #include <fontconfig/fontconfig.h>

2008-01-09  Behdad Esfahbod  <behdad@gnome.org>

	Bug 449131 – Wrong gettext domain

	* src/pty.c:
	* src/reaper.c (deepinvte_reaper_class_init):
	* src/trie.c:
	* src/deepinvtebg.c (deepinvte_bg_class_init):
	* src/deepinvteglyph.c:
	Oops.  Fix all remaining ones too.

2008-01-07  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.16.12.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.16.12.
	Bumped libtool version to 11:16:2.
.
2007-12-21  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 503164 – Drawing problems for DEEPINVTE with gtk+-quartz

	* src/deepinvte.c (deepinvte_terminal_realize):
	Continuing the saga, remove the fiddling with visibility state
	during realize.

2007-12-18  Behdad Esfahbod  <behdad@gnome.org>

	Bug 449131 – Wrong gettext domain

	* src/deepinvte.c (deepinvte_terminal_class_init): Use GETTEXT_DOMAIN in
	bind_textdomain_codeset().

2007-12-17  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.16.11.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.16.11.
	Bumped libtool version to 11:15:2.
.
2007-12-17  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 503164 – Drawing problems for DEEPINVTE with gtk+-quartz

	* src/deepinvte.c (deepinvte_terminal_init):
	GdkQuartz does not generate GdkVisibilityNotify events and
	so the terminal was never marked as unobscured, causing all
	redraws to be discarded. Resolve this by initially setting the
	terminal to be unobscured.

2007-12-10  Behdad Esfahbod  <behdad@gnome.org>

	Bug 319687 – Pasting of text containing characters not in the
	terminal's encoding silently fails

	* src/deepinvteconv.c (_deepinvte_conv_open): Try to open converter with
	transliteration.  Supported by GNU iconv and GLibc.

2007-12-03  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.16.10.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.16.10.
	Bumped libtool version to 11:14:2.
.
2007-12-03  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 497246 – Kill deepinvte_iso2022_fragment_input

	* src/iso2022.c (process_block), (_deepinvte_iso2022_process):
	Avoid the temporary allocation of the GArray holding the fragments
	by processing each fragment as it is decyphered. This array is
	allocated and grown for every single input chunk and is currently the
	most frequent allocation made by deepinvte.

2007-12-03  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/keymap.c: Make is_cursor_key static.

2007-11-28  Behdad Esfahbod  <behdad@gnome.org>

	Bug 412435 – Invalid variable name in Makefile.am

	* Makefile.am:
	* configure.in:
	* deepinvte.spec.in:
	Remove spec file and old convenience cvs make targets.

2007-11-28  Behdad Esfahbod  <behdad@gnome.org>

	Bug 416561 – Rendering issue in DeepinvtePango

	* src/deepinvtepango.c (_deepinvte_pango_draw_rectangle):
	* src/deepinvtepangox.c (_deepinvte_pango_x_draw_rectangle):
	gdk_draw_rectangle has slightly different semantics when
	filling vs outlining.  Fix for that.

2007-11-28  Behdad Esfahbod  <behdad@gnome.org>

	Bug 416558 – Rendering errors in DeepinvteFT2

	* src/deepinvteft2.c (_deepinvte_ft2_create): Disable Gtk+ double-buffering.

2007-11-28  Behdad Esfahbod  <behdad@gnome.org>

	Bug 403217 – Outdated README

	* README: Rewrite.

2007-11-27  Behdad Esfahbod  <behdad@gnome.org>

	Bug 118967 – single line scrolling with "Ctrl+Shift+ArrowUp/ArrowDown"
	Patch from Mauricio and Mariano Suárez-Alvarez

	* src/deepinvte.c (deepinvte_terminal_scroll_lines),
	(deepinvte_terminal_scroll_pages), (deepinvte_terminal_key_press):
	Implement single-line scroll.

2007-11-27  Behdad Esfahbod  <behdad@gnome.org>

	Bug 353610 – Don't convert tab characters upon copying

	* src/deepinvte-private.h:
	* src/deepinvteseq.c (deepinvte_sequence_handler_ta):
	Smart tab handling to try to preserve tab character upong copying.
	Also makes such smart tabs all-or-none selectable.

2007-11-27  Behdad Esfahbod  <behdad@gnome.org>

	Bug 499892 – strikethrough line is too high

	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_terminal_apply_metrics), (deepinvte_terminal_init),
	(deepinvte_terminal_draw_cells): Adjust underline/strikethrough thickness
	and position based on pangofc's heuristics.

2007-11-27  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtedraw.c (_deepinvte_draw_init_user): Make DEEPINVTE_BACKEND=list list
	available backends to stderr.

2007-11-27  Behdad Esfahbod  <behdad@gnome.org>

	Bug 499891 – deepinvte with opacity set, shows invisible chars

	* src/deepinvte.c (deepinvte_terminal_draw_rows): Don't draw invisible chars.

2007-11-27  Behdad Esfahbod  <behdad@gnome.org>

	Bug 499896 – Alternate charset isn't an attribute, though we treat it
	as one.

	* src/deepinvte-private.h:
	* src/deepinvte.c (_deepinvte_terminal_set_default_attributes),
	(_deepinvte_terminal_insert_char), (deepinvte_terminal_reset):
	* src/deepinvteseq.c (deepinvte_sequence_handler_ae),
	(deepinvte_sequence_handler_as):
	Move cell.attr.alternate to screen->alternate_charset.

2007-11-27  Behdad Esfahbod  <behdad@gnome.org>

	Bug 499893 – cell.attr.protect is unused

	* src/deepinvte-private.h:
	* src/deepinvte.c (_deepinvte_terminal_set_default_attributes):
	* src/deepinvteseq.c (deepinvte_sequence_handler_mp):
	Comment out cell.attr.protect which is unused.

2007-11-27  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (_deepinvte_invalidate_cell), (_deepinvte_invalidate_cursor_once):
	Minor optimization, if one can call it that.

2007-11-26  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c: Fix doc syntax.

2007-11-26  Behdad Esfahbod  <behdad@gnome.org>

	Revert previous change.  For reason, see bug.
	Bug 491832 – deepinvte_terminal_get_text_range_maybe_wrapped always includes
	trailing spaces

	* src/deepinvte.c (deepinvte_terminal_get_text_range_maybe_wrapped):
	Don't trim space characters, just the empty space after lines,
	like we used to.

2007-11-26  Behdad Esfahbod  <behdad@gnome.org>

	Bug 491832 – deepinvte_terminal_get_text_range_maybe_wrapped always includes
	trailing spaces

	* src/deepinvte.c (deepinvte_terminal_get_text_range_maybe_wrapped):
	Trim trailing space characters if asked to.

2007-11-23  Behdad Esfahbod  <behdad@gnome.org>

	* doc/reference/Makefile.am:
	* doc/reference/check.docs:
	Add script to check doc coverage is 100% on "make check".

2007-11-23  Behdad Esfahbod  <behdad@gnome.org>

	Bug 499287 – Fix doc coverage regression

	* doc/reference/tmpl/deepinvte.sgml:
	* doc/reference/deepinvte-sections.txt:
	Document undocumented symbols.

2007-11-16  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (deepinvte_terminal_io_read), (deepinvte_terminal_init),
	(process_timeout), (update_repeat_timeout), (update_timeout):
	    Tweak to read across chunk boundaries whilst still maintaining
	    fairness between multiple terminals and refresh rate targets.

2007-11-16  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/ring.c (_deepinvte_ring_insert_preserve):
	    Use stack allocation to hold small numbers of temporary
	    gpointers.

2007-11-16  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte-private.h:
	* src/deepinvte.c (_deepinvte_free_row_data), (deepinvte_terminal_reset_rowdata),
	(deepinvte_terminal_finalize), (deepinvte_terminal_reset):
	    Export _deepinvte_row_data_free.

	* src/deepinvteseq.c (deepinvte_remove_line_internal):
	    Cache the removed DeepinvteRowData - fixes the continual reallocation
	    of row data during the vim scrolling benchmark.

2007-11-16  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (release_chunk), (prune_chunks),
	(remove_from_active_list), (process_timeout),
	(update_repeat_timeout):
	    Delay pruning the chunks freelist until we finished processing
	    all the incoming data. We were discarding the freelist far too
	    early and reduced the efficacy of the cache.

2007-11-16  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvterdb.h:
	* src/deepinvterdb.c (_deepinvte_rdb_get), (_deepinvte_rdb_search), (_deepinvte_rdb_quark),
	(_deepinvte_rdb_get_rgba), (_deepinvte_rdb_get_hintstyle), (_deepinvte_rdb_release):
	    Remove redundant queries and cache the XRequest on the root
	    window (saves a few round-trips during terminal construction).
	    Add a new function to free the cache.

	* src/deepinvtefc.c (_deepinvte_fc_defaults_from_rdb):
	    Release the cache after retrieving settings.

2007-11-15  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (deepinvte_terminal_focus_out):
	    Similar for the leave notify, disable the match updating after
	    hiding the cursor after the loss of focus.
	    However, do we really want to disable the hilighting whilst the
	    pointer may still be within the terminal?

2007-11-15  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (deepinvte_terminal_enter):
	    Don't automatically reshow the hilight on receiving an enter
	    event, but wait for the motion notify to update the cursor
	    co-ordinates, otherwise we may hilight something quite distant
	    from the cursor.

2007-11-15  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (deepinvte_terminal_leave):
	    Mark the cursor as invisible on leaving the terminal as this
	    stops the hilight matcher running whilst the cursor is absent.

2007-11-06  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_set_font_from_string_full): Allow NULL
	font argument.  Can be used to set antialias without setting font.

	* src/deepinvteapp.c (main): Fix antialias handling which was borked when
	moving to GOption.

2007-11-06  Behdad Esfahbod  <behdad@gnome.org>

	Bug 142640 – FcConfigSubstitute in place of _deepinvte_fc_defaults_from_gtk
	to get antialias and hinting value

	* src/deepinvtefc.c (_deepinvte_fc_defaults_from_gtk),
	(_deepinvte_fc_defaults_from_rdb): Replace _deepinvte_fc_defaults_from_gtk() with
	gtk_default_substitute() from Gtk+-2.6.  It's essentially the same
	thing, but not overriding elements of the pattern already present.
	Also remove a couple redundant calls.

2007-10-11  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 439384 – gnome-terminal on feisty crashes when giving wrong locale environment

	* src/deepinvte.c (deepinvte_terminal_set_encoding):
	    Fallback to using UTF-8 as the locale encoding. This prevents
	    subsequent crashes but may display gibberish in the output.

2007-10-05  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 483642 – deepinvte_terminal_feed crash when 8190 characters passed

	* src/deepinvte.c (deepinvte_terminal_feed):
	    Break the feed data into chunks.

2007-09-30  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvtexft.c (_deepinvte_xft_set_background_image):
		Skip retrieving the DeepinvteBg if the source is DEEPINVTE_BG_SOURCE_NONE
		as we neither need it to listen for changes to the background
		nor require it to load the pixmap (which is a no-op).

2007-09-30  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvtexft.c (_deepinvte_xft_destroy):
		Ensure the GdkPixmap is destroyed along with the DeepinvteXft
		context.

2007-09-26  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 480735 – Underlining whitespace not reliable

	Original patch by Steven Skovran.

	I really must remember to run vttest more often. (And to work within
	git-svn.)

	* src/deepinvte.c (deepinvte_terminal_draw_rows):
	    Do not skip spaces.

2007-09-26  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 480735 – Underlining whitespace not reliable

	Original one-liner by Steven Skovran.

	* src/deepinvte.c (deepinvte_terminal_draw_rows):
	    Do not try to over zealously skip whitespace. The goal is
	    to maintain the current run whilst avoiding adding spaces to
	    the glyph sequence - so check the cell fully for attribute
	    breaks and simply do not add it to the glyphs if it contains a
	    space.

2007-09-17  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.16.9.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.16.9.
	Bumped libtool version to 11:13:2.

2007-09-05  Behdad Esfahbod  <behdad@gnome.org>

	* perf/vim.sh: Wait for keypress when done, so one can do
	"deepinvte -c ./vim.sh" and not lose the final numbers.

	* src/deepinvtepango.c (_deepinvte_pango_destroy), (_deepinvte_pango_start),
	(_deepinvte_pango_end), (_deepinvte_pango_set_background_color),
	(_deepinvte_pango_set_background_image), (_deepinvte_pango_clear),
	(_deepinvte_pango_set_text_font), (_deepinvte_pango_get_using_fontconfig),
	(_deepinvte_pango_draw_text), (_deepinvte_pango_draw_has_char),
	(_deepinvte_pango_draw_rectangle), (_deepinvte_pango_fill_rectangle),
	(_deepinvte_pango_set_scroll):  General cleanup.  Also implement
	_deepinvte_pango_draw_has_char() using
	pango_layout_get_unknown_glyphs_count() when available.

2007-09-02  Behdad Esfahbod  <behdad@gnome.org>

	Bug 469862 – Handling of wrapped links in gnome-terminal is broken

	* src/deepinvteseq.c (deepinvte_sequence_handler_ce): Reset soft_wrapped.

2007-09-01  Chris Wilson  <chris@chris-wilson.co.uk>

	cf Bug 469862 – Handling of wrapped links in gnome-terminal is broken

	* src/deepinvte.c (deepinvte_terminal_get_text_range_maybe_wrapped):
	    Revert the last character is in last column check as that
	    behaviour is required to handle terminal resizing where the
	    screen contents are not reconstructed (e.g. bash).

2007-08-30  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 471901 – troubles with pad

	* src/deepinvte-private.h:
	* src/deepinvte.c (_deepinvte_invalidate_cells), (deepinvte_terminal_draw_rows),
	(deepinvte_terminal_paint): Don't abuse DEEPINVTE_PAD_WIDTH.

2007-08-30  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 469862 – Handling of wrapped links in gnome-terminal is broken

	* src/deepinvte.c (deepinvte_terminal_get_text_range_maybe_wrapped):
	    Check that the last character is in the last column before
	    adding a newline for autowrapped lines.

2007-08-30  Chris Wilson  <chris@chris-wilson.co.uk>

	* MAINTAINERS: Add myself to the list, as Behdad had suggested some
	time ago.

2007-08-30  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 153265 – Handle Sun Cut, Copy, Paste keys
	Patch by Brian Cameron.

	* doc/reference/tmpl/deepinvte.sgml:
	* src/deepinvte.c (deepinvte_terminal_class_init),
	(deepinvte_terminal_real_copy_clipboard), (deepinvte_terminal_copy_clipboard),
	(deepinvte_terminal_real_paste_clipboard),
	(deepinvte_terminal_paste_clipboard):
	* src/deepinvte.h:
	    Add key bindings for the special function keys.

2007-08-30  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (deepinvte_terminal_draw_rows): Bad manipulation of patches
	whilst attempting to apply the fix for Bug 434230 - net result was
	that the correct code was being circumvented.

2007-08-29  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 471484 – deepinvteapp resize weirdness

	* src/deepinvteapp.c (main): Distinguish between setting the geometry and
	disabling the use of geometry hints. A regression when converting to
	GOption based arguments.

2007-08-27  Behdad Esfahbod  <behdad@gnome.org>

	Bug 470690 – Typo at src/deepinvtexft.c "appropiate" should be "appropriate"

	* src/deepinvtexft.c (_deepinvte_xft_open_font_for_char): Fix typo.

2007-08-07  Behdad Esfahbod  <behdad@gnome.org>

	* MAINTAINERS: Add Userid field, remove Guilherme.

2007-08-03  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 434230 – Spaces are not underlined
	Original patch by Santtu Lakkala.

	* src/deepinvte.c (deepinvte_terminal_draw_rows): Only skip cells if we do not
	need to draw on top.

2007-08-03  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 450069 – deepinvte crash on removing a terminal tab

	* src/deepinvte.c (deepinvte_terminal_emit_eof), (deepinvte_terminal_queue_eof),
	(deepinvte_terminal_eof): Move the EOF emission to an idle handler so that
	the source is inactive whilst the DeepinvteTerminal is finalized.

2007-07-30  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.16.8.

	Quick followup release with no code changes, to fix missing
	documentation index in the tarball.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.16.8.
	Bumped libtool version to 11:12:2.

2007-07-27  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.16.7.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.16.7.
	Bumped libtool version to 11:11:2.

2007-07-27  Behdad Esfahbod  <behdad@gnome.org>

	Bug 337252 – ALT + Arrow keys don't work in irssi through gnome-terminal
	Patch by James Bowes

	* src/keymap.c (_deepinvte_keymap_map), (is_cursor_key),
	(_deepinvte_keymap_key_add_key_modifiers):
	* src/keymap.h:
	* src/deepinvte.c (deepinvte_terminal_key_press):
	Only switch to CSI for some cursor keys when in cursor app mode.

2007-06-25  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 448259 – Mapping for Ctrl-_
	Patch by Andrey Melnikov.

	* src/keymap.c: Add mapping for Ctrl-Minus.

2007-06-25  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 449809 – use python-config to get python includes
	Patch by Sebastien Bacher.

	* acinclude.m4: prefer python-config where available.

2007-06-25  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 450745 – DEEPINVTE's response to CSI 2 1 t incorrectly formatted
	Patch by Dale Sedivec.

	* src/deepinvteseq.c (deepinvte_sequence_handler_window_manipulation): Restore
	the missing 'L'.

2007-06-21  Christian Persch  <chpe@gnome.org>

	* configure.in:
	* src/Makefile.am: Move libtool versioning to configure so you just
	have to update one file for releasing. See bug #396265 comment 17.

2007-06-18  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.16.6.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.16.6.

	* src/Makefile.am: Bumped libtool version to 11:10:2.

2007-06-12  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (deepinvte_terminal_set_size): Call gtk_widget_queue_resize()
	after updating row/column count.

2007-06-11  Behdad Esfahbod  <behdad@gnome.org>

	Bug 372743 – deepinvte_terminal_set_colors doesn't work as advertised

	* src/deepinvte.c (deepinvte_terminal_set_colors): Allow 24-color palettes.

2007-06-09  Behdad Esfahbod  <behdad@gnome.org>

	Bug 445620 – Some characters shows different in different locales.
	Patch from Zealot

	* src/iso2022.c (_deepinvte_iso2022_state_set_codeset): Update ambiguous
	width.

2007-06-04  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.16.5.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.16.5.

	* src/Makefile.am: Bumped libtool version to 11:9:2.

2007-05-30  Chris Wilson  <chris@chris-wilson.co.uk>

	fcrozat pointed out 'some strange "underline" line where cursor is
	located and blinking'.

	Also reported in bug 442688.

	* src/deepinvte.c (deepinvte_terminal_draw_rows):
	    Continuation of the previous commit: catch a couple more locations
	    where we need to skip past the end of the line. The problem in
	    this case was we tried to use some uninitialised variables whilst
	    trying to draw the cell attributes.

2007-05-28  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.16.4.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.16.4.

	* src/Makefile.am: Bumped libtool version to 11:8:2.

2007-05-28  Chris Wilson  <chris@chris-wilson.co.uk>

	uws noted on IRC that 'deepinvte trunk does strange thingies with colors'

	* src/deepinvte.c (deepinvte_terminal_draw_rows):
	    When reaching the end-of-row be careful not to reset the
	    current text attributes (color, underlining, etc).

2007-05-25  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (deepinvte_terminal_expand_region),
	(deepinvte_terminal_paint_area):
	    Only add the borders to the clear area.

2007-05-23  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 429278 – Cursor drawn strangely in joe

	* src/deepinvte.c (deepinvte_terminal_expand_region),
	(deepinvte_terminal_paint_area):
	    Ensure the expanded regions are cell aligned.

2007-05-23  Chris Wilson  <chris@chris-wilson.co.uk>

	cf Bug 439247 – scrolling vim in full screen is painfully slow and takes up 100% of the cpu

	* src/deepinvte.c (deepinvte_terminal_draw_rows):
	    Fix up the unwanted break of Glyph runs at the end-of-lines.

2007-05-23  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 440475 – Display glitch with transparent backgroud

	* src/deepinvte.c (deepinvte_terminal_paint_area):
	    Apply the band-aid fix to clear the area that's about to be
	    repainted. The full solution will to be ensure that the regions
	    after expansion are cell-aligned.

2007-05-22  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 375112 – ctrl-key combinations yielding just key
	Original patch by <samo@altern.org> and refactored by Loïc Minier.

	* src/deepinvte.c (deepinvte_translate_national_ctrlkeys),
	(deepinvte_terminal_key_press):
	    When cooking a string to pass through to the client obtain the
	    "raw" keyval.

2007-05-22  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 440377 – gnome-terminal cannot refresh terminal when accessibility enabled
	Original patch by Li Yuan.

	* src/deepinvteaccess.c (deepinvte_terminal_accessible_focus_in),
	(deepinvte_terminal_accessible_focus_out),
	(deepinvte_terminal_accessible_visibility_notify):
	    Return FALSE rather than void...

2007-05-17  Chris Wilson  <chris@chris-wilson.co.uk>

	* perf/scroll.vim:
	* perf/vim.sh:
	    Measure full screen scrolling performance.

2007-05-15  Chris Wilson  <chris@chris-wilson.co.uk>

	kmaraas reported an issue on IRC where the scrollback was not being
	updated correctly in the first tab when the terminal was resized via
	a second tab.

	* src/deepinvte.c (deepinvte_terminal_size_allocate): Check whether we need to
	recompute the visible lines due to a change in layout geometry.

2007-04-27  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 433776 – gnome-terminal crashes when open preedit area
	Take 2.

	* src/deepinvte.c (deepinvte_terminal_paint): The preedit_cursor is returned by
	the input modules in characters not in bytes as assumed by the
	validation.

2007-04-27  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 433776 – gnome-terminal crashes when open preedit area

	* src/deepinvte.c (deepinvte_terminal_paint): Use the validated cursor index.

2007-04-27  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.16.3.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.16.3.

	* src/Makefile.am: Bumped libtool version to 11:7:2.

2007-04-24  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 429189 – Deepinvte-WARNING's

	* src/deepinvtexft.c (_deepinvte_xft_open_font_for_char):
		Convert the warning into a DEBUG.

2007-04-24  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 415044 – Use --enable-debug rather than --enable-debugging

	As noted on Bug 414716, the convention is to use --enable-debug
	to enable extra debugging code.

	* configure.in:
		s/debugging/debug/

2007-04-24  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 414716 – Refresh issue after changing workspaces

	* src/deepinvte.c (deepinvte_terminal_hierarchy_changed):
		Do not respond to toplevel mapping events.

2007-04-23  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.16.2.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.16.2.

	* src/Makefile.am: Bumped libtool version to 11:6:2.

2007-04-23  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 431799 – Regex highlighting is broken

	* src/deepinvte.c (deepinvte_terminal_emit_contents_changed),
	(deepinvte_terminal_match_hilite_update), (process_timeout),
	(update_repeat_timeout), (update_timeout):
		Always emit any pending updates before redrawing. This
		ensures for example that the match contents are updated
		after a simple scroll event.

2007-04-20  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvtexft.c (_deepinvte_xft_start), (_deepinvte_xft_clip):
		Optimise away the use of a clip mask for the common case
		of redrawing the whole terminal.

2007-04-17  Behdad Esfahbod  <behdad@gnome.org>

	* src/iso2022.c (_deepinvte_iso2022_ambiguous_width): Consider
	ambiguous-width chars if DEEPINVTE_CJK_WIDTH env var is set and we are
	under a CJK locale.

2007-03-12  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.16.1.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.16.1.

	* src/Makefile.am: Bumped libtool version to 11:5:2.

2007-04-06  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 426870 – deepinvte often passes NUL to functions requiring valid unichar

	* src/deepinvte.c (_deepinvte_invalidate_cell), (_deepinvte_invalidate_cursor_once),
	(deepinvte_terminal_paint):
		Consistently guard against cell->c == '\0' before calling
		_deepinvte_draw_get_char_width.

2007-04-06  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 419644 – Links do not get highlighted anymore
	Also see Bug 404757 – URL matching doesn't work with PCRE

	* configure.in:
		Kill --with-pcre as it changes the semantics of the API
		and only causes confusion.

2007-04-05  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 426541 – crash on IRM escape code

	* src/deepinvte.c (deepinvte_terminal_ensure_cursor),
	(_deepinvte_terminal_insert_char):
		Mishandled insertion - we always extended the row for
		inserts even though the row would automagically extend
		for the inserted cells. This lead to referencing
		uninitialised cells at the end of the row during painting.
	* src/deepinvte.c (deepinvte_terminal_draw_rows):
		Retrieve the cell before inspecting it.

2007-04-04  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 424184 – Make scroll wheel send Page Up/Down when it makes sense

	Original patch by Shaun McCance and refined by Baris Cicek.

	* src/deepinvte.c (deepinvte_terminal_scroll):
		Send cursor keypress instead of trying to scroll the
		alternate screen in vain.

2007-04-03  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 425767 – deepinvte_terminal_set_color_highlight should test for
	NULL before _deepinvte_debug_print

	* src/deepinvte.c (deepinvte_terminal_set_color_cursor),
	(deepinvte_terminal_set_color_highlight):
		Differentiate between set/unset paths.

2007-03-25  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 422385 – deepinvte appears at the top of the root window even when
	packed at the bottom of it

	Patch by Dodji Seketeli.

	* src/deepinvte.c (deepinvte_terminal_size_allocate), (deepinvte_terminal_realize):
		Honour the allocated position when realizing the widget.

2007-03-22  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvtexft.c (_deepinvte_xft_draw_text):
		Insert spaces into the Xft glyph stream to avoid the
		overhead of restarting a glyph sequence for every word.

2007-03-21  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 420935 – glyph can be cropped with not fitting in a cell

	* src/deepinvte.c (deepinvte_terminal_paint):
		Don't redraw the invisible cursor 
		- avoids nasty artifacts like clipping extra wide glyphs.

2007-03-19  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (deepinvte_terminal_scroll_pages):
		Leave 'contents-change' to the scroll handler.

2007-03-19  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (deepinvte_terminal_extend_selection),
	(deepinvte_terminal_draw_rows):
		Accidentally inverted an is-empty? check during the 
		elimination of the empty bitfield.

2007-03-19  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 420067 – Does not handle expose events whilst processing
	unseen incoming data

	* src/deepinvte.c (deepinvte_terminal_expose):
		Handle the expose immediately if we are only processing
		incoming data (ie no redraws pending).

2007-03-16  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvteseq.c (deepinvte_sequence_handler_cursor_character_absolute):
		Remove a chunk of code that was tried as a mutt band-aid
		long ago and was completely wrong.

2007-03-16  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 415381 – Improve performance of deepinvte_terminal_insert_char()

	The bulk of the work to remove redundant reads and conditionals
	from the code. In particular, gcc was emitting bit-by-bit copies
	for transferring the bitfield since we modified a member immediately
	afterwards - overcome this by using an explicit memcpy of the
	bitfields.

	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_g_array_fill), (deepinvte_terminal_ensure_cursor),
	(_deepinvte_terminal_insert_char), (deepinvte_terminal_process_incoming),
	(deepinvte_terminal_send):
	* src/deepinvteseq.c (deepinvte_sequence_handler_ic):

2007-03-16  Chris Wilson  <chris@chris-wilson.co.uk>

	cf Bug 415381 – Improve performance of deepinvte_terminal_insert_char()

	* src/deepinvte-private.h: Use a simple boolean rather than counter for
	text changed style flags.
	* src/deepinvte.c: And update users.
	* src/deepinvteseq.c:

2007-03-16  Chris Wilson  <chris@chris-wilson.co.uk>

	cf Bug 415381 – Improve performance of deepinvte_terminal_insert_char()

	* src/deepinvte-private.h: Embed bitfield into struct
	* src/deepinvte.c:  And update users.
	* src/deepinvteseq.c:

2007-03-16  Chris Wilson  <chris@chris-wilson.co.uk>

	Need to trigger update timeout rather than process timeout
	otherwise the background is not updated.

	* src/deepinvte.c (deepinvte_terminal_queue_adjustment_changed),
	(deepinvte_terminal_queue_adjustment_value_changed):

2007-03-16  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvtexft.c (_deepinvte_xft_create), (_deepinvte_xft_destroy),
	(_deepinvte_xft_start), (_deepinvte_xft_end), (_deepinvte_xft_clip),
	(_deepinvte_xft_clear): Avoid some allocations.

2007-03-16  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 418073 – Opacity ignored for deepinvtexft

	* src/deepinvte.c:
	* src/deepinvtedraw.c (_deepinvte_draw_requires_clear):
	* src/deepinvtedraw.h:
	* src/deepinvteft2.c (_deepinvte_ft2_set_background_image):
	* src/deepinvtegl.c (_deepinvte_gl_create), (_deepinvte_gl_set_background_image):
	* src/deepinvtepango.c (_deepinvte_pango_set_background_image):
	* src/deepinvtepangox.c (_deepinvte_pango_x_set_background_image):
	* src/deepinvtexft.c (_deepinvte_xft_set_background_color),
	(_deepinvte_xft_set_background_image):
		Flood fill the backing pixmap if we need to change it's
		opacity as well.

2007-03-16  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 418910 – Asymmetric scrolling with mouse wheel

	* configure.in:
	* src/deepinvte.c: Round-up the delta before applying to ensure consistency
	between up and down.

2007-03-16  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (deepinvte_terminal_catch_child_exited), (deepinvte_terminal_eof),
	(deepinvte_terminal_process_incoming): Refactor some common code.

2007-03-16  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 416634 – Rendering glitch as autowrapped chars are outside invalidated bbox

	* src/deepinvte.c (_deepinvte_terminal_insert_char),
	(deepinvte_terminal_process_incoming): Correctly update bbox after
	autowrapping.

2007-03-16  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 416635 – Rendering glitch: double draw of line below exposed region

	* src/deepinvte.c (deepinvte_terminal_expand_region),
	(deepinvte_terminal_paint_area): Kill a couple of off-by-ones.

2007-03-16  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 418588 – Invalid read when drawing preedit cursor

	* src/deepinvte.c (deepinvte_terminal_paint):
		No need to read what is drawn and furthermore isn't allocated.

2007-03-16  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 417652 – Scrolling bug exposed by nvi

	* src/deepinvte.c (deepinvte_terminal_insert_rows), (_deepinvte_terminal_ensure_row),
	(deepinvte_terminal_ensure_cursor), (_deepinvte_terminal_update_insert_delta):
		Ensure the rows before updating the insert delta and refactor
		the common code.

2007-03-16  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 417301 – Terminal widgets don't respond to DPI changes

	* src/deepinvte.c (deepinvte_terminal_fc_settings_changed): Force a font reload
	after XFT settings have changed.

2007-03-12  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.16.0.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.16.0.

	* src/Makefile.am: Bumped libtool version to 11:4:2.

2007-03-06  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvteseq.c (deepinvte_sequence_handler_cm), (deepinvte_sequence_handler_sf):
		More work to match mutt's behaviour under xterm.

2007-03-05  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (deepinvte_terminal_io_read):
		Use the process estimate to load balance between multiple
		active terminals.

2007-03-05  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvteseq.c (deepinvte_sequence_handler_cm),
	(deepinvte_sequence_handler_dc), (deepinvte_sequence_handler_sf),
	(deepinvte_sequence_handler_cursor_character_absolute):
		Tweak the fill of painted cells to match mutt's behaviour
		under xterm.

2007-03-05  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 414716 – gnome-terminal-2.17.92: terminal window dies...

	* src/deepinvte.c (deepinvte_terminal_map_toplevel),
	(deepinvte_terminal_hierarchy_changed):
		Force the visibility state to unobscured after the toplevel is
		remapped.

2007-03-05  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (deepinvte_terminal_size_allocate):
		Note to self: Never try to optimize away the redraw.

2007-03-05  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (_deepinvte_terminal_insert_char):
	* src/deepinvtedraw.c (_deepinvte_draw_text), (_deepinvte_draw_char),
	(_deepinvte_draw_fill_rectangle), (_deepinvte_draw_draw_rectangle):
		Touch up whitespace in debug output.

2007-03-05  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (_deepinvte_invalidate_cells), (deepinvte_terminal_set_visibility),
	(deepinvte_terminal_paint_area), (deepinvte_terminal_expose):
		Make sure the invalidated_all flag is cleared in the expose
		event if we handle it immediately.

2007-03-05  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvteseq.c (deepinvte_sequence_handler_ce),
	(deepinvte_sequence_handler_clear_current_line):
		Fixup invalidation to end-of-line.

2007-03-05  Chris Wilson  <chris@chris-wilson.co.uk>

	cf Bug 414586 – Terminal screen blinks when menu is opened for the first time

	* src/deepinvte.c (deepinvte_terminal_draw_rows), (deepinvte_terminal_expand_region):
		Include the window padding when painting the cell backgrounds.

2007-03-05  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 414586 – Terminal screen blinks when menu is opened for the first time

	Avoid resetting the window background colour when the style is reset.
	Avoid clearing the window if we are using a simple color and double
	bufferring (i.e when we know we are using a pre-cleared pixmap).

	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_terminal_init), (deepinvte_terminal_size_allocate),
	(deepinvte_terminal_unrealize), (deepinvte_terminal_realize),
	(deepinvte_terminal_paint_area), (deepinvte_terminal_expose),
	(deepinvte_terminal_class_init), (deepinvte_terminal_background_update):
	* src/deepinvtedraw.c (_deepinvte_draw_has_background_image):
	* src/deepinvtedraw.h:
	* src/deepinvteft2.c (_deepinvte_ft2_set_background_image):
	* src/deepinvtegl.c (_deepinvte_gl_set_background_image):
	* src/deepinvtepango.c (_deepinvte_pango_set_background_image):
	* src/deepinvtepangox.c (_deepinvte_pango_x_set_background_image):
	* src/deepinvtexft.c (_deepinvte_xft_set_background_image):

2007-03-05  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 414586 – Terminal screen blinks when menu is opened for the first time

	* src/deepinvte.c (_deepinvte_invalidate_cells), (_deepinvte_invalidate_all),
	(deepinvte_terminal_expose), (add_update_timeout):
		Juggle the handling of external exposes/invalidates to avoid
		delays in refreshing the display when we are idle.

2007-03-05  Chris Wilson  <chris@chris-wilson.co.uk>

	cf Bug 414586 – Terminal screen blinks when menu is opened for the first time

	* src/deepinvte.c (_deepinvte_invalidate_cells), (deepinvte_terminal_init),
	(deepinvte_terminal_expand_region), (deepinvte_terminal_paint_area):
		After enlarging the expand region make sure the dirty area
		includes the border for edge cells.

2007-03-04  Chris Wilson  <chris@chris-wilson.co.uk>

	cf Bug 414586 – Terminal screen blinks when menu is opened for the first time

	Distinguish between internal update requests and external. If we
	need to update due to a user action (such as adjusting the background
	or color palette) do not impose a futher delay.

	Tidy the color palette modification code to not trigger invalidates if
	we do not actually modify the palette.

	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_terminal_set_color_internal),
	(deepinvte_terminal_set_color_bold), (deepinvte_terminal_set_color_dim),
	(deepinvte_terminal_set_color_foreground),
	(deepinvte_terminal_set_color_background),
	(deepinvte_terminal_set_color_cursor),
	(deepinvte_terminal_set_color_highlight), (deepinvte_terminal_set_colors),
	(root_pixmap_changed_cb), (deepinvte_terminal_set_background_saturation),
	(deepinvte_terminal_set_background_tint_color), (add_update_timeout):
	* src/deepinvteseq.c (deepinvte_sequence_handler_ce),
	(deepinvte_sequence_handler_clear_current_line),
	(deepinvte_sequence_handler_clear_above_current):

2007-03-02  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 413068 – new line added to tab when opened

	* src/deepinvte.c (deepinvte_terminal_size_allocate):
		Replace the ill-conceived attempt (delta could not be
		negative, so insert_delta or scroll_delta would not become
		negative either) by only considering changes wrt to the number
		of visible lines.

2007-03-02  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 413068 – new line added to tab when opened

	* src/deepinvte.c (_deepinvte_terminal_insert_char):
		Improve debug output.
	* src/deepinvte.c (deepinvte_terminal_size_allocate):
		Be careful that we don't force insert_delta or scroll_delta
		to become negative.

2007-03-01  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.15.6.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.15.6.

	* src/Makefile.am: Bumped libtool version to 11:3:2.

2007-03-01  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (deepinvte_terminal_draw_cells), (deepinvte_terminal_draw_rows),
	(deepinvte_terminal_paint):
		Tweak the clear widths to include the pixel widening due to
		psuedo-bold.

2007-03-01  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte-private.h:
	* src/deepinvte.c (_deepinvte_terminal_ensure_row),
	(deepinvte_terminal_ensure_cursor), (_deepinvte_terminal_insert_char):
	* src/deepinvteseq.c (deepinvte_sequence_handler_ta):
		Be more careful when filling in gaps.

2007-03-01  Chris Wilson  <chris@chris-wilson.co.uk>

	Fix X11 headers / libraries detection on bi-arch systems.
	Patch by Frederic Crozat.

	* configure.in:
		Check for x_includes before ac_x_includes, and similary for
		ac_x_libraries.

2007-03-01  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 410534 – Slow content scrolling, takes 100% of CPU.

	* src/deepinvtexft.c:
		Further reduce the cap to 80 after more testing on the
		broken fglrx driver.

2007-02-28  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 413068 – new line added to tab when opened

	* src/deepinvte.c (deepinvte_terminal_ensure_font), (deepinvte_terminal_realize):
		Beware when no font is set before the first request...
		Make sure that at least the default font is set.

2007-02-28  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 413262 – Incorrectly coloured tabs

	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_terminal_ensure_cursor),
	(_deepinvte_terminal_ensure_cursor), (_deepinvte_terminal_insert_char),
	(_deepinvte_terminal_feed_chunks), (deepinvte_terminal_set_scrollback_lines):
	* src/deepinvteseq.c (deepinvte_sequence_handler_ta),
	(deepinvte_sequence_handler_request_terminal_parameters),
	(deepinvte_sequence_handler_return_terminal_status),
	(deepinvte_sequence_handler_send_primary_device_attributes):
		Fill the tab in the current color, else it will be filled at
		the time of writing the next character.

2007-02-28  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 413102 – Incorrect highlighting in vim

	* src/deepinvte-private.h:
	* src/deepinvte.c (_deepinvte_terminal_ensure_row),
	(_deepinvte_terminal_insert_char):
	* src/deepinvteseq.c(deepinvte_sequence_handler_cb),
	(deepinvte_sequence_handler_ce), (deepinvte_sequence_handler_cr),
	(deepinvte_sequence_handler_ec), (deepinvte_sequence_handler_sf):
		Paint the row background when scrolling, this more closely
		matches xterm's behaviour.

2007-02-28  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 413158 – Cursor trails

	* src/deepinvte.c (_deepinvte_invalidate_cell):
		_deepinvte_invalidate_cell() can be called to invalidate any visible
		cell so issue the invalidate even for blank cells.

2007-02-28  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c (_deepinvte_terminal_insert_char):
		Correct the OBO in the number of columns ensured.

2007-02-28  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 413078 – Crash during opening a new tab whilst scrolling
	
	During input processing it was possible to both remove the timeout and
	then add a new one. The currently running timeout would believe that
	it was to continue since the terminal was still active, and so *two*
	timeouts would be scheduled. Occasionally the second timeout would be
	called after the first had finished all the work, resulting in the
	second timeout trying to access a NULL active_terminal list.

	* src/deepinvte.c (add_update_timeout), (remove_from_active_list),
	(deepinvte_terminal_add_process_timeout), (need_processing),
	(process_timeout), (update_repeat_timeout), (update_timeout):
		Watch for recursive g_source_remove() from within timeouts.

2007-02-28  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 410534 – Slow content scrolling, takes 100% of CPU.

	Submitting long glyph runs was causing a dramatic (10x) slow down
	in the fglrx xserver.

	* src/deepinvtedraw.h:
	* src/deepinvtexft.c(_deepinvte_xft_draw_text):
		Cap the max glyph run length to 300.

2007-02-28  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 412717 – Crash when opening a new tab with window maximized

	* src/deepinvte.c (deepinvte_terminal_size_allocate):
		We didn't carefully check the values we were clamping the
		cursor to and ended up setting it to -1...  Don't do that!

2007-02-27  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvteaccess.c (deepinvte_terminal_accessible_text_scrolled):
		Consistently guard against the snapshot being NULL.

2007-02-27  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.15.5.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.15.5.

	* src/Makefile.am: Bumped libtool version to 11:2:2.

2007-02-27  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 412562 – Crash in deepinvte_terminal_match_hilite_update

	* src/deepinvte.c (deepinvte_terminal_match_check_internal),
	(deepinvte_terminal_process_incoming), (_deepinvte_terminal_feed_chunks),
	(deepinvte_terminal_paste_cb), (deepinvte_terminal_match_hilite_update),
	(deepinvte_terminal_copy_cb):
		Fixup a few 64bit-isms, notably format strings and an
		undesired unsigned integer promotion causing this crash.

2007-02-27  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 410986 – Fails to build with -z defs

	If you link the deepinvtemodule.so to libpython, then programs importing
	deepinvte will have the symbols twice in memory: one set from python and
	the other from libpython.

	* configure.in:
	* python/Makefile.am:
		Remove PYTHON_LIBS from linking deepinvtemodule.so.
		Convert unresolved symbol errors into warnings so that
		building with -Wl,-z,defs continues to work. This is a 
		*hack* as it hides real errors if you are updating
		deepinvte.{def,override}.
		
2007-02-27  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvtexft.c	(_deepinvte_xft_open_font_for_char),
	(_deepinvte_xft_font_for_char), (_deepinvte_xft_compute_char_width),
	(_deepinvte_xft_char_width), (_deepinvte_xft_start), (_deepinvte_xft_get_char_width),
	(_deepinvte_xft_draw_text):
		Avoid some computations whilst drawing text.

2007-02-26  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.15.4.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.15.4.

	* src/Makefile.am: Bumped libtool version to 11:1:2.

2007-02-26  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 410986 – Fails to build with -z defs

	The forgotten half - the python module also fails to link.

	* acinclude.m4:
	* python/Makefile.am:
		Add PYTHON_LIBS pointing to the customary location and
		remember to include them when compiling deepinvtemodule.so.

2007-02-26  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 412361 – Yet another mouse selection regression...
	Part 2.

	* src/deepinvte.c: (deepinvte_terminal_queue_adjustment_value_changed),
	(_deepinvte_terminal_adjust_adjustments_full),
	(deepinvte_terminal_scroll_pages), (deepinvte_terminal_autoscroll),
	(deepinvte_terminal_size_allocate), (deepinvte_terminal_scroll):
		We implicitly used a bit of sanity checking when setting the
		adjustment value. Ensure the value really is within the
		adjustment range before updating scroll_delta.

2007-02-26  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 412361 – Yet another mouse selection regression...
	Part 1.

	* src/deepinvte.c: (deepinvte_terminal_draw_rows):
		Restore drawing of the selection below the text.

2007-02-26  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_class_init), (time_process_incoming),
	(process_timeout), (update_repeat_timeout), (update_timeout):
		Update max number of processable bytes each time we call
		deepinvte_terminal_process_incoming().

2007-02-26  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_emit_adjustment_changed),
	(_deepinvte_terminal_adjust_adjustments_full):
		Refactor the common code.

2007-02-26  Chris Wilson  <chris@chris-wilson.co.uk>

	Push a couple of NULL checks to the callers so to be able to move them
	outside of the inner-most loops.

	* src/deepinvte.c: (_deepinvte_row_data_find_charcell), (_deepinvte_invalidate_cell),
	(_deepinvte_terminal_adjust_adjustments),
	(deepinvte_terminal_get_text_range_maybe_wrapped), (find_start_column),
	(find_end_column), (deepinvte_terminal_draw_rows):

2007-02-26  Chris Wilson  <chris@chris-wilson.co.uk>

	Some applications, such as cat, dump as much data to the terminal as
	possible. In these scenarios it is likely that we will read data from
	the child much faster than we can process it and the refresh will
	stutter.

	The ideal solution would be to speed up the data processing so that
	this overrun was impossible. However, the approach taken here is to
	estimate how much data we can actually process in our time slice and
	to stop reading once we have sufficient data.

	* src/deepinvte-private.h:
	* src/deepinvte.c: (_deepinvte_invalidate_all),
	(deepinvte_terminal_emit_contents_changed),
	(deepinvte_terminal_match_contents_clear),
	(deepinvte_terminal_match_contents_refresh),
	(deepinvte_terminal_emit_adjustment_changed),
	(_deepinvte_terminal_adjust_adjustments), (deepinvte_terminal_scroll_pages),
	(deepinvte_terminal_catch_child_exited), (deepinvte_terminal_eof),
	(deepinvte_terminal_process_incoming), (deepinvte_terminal_io_read),
	(deepinvte_terminal_handle_scroll), (deepinvte_terminal_init),
	(deepinvte_terminal_size_allocate), (need_processing), (process_timeout),
	(update_repeat_timeout), (update_timeout):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_decset_internal):

2007-02-26  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 411000 – Orca repeats old text in gnome-terminal

	The deferred handling of the window scrolling had the unfortunate
	side-effect of postponing the accessibility 'text-scrolled' signal
	until after the 'text-inserted' signal. This caused deepinvteaccess to
	determine that the whole window had been modified and cause orca to
	reread the entire screen.

	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_emit_contents_changed),
	(_deepinvte_terminal_queue_contents_changed),
	(deepinvte_terminal_emit_cursor_moved),
	(deepinvte_terminal_queue_cursor_moved), (deepinvte_terminal_scroll_pages),
	(deepinvte_terminal_eof), (deepinvte_terminal_emit_pending_text_signals),
	(deepinvte_terminal_process_incoming), (deepinvte_terminal_handle_scroll),
	(deepinvte_terminal_size_allocate), (deepinvte_terminal_unrealize),
	(deepinvte_terminal_emit_pending_signals):
	* src/deepinvteaccess.c: (emit_text_caret_moved),
	(emit_text_changed_insert), (emit_text_changed_delete):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_decset_internal):
		Restore the order of the ally signals. However, Bug 372777
		remains unresolved.

2007-02-26  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_io_read):
		Eeek, correctly compute the buffer length when we no longer
		aim to fill it.

2007-02-26  Chris Wilson  <chris@chris-wilson.co.uk>

	Use a separate debug flag for the ally interface.

	* src/debug.c: (_deepinvte_debug_parse_string):
	* src/debug.h:
	* src/deepinvteaccess.c:
	(deepinvte_terminal_accessible_update_private_data_if_needed),
	(deepinvte_terminal_accessible_invalidate_cursor),
	(deepinvte_terminal_accessible_finalize),
	(deepinvte_terminal_accessible_get_text),
	(deepinvte_terminal_accessible_get_text_somewhere),
	(deepinvte_terminal_accessible_text_init),
	(deepinvte_terminal_accessible_component_init),
	(deepinvte_terminal_accessible_action_init),
	(deepinvte_terminal_accessible_factory_new):

2007-02-26  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_io_read):
		And finally clamp the maximum number of bytes transferred in
		a single chunk.

2007-02-24  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c:
		Hint that the compiler should inline
		deepinvte_terminal_determine_colors().

2007-02-24  Chris Wilson  <chris@chris-wilson.co.uk>

	cf Bug 410534 – Slow content scrolling, takes 100% of CPU.
	cf Bug 410463 – Poor interactive performance with multiple terminals

	* src/deepinvte.c: (deepinvte_terminal_io_read):
		Do not loop whilst reading in a backlog of child data - should
		help prevent monopolisation of deepinvte by a single child and make
		deepinvte more responsive to user input on slower computers.

2007-02-24  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 159078 – slow highlight

	Do not update the match hilite during a selection-drag.
	Record unsuccesful regex matches, so we can quickly determine whether
	the cursor is still inside the blank region.

	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_match_check_internal),
	(rowcol_inside_match), (deepinvte_terminal_match_check),
	(_deepinvte_terminal_set_pointer_visible),
	(deepinvte_terminal_match_hilite_clear),
	(deepinvte_terminal_match_hilite_show), (deepinvte_terminal_match_hilite_hide),
	(deepinvte_terminal_match_hilite_update), (deepinvte_terminal_match_hilite),
	(deepinvte_terminal_motion_notify), (deepinvte_terminal_button_press),
	(deepinvte_terminal_focus_in), (deepinvte_terminal_focus_out),
	(deepinvte_terminal_enter), (deepinvte_terminal_leave), (deepinvte_terminal_init),
	(deepinvte_terminal_unrealize), (deepinvte_terminal_draw_rows),
	(deepinvte_terminal_paint):

2007-02-23  Chris Wilson  <chris@chris-wilson.co.uk>

	A couple of compiler warnings and avoid unnecessary arithmetic.

	* src/deepinvte.c: (_deepinvte_terminal_set_default_attributes),
	(find_start_column), (find_end_column),
	(deepinvte_terminal_start_selection), (deepinvte_terminal_extend_selection),
	(deepinvte_terminal_draw_rows), (deepinvte_terminal_paint):
	* src/deepinvtexft.c: (_deepinvte_xft_font_open), (_deepinvte_xft_font_for_char),
	(_deepinvte_xft_char_width), (_deepinvte_xft_unlock_fonts), (_deepinvte_xft_start),
	(_deepinvte_xft_clip), (_deepinvte_xft_set_text_font), (_deepinvte_xft_draw_text):

2007-02-23  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 411276 – SVN trunk compilation error
	Part 2.

	* configure.in:
		Check that the header file defines FcStrFree before checking
		for the availability of the function. Complete hack, but
		appears to work.

2007-02-23  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 411276 – SVN trunk compilation error

	* configure.in:
		Ubuntu Edgy appears to have a broken fontconfig-dev package
		where the function is exported from the library but is missing
		the corresponding prototypes.
		So we reorder the determination of the compilation flags
		before checking for available functions in the hope that the
		tests will then match the results at compile time.

2007-02-23  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_io_read):
		Prevent a deadlock on recursively grabbing the gdk_mutex.

2007-02-23  Chris Wilson  <chris@chris-wilson.co.uk>

	Heuristic to avoid a read when it's likely to just return EAGAIN.

	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_io_read), (process_timeout),
	(update_repeat_timeout), (update_timeout):

2007-02-23  Chris Wilson  <chris@chris-wilson.co.uk>

	Add a new debug flag to monitor draw operations.
	Don't issue individual glyphs for is_local_graphic() in the middle of
	a run.

	* src/debug.c: (_deepinvte_debug_parse_string):
	* src/debug.h:
	* src/deepinvte.c: (deepinvte_terminal_unichar_is_local_graphic),
	(deepinvte_terminal_draw_rows), (deepinvte_terminal_paint):
	* src/deepinvtedraw.c: (_deepinvte_draw_init_user), (_deepinvte_draw_init_default),
	(_deepinvte_draw_new), (_deepinvte_draw_free), (_deepinvte_draw_get_visual),
	(_deepinvte_draw_get_colormap), (_deepinvte_draw_start), (_deepinvte_draw_end),
	(_deepinvte_draw_set_background_color), (_deepinvte_draw_set_background_image),
	(_deepinvte_draw_requires_repaint), (_deepinvte_draw_clip), (_deepinvte_draw_clear),
	(_deepinvte_draw_set_text_font), (_deepinvte_draw_get_text_width),
	(_deepinvte_draw_get_text_height), (_deepinvte_draw_get_text_ascent),
	(_deepinvte_draw_get_char_width), (_deepinvte_draw_get_using_fontconfig),
	(_deepinvte_draw_text), (_deepinvte_draw_char), (_deepinvte_draw_has_char),
	(_deepinvte_draw_fill_rectangle), (_deepinvte_draw_draw_rectangle),
	(_deepinvte_draw_set_scroll):
	* src/deepinvtedraw.h:
	* src/deepinvteft2.c: (_deepinvte_ft2_draw_has_char):
	* src/deepinvtegl.c: (_deepinvte_gl_draw_has_char):
	* src/deepinvtepango.c: (_deepinvte_pango_draw_has_char):
	* src/deepinvtepangox.c: (_deepinvte_pango_x_draw_has_char):
	* src/deepinvteskel.c: (_deepinvte_skel_draw_has_char):
	* src/deepinvtexft.c: (_deepinvte_xft_draw_has_char):

2007-02-23  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_draw_rows):
		Don't break a glyph run for a graphic, issue the draw
		and continue.

2007-02-23  Chris Wilson  <chris@chris-wilson.co.uk>

	Cache the font metrics on the deepinvte_xft_font, avoids having to remeasure
	when opening a new terminal.

	* src/deepinvtexft.c: (_deepinvte_xft_font_open), (_deepinvte_xft_set_text_font):

2007-02-23  Chris Wilson  <chris@chris-wilson.co.uk>

	Share XftFonts between terminal backends and preserve faces from the
	previous draw - helps prevents font cache thrashing inside libXft.

	* src/deepinvtexft.c: (_deepinvte_xft_font_hash), (_deepinvte_xft_font_equal),
	(_deepinvte_xft_font_open), (_deepinvte_xft_font_close),
	(_deepinvte_xft_font_for_char), (_deepinvte_xft_unlock_fonts),
	(_deepinvte_xft_destroy), (_deepinvte_xft_start), (_deepinvte_xft_end),
	(ptr_array_zeroed_new), (_deepinvte_xft_set_text_font),
	(_deepinvte_xft_get_char_width), (_deepinvte_xft_draw_text),
	(_deepinvte_xft_draw_char):

2007-02-22  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 410986 – Fails to build with -z defs
	Patch by Loïc Minier.

	* src/Makefile.am:
		Add FreeType to the libs.

2007-02-22  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_send):
		Return in the face of error as we appear to hit this in the
		wild.

2007-02-22  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 410819 – slider not correctly positioned after calling less

	* src/deepinvte.c: (_deepinvte_terminal_adjust_adjustments),
	(_deepinvte_terminal_adjust_adjustments_full),
	(deepinvte_terminal_maybe_scroll_to_top), (deepinvte_terminal_size_allocate),
	(deepinvte_terminal_set_scrollback_lines):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_decset_internal):
		Fixup a lot of issues with changing the number of scrollback
		lines, such as missing value_changed signals for the
		scrollbar and a couple of missing CLAMPs.

2007-02-22  Chris Wilson  <chris@chris-wilson.co.uk>

	After adjusting the current profile, the last line gets chomped.

	* src/deepinvte.c: (deepinvte_terminal_set_scrollback_lines):

2007-02-21  Chris Wilson  <chris@chris-wilson.co.uk>

	cf Bug 410534 – Slow content scrolling, takes 100% of CPU.

	* src/deepinvte.c: (deepinvte_terminal_scroll),
	(deepinvte_terminal_set_scrollback_lines):
		Operate on scroll delta directly as adjustment->value updates
		are not instantaneous and we may have several scroll events
		before the next update.

2007-02-21  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 410463 – Poor interactive performance with multiple terminals

	* src/deepinvte.c: (deepinvte_terminal_io_read), (process_timeout),
	(update_repeat_timeout):
		When multiple terminals are active, poll the IO sources
		from within the process/display timeout (akin to 
		interrupt mitigation).
		Return to normal interrupts when we only have a single active
		terminal - so we don't sacrifice high performance.

2007-02-21  Chris Wilson  <chris@chris-wilson.co.uk>

	A small bit of callgrinding, avoid the modulus inside
	deepinvte_terminal_ensure_cursor() by caching the last row_data.

	* src/iso2022.c: (process_cdata):
	* src/ring.c: (_deepinvte_ring_new), (_deepinvte_ring_insert),
	(_deepinvte_ring_insert_preserve), (_deepinvte_ring_remove):
	* src/ring.h:
	* src/table.c: (_deepinvte_table_match):
	* src/deepinvte.c: (_deepinvte_terminal_ensure_cursor),
	(_deepinvte_terminal_insert_char), (deepinvte_terminal_process_incoming):

2007-02-21  Chris Wilson  <chris@chris-wilson.co.uk>

	Callgrind strikes again...
	Inserting a char is a rare operation (especially in the scrolling
	benchmark!) so only read the old cell during an insert. This wins
	about 5% during a hexdump.

	* src/iso2022.c: (_deepinvte_iso2022_find_nextctl),
	(_deepinvte_iso2022_fragment_input), (process_cdata):
	* src/deepinvte.c: (_deepinvte_terminal_insert_char):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_sf):

2007-02-21  Chris Wilson  <chris@chris-wilson.co.uk>

	RedHat Bug 113195: First line displayed incorrectly if prompt changes background color

	e.g. PS1='\e[46m[\u@\h:\w]\e[m \e[45m'
	The issue is when we insert a char on a new row and the background is
	not the default, we fill the entire row with the *current* colour.
	This behaviour is incorrect, and the fix is to fill to the end of the
	line on a carriage return.

	* src/deepinvte-private.h:
	* src/deepinvte.c: (_deepinvte_terminal_ensure_cursor),
	(_deepinvte_terminal_insert_char), (deepinvte_terminal_process_incoming),
	(deepinvte_terminal_send):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_ce),
	(deepinvte_sequence_handler_cr), (deepinvte_sequence_handler_cs),
	(deepinvte_sequence_handler_cS),
	(deepinvte_sequence_handler_cursor_lower_left),
	(deepinvte_sequence_handler_dc), (deepinvte_sequence_handler_ic),
	(deepinvte_sequence_handler_sf):

2007-02-20  Chris Wilson  <chris@chris-wilson.co.uk>

	 RedHat Bug 123845: gnome-terminal not parsing cursor position escape sequence properly

	* src/caps.c:
	* src/deepinvteseq.c: (deepinvte_sequence_handler_cm):
		Add 'ESC [ Pn H' to cursor-position and provide default
		values.

2007-02-19  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 409055 – Terminal stays blank

	Due to GTK+ coallescing of XExposeEvents it was possible for our
	GdkExposeEvent to arrive before the GdkVisibilityEvent associated with
	the mapping of our toplevel and so we discarded the event as we
	believed we were still unviewable.

	* src/deepinvte.c: (_deepinvte_invalidate_cells), (deepinvte_terminal_expose),
	(reset_update_regions):
		Assume that all GdkExposeEvents have been checked for
		suitability before delivery. We know this true for locally
		generated expose events which are extensively checked during
		invalidation, and we presume that X will not generate expose
		events on unmapped or otherwise unviewable windows.

2007-02-19  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (_deepinvte_terminal_adjust_adjustments),
	(_deepinvte_terminal_adjust_adjustments_full):
		Dead code elimination.

2007-02-19  Chris Wilson  <chris@chris-wilson.co.uk>

	* perf/random.sh:
		A simple script to dump a fixed amount of random data to the
		terminal.

2007-02-19  Chris Wilson  <chris@chris-wilson.co.uk>

	A few more trivial incremental improvements.

	* src/Makefile.am:
	* src/iso2022.c: (_deepinvte_iso2022_map_get):
		Switch to a DeepinvteTree.
	* src/deepinvte.c: (_deepinvte_terminal_update_insert_delta),
	(_deepinvte_terminal_insert_char):
		No need to ensure the cursor when scrolling, only before
		insertions.
	* src/deepinvtexft.c: (_deepinvte_xft_font_open), (_deepinvte_xft_font_close),
	(_deepinvte_xft_font_for_char), (_deepinvte_xft_end):
		Lock the face over the entire expose.

2007-02-19  Chris Wilson  <chris@chris-wilson.co.uk>

	Improve handling of parallel 'cat /dev/urandom' - notably a crasher
	in the table matcher, repeated g_getenv processing and wasted time
	in g_tree_lookup.

	* src/iso2022.c: (_deepinvte_iso2022_ambiguous_width_guess),
	(_deepinvte_iso2022_map_init), (_deepinvte_iso2022_map_get),
	(process_8_bit_sequence), (process_cdata),
	(_deepinvte_iso2022_process_single), (_deepinvte_iso2022_process):
	* src/table.c: (_deepinvte_table_match):
	* src/deepinvte-private.h:

2007-02-19  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (update_timeout):
		In conjunction with the previous fix, since the terminal
		can be removed from the active list by
		deepinvte_terminal_process_incoming() we need to be careful whilst
		iterating along the active list.

2007-02-19  Chris Wilson  <chris@chris-wilson.co.uk>

	<fcrozat> ickle: hi.. our kernel hacker just found a nice reproducible
		crash in deepinvte :)
	<ickle> oh, joy
	<fcrozat> very easy to reproduce
		cat /dev/urandom
	 	wait 2 or 3S
	 	then press Ctrl-Shift-T to open a new tab
	 	=> crash

	* src/deepinvte.c: (process_timeout), (update_repeat_timeout):
		deepinvte_terminal_process_incoming() can trigger a terminal reset
		which will remove the terminal from the active list, and then
		we attempt to remove it again after handling the incoming
		data. The fix is simple - don't delete the link if the the
		terminal is no longer active.

2007-02-19  Chris Wilson  <chris@chris-wilson.co.uk>

	As noticed on bug 409055, we do not receive a visibility-notify
	event when we switch workspaces (or even when the window is iconified).
	The workaround for this is to watch for our toplevel being unmapped
	and set the fully-obscured flag.

	* src/deepinvte.c: (deepinvte_terminal_configure_toplevel),
	(deepinvte_terminal_unmap_toplevel), (deepinvte_terminal_hierarchy_changed),
	(deepinvte_terminal_set_visibility), (deepinvte_terminal_visibility_notify):

2007-02-19  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (visibility_state_str),
	(deepinvte_terminal_visibility_notify), (deepinvte_terminal_init),
	(deepinvte_terminal_realize):
		Add the visibility state to the debug output.

2007-02-19  Chris Wilson  <chris@chris-wilson.co.uk>

	* configure.in:
		Add the configuration details to config.log as well.

2007-02-19  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 409241 – gnome-terminal crashed with SIGSEGV in deepinvte_terminal_draw_graphic()

	* src/deepinvte.c: (deepinvte_terminal_paint):
		Lookup fore/back colours before attempting to draw the graphic
		character behind the unfocused cursor.

2007-02-19  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_visibility_notify):
		Add DEEPINVTE_DEBUG_EVENT info.

2007-02-16  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 407945 – "GNOME" Terminal" regression after "deepinvte" update when using "csh"

	When passing multiple versions of the same environment
	variable to execve (i.e g_spawn) the result is undefined.
	So we solve the ambiguity by using the application passed env to
	override values from the current environment.
	
	* src/pty.c: (collect_variables), (merge_environ),
	(_deepinvte_pty_run_on_pty):

2007-02-16  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 408536 – trouble compiling deepinvte 0.15.3

	* configure.in:
	* src/deepinvtefc.c: (_deepinvte_fc_patterns_from_pango_font_desc):
		Check for availability of FcStrFree() - only used for
		debugging purposes so we can live without it.

2007-02-15  Chris Wilson  <chris@chris-wilson.co.uk>

	Guard against a missing default number of rows or columns
	inside the termcap.

	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_set_emulation), (deepinvte_terminal_init):

2007-02-15  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 408040 – deepinvte automagic hyperlinks
	Patch by Gilles Dartiguelongue.

	* src/deepinvteapp.c:
		Correct the typo in the nntp protocol matcher.

2007-02-14  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 407839 – Use of environ breaks build on Solaris
	Original patch by Damien Carbery.

	* src/pty.c:
		extern char **environ - glibc was 'conveniently' declaring
		it for us...

2007-02-13  Chris Wilson  <chris@chris-wilson.co.uk>

	uws reported that scrolling inside screen with a status line was
	broken. Indeed any scrolling inside an alternative screen was broken,
	e.g. plain vim would not always update the topmost line. The issue was
	the interaction with the deferred value-changed signal emission and
	failing to correctly maintain the current scroll_delta. The fix is
	that we always now apply changes to the scroll_delta and swap
	scroll_delta with adjustment->value before the deferred signal
	emission to correctly trigger the handle_scroll().

	* src/deepinvte-private.h:
	* src/deepinvte.c: (_deepinvte_invalidate_cells),
	(deepinvte_terminal_emit_adjustment_changed),
	(deepinvte_terminal_queue_adjustment_value_changed),
	(_deepinvte_terminal_adjust_adjustments),
	(_deepinvte_terminal_adjust_adjustments_full),
	(deepinvte_terminal_maybe_scroll_to_bottom),
	(deepinvte_terminal_process_incoming), (deepinvte_terminal_extend_selection),
	(deepinvte_terminal_handle_scroll), (deepinvte_terminal_set_scrollback_lines):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_sf):

2007-02-13  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 407358 – regression in mouse selection

	* src/deepinvte.c: (deepinvte_terminal_motion_notify):
		When outside the terminal we used an uninitialised variable to
		determine the mouse tracking mode.

2007-02-12  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.15.3.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.15.3.

	* src/Makefile.am: Bumped libtool version to 11:0:2.

2007-02-12  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_extend_selection),
	(deepinvte_terminal_motion_notify):
		Restore autoscroll behaviour.

2007-02-12  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_start_selection):
		Invalidate the selected region when starting in
		select-word or select-line mode.

2007-02-12  Chris Wilson  <chris@chris-wilson.co.uk>

	Restore double-click to select word behaviour, broken by r1671 as
	the second click occurs in the same place as the first (obviously!).

	* src/deepinvte.c: (deepinvte_terminal_extend_selection),
	(deepinvte_terminal_autoscroll), (deepinvte_terminal_motion_notify),
	(deepinvte_terminal_button_press):

2007-02-12  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 407091 – deepinvte_terminal_fork_command() env argument changed semantic in 0.15.2
	Original patch by Michael Vogt.

	* src/pty.c: (_deepinvte_pty_run_on_pty):
		Copy the current environment into the child's.

2007-02-11  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 323393 – Hyper-sensitive selection

	* src/deepinvte.c: (deepinvte_terminal_extend_selection):
		Don't start (or update) the selection until you
		move off the current cell (character).

2007-02-11  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 406763 – Selecting double-wide characters

	* src/deepinvte.c: (start_column), (end_column),
	(deepinvte_terminal_start_selection), (deepinvte_terminal_extend_selection),
	(deepinvte_terminal_draw_rows):
		Extend selection to include fragment cells i.e. double-wide
		characters.

2007-02-10  Chris Wilson  <chris@chris-wilson.co.uk>

	Have a separate adjust_adjustments for when we know that the page
	size and step lengths may have changed.

	* src/deepinvte.c: (_deepinvte_terminal_adjust_adjustments),
	(_deepinvte_terminal_adjust_adjustments_full),
	(deepinvte_terminal_set_scrollback_lines), (deepinvte_terminal_reset):

2007-02-10  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (_deepinvte_terminal_adjust_adjustments),
	(deepinvte_terminal_size_allocate), (deepinvte_terminal_set_scrollback_lines):
		Prevent the display of garbage after resizing and switching
		between alternate screens.
		However, instead of displaying garbage after the cursor, we
		lose some data above the current scroll delta, should we have
		a full history.  Bizarre.

2007-02-09  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (_deepinvte_terminal_adjust_adjustments):
		Do not allow to scroll past the last line after reducing
		scrollback lines.
	* src/deepinvtexft.c: (_deepinvte_xft_set_text_font):
		Ensure a fallback height is set.

2007-02-09  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_get_text_range_maybe_wrapped):
		Reuse DeepinvteRowData whilst in the row.

2007-02-09  Chris Wilson  <chris@chris-wilson.co.uk>

	Rework to reduce number of times mutex is taken and shorten the hold.

	* src/deepinvte.c: (deepinvte_terminal_queue_adjustment_changed),
	(deepinvte_terminal_queue_adjustment_value_changed),
	(deepinvte_terminal_io_read), (deepinvte_terminal_paint),
	(deepinvte_terminal_add_process_timeout), (deepinvte_terminal_is_processing),
	(deepinvte_terminal_start_processing):

2007-02-09  Chris Wilson  <chris@chris-wilson.co.uk>

	A number of small bug fixes...
	- do not override the user setting of scrollback lines with the
	terminal size.
	- only set the current screen rather than both and so reset the
	scrollback lines when we switch between normal and alternate.
	- do not invalidate inside set_scrollback lines as setting does not
	actually modify the on-screen contents.
	- push the scroll-adjustment to the post-processing emission.
	- queue timeouts on value change (should be a no-op)
	- reorder emission so that scrolling occurs before invalidating the
	window (ie so that the scroll happens this cycle, not next).

	Still unsolved: the clamping of the cursor when switching between
	alternate screens.

	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_emit_adjustment_changed),
	(deepinvte_terminal_queue_adjustment_changed),
	(deepinvte_terminal_queue_adjustment_value_changed),
	(_deepinvte_terminal_adjust_adjustments), (deepinvte_terminal_scroll_pages),
	(deepinvte_terminal_maybe_scroll_to_top),
	(deepinvte_terminal_maybe_scroll_to_bottom),
	(_deepinvte_terminal_ensure_cursor), (_deepinvte_terminal_update_insert_delta),
	(deepinvte_terminal_process_incoming), (deepinvte_terminal_extend_selection),
	(deepinvte_terminal_autoscroll), (deepinvte_terminal_handle_scroll),
	(deepinvte_terminal_size_allocate), (deepinvte_terminal_scroll),
	(deepinvte_terminal_background_update),
	(deepinvte_terminal_queue_background_update),
	(deepinvte_terminal_set_scrollback_lines), (deepinvte_terminal_reset),
	(add_process_timeout), (deepinvte_terminal_add_process_timeout),
	(deepinvte_terminal_start_processing), (update_repeat_timeout),
	(update_timeout):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_scroll_up_or_down),
	(deepinvte_sequence_handler_decset_internal), (deepinvte_sequence_handler_al),
	(deepinvte_sequence_handler_dl), (deepinvte_sequence_handler_sf),
	(deepinvte_sequence_handler_sr), (deepinvte_sequence_handler_clear_screen),
	(deepinvte_sequence_handler_cursor_character_absolute),
	(deepinvte_sequence_handler_insert_lines),
	(deepinvte_sequence_handler_delete_lines),
	(deepinvte_sequence_handler_screen_alignment_test):

2007-02-08  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvteapp.c: (main): whitespace

2007-02-08  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 363597 – Scrollback in profile dialog doesn't work

	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_init),
		Only use SCROLLBACK_MIN during initialisation, so rename it
		to SCROLLBACK_INIT.
	(deepinvte_terminal_set_scrollback_lines):
		Remove MAX(lines, SCROLLBACK_MIN) and update code comments
		to reduce confusion.

2007-02-08  Mariano Suárez-Alvarez  <mariano@gnome.org>

	* src/deepinvteapp.c(main): do something useful with --geometry.

2007-02-08  Chris Wilson  <chris@chris-wilson.co.uk>

	Use gtk_widget_get_(screen|display) which will itself return a default
	if not currently attached.

	* src/deepinvtedraw.c: (_deepinvte_draw_get_colormap):
	* src/deepinvtefc.c: (_deepinvte_fc_defaults_from_gtk):
	* src/deepinvtegl.c: (_deepinvte_gl_check), (_deepinvte_gl_create),
	(_deepinvte_gl_destroy), (_deepinvte_gl_start), (_deepinvte_gl_end), (_deepinvte_gl_clear),
	(_deepinvte_gl_draw_text), (_deepinvte_gl_rectangle):
	* src/deepinvterdb.c: (_deepinvte_rdb_get):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_window_manipulation):

2007-02-08  Chris Wilson  <chris@chris-wilson.co.uk>

	Some more callgrinding - kill a little bit of overhead.

	* src/iso2022.c: (_deepinvte_iso2022_sequence_length),
	(_deepinvte_iso2022_fragment_input), (process_control):
	* src/matcher.c: (_deepinvte_matcher_free_params_array):
	* src/deepinvteconv.c: (_deepinvte_conv):

2007-02-07  Chris Wilson  <chris@chris-wilson.co.uk>

	Actually return whether or not we found the char in
	_deepinvte_xft_font_for_char - saves having to double check afterwards!

	* src/deepinvtexft.c: (_deepinvte_xft_font_for_char), (_deepinvte_xft_set_text_font),
	(_deepinvte_xft_draw_text):

2007-02-07  Chris Wilson  <chris@chris-wilson.co.uk>

	As spotted perusing roxterm, we fail to redraw after changing the text
	colour.

	* src/deepinvte.c: (deepinvte_terminal_set_color_internal):
		Remember to invalidate all!

2007-02-07  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_match_check_internal):
		Scan for newlines before and after the current row
		to find the entire line in case of soft-wrapping.

2007-02-07  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 345344 – Pattern matching is inefficient
	Bug 324246 – Performance degredation with large numbers of highlighted addresses/URLs

	* src/deepinvte.c: (deepinvte_terminal_match_check_internal):
		Trim the searched string down to the row containing the
		pointer. During a mutt session this drops the time consumed by
		regexec from ~30% to ~2%.
		Note: multi-line regexes are now unsupported!

2007-02-07  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvteseq.c: (_deepinvte_sequence_get_handler):
		Avoid the strlen when possible.

2007-02-07  Chris Wilson  <chris@chris-wilson.co.uk>

	Some cleanups and a bug...

	deepinvte_terminal_match_hilite() compared the current cell to the last
	mouse position without a floor().

	* src/deepinvte.c: (deepinvte_terminal_process_incoming),
	(deepinvte_terminal_match_hilite), (deepinvte_terminal_select_all),
	(deepinvte_terminal_select_none), (deepinvte_terminal_motion_notify),
	(deepinvte_terminal_button_press):

2007-02-06  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 86119 – "select all" feature
	Original patch by Simone Gotti.

	* src/deepinvte.c: (deepinvte_terminal_select_all), (deepinvte_terminal_select_none):
	* src/deepinvte.h:
		Add 2 new API entry points to select the entire contents
		and clear the current selection.

2007-02-06  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 342059 – ASCII escape sequences don't work as expected
	Correction by Mariano Suárez-Alvarez.

	* src/deepinvteseq.c: (deepinvte_sequence_handler_cursor_character_absolute):
		OBO on the parameter.

2007-02-06  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 342059 – ASCII escape sequences don't work as expected
	Patch by Mariano Suárez-Alvarez.

	* src/deepinvteseq.c: (deepinvte_sequence_handler_cursor_character_absolute):
		Provide a default value.

2007-02-06  Chris Wilson  <chris@chris-wilson.co.uk>

	And finally as noted on bug 324246#c8 hide the hilite when the mouse
	leaves the terminal (show again when it enters and let motion-notify
	correct it later).

	* src/deepinvte.c: (deepinvte_terminal_enter), (deepinvte_terminal_leave),
	(deepinvte_terminal_realize), (deepinvte_terminal_class_init):

2007-02-06  Chris Wilson  <chris@chris-wilson.co.uk>

	As noted on bug 324246#c8, hide the hilite when the focus disappears.
	On focus restore the match for the last mouse coordinates and let
	motion-notify take care of the rest.

	* src/deepinvte.c: (deepinvte_terminal_match_hilite_update),
	(deepinvte_terminal_match_hilite), (deepinvte_terminal_focus_in):

2007-02-06  Chris Wilson  <chris@chris-wilson.co.uk>

	Convert the exposed rectangles to cells and remerge them.

	* src/deepinvte.c: (deepinvte_terminal_expand_region),
	(deepinvte_terminal_paint_area), (deepinvte_terminal_paint):

2007-02-06  Chris Wilson  <chris@chris-wilson.co.uk>

	As noted on Bug 401052#c13, deepinvte fails to completely clear the cell's
	previous contents.

	* src/deepinvte.c: (_deepinvte_invalidate_cells):
		Grow the invalidate region by a single pixel to accomodate
		antialiased pseudo-bold characters.

2007-02-06  Chris Wilson  <chris@chris-wilson.co.uk>

	Move status_line_changed to post-processing emission.

	* src/deepinvte-private.h:
	* src/deepinvte.c: (_deepinvte_terminal_insert_char), (deepinvte_terminal_reset),
	(deepinvte_terminal_emit_pending_signals):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_ts):

2007-02-06  Chris Wilson  <chris@chris-wilson.co.uk>

	Clamp down on needless invalidates during selection.

	As commented on in Bug 401052#c10

	* src/deepinvte.c: (_deepinvte_invalidate_region), (deepinvte_terminal_deselect_all),
	(deepinvte_terminal_match_hilite_clear), (deepinvte_terminal_start_selection),
	(deepinvte_terminal_extend_selection):

2007-02-06  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_draw_rows):
		Don't needlessly break the text run on a space if we are
		not drawing cell attributes.

2007-02-06  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/iso2022.c: (_deepinvte_iso2022_is_ambiguous_ht):
		One more G_UNLIKELY
	* src/deepinvte.c: (deepinvte_terminal_match_hilite),
	(deepinvte_terminal_motion_notify):
		Avoid expensive hiliting if the pointer is not in the window.
	* src/deepinvteregex.c: (_deepinvte_regex_exec):
		Prefer g_new(x,n) over g_malloc(sizeof(x)*n)

2007-02-05  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 404757 – URL matching doesn't work with PCRE

	* configure.in:
		mention the inconsistency in the help string and default to no.

2007-02-05  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_draw_rows):
		Don't draw cell attributes across spaces.

2007-02-05  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (_deepinvte_terminal_insert_char):
		A couple more G_LIKELYs.

2007-02-05  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 403028 – decset mode 12 = blinking cursor

	* src/deepinvteseq.c: (deepinvte_sequence_handler_decset_internal):
		Following convention, disallow the application's control
		over the blinking cursor in favour of the user's setting.

2007-02-05  Chris Wilson  <chris@chris-wilson.co.uk>

	Some more small callgrind tweaks - well into the law of diminishing
	returns.

	* src/iso2022.c: (_deepinvte_iso2022_is_ambiguous_ht),
	(_deepinvte_iso2022_is_ambiguous), (process_8_bit_sequence),
	(process_cdata), (_deepinvte_iso2022_unichar_width):
	* src/matcher.c: (_deepinvte_matcher_free_params_array):
	* src/deepinvte.c: (deepinvte_terminal_process_incoming):

2007-02-05  Chris Wilson  <chris@chris-wilson.co.uk>

	Beware the trivial change. Handle reuse of GValueArray correctly.

	* src/matcher.c: (_deepinvte_matcher_match):
	* src/table.c: (_deepinvte_table_match):
	* src/trie.c: (_deepinvte_trie_match):
	* src/deepinvte.c: (deepinvte_terminal_process_incoming):

2007-02-05  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/table.c: (_deepinvte_table_match):
		And kill the leak as deepinvte_table_match erroneously cleared
		its output arguments.

2007-02-05  Chris Wilson  <chris@chris-wilson.co.uk>

	The continual reallocation of GValueArray is the last trivially
	avoidable g_realloc.

	* src/interpret.c: (main):
	* src/matcher.c: (_deepinvte_matcher_create), (_deepinvte_matcher_destroy),
	(_deepinvte_matcher_match), (_deepinvte_matcher_free_params_array):
	* src/matcher.h:
	* src/table.c: (_deepinvte_table_extract_string):
	* src/trie.c: (_deepinvte_trie_matchx), (_deepinvte_trie_match), (main):
	* src/deepinvte.c: (deepinvte_terminal_process_incoming):

2007-02-05  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/ring.c: (_deepinvte_ring_insert):
		Missed an important compiler warning.

2007-02-05  Chris Wilson  <chris@chris-wilson.co.uk>

	cf Bug 342338 – suffers from memory fragmentation

	Reuse the last DeepinvteRowData instead of immediately freeing it. Avoids
	recreating and *regrowing* a new GArray on the heap.

	In the simple scrolling benchmarks this can boost performance by as
	much as 10%!

	* src/ring.c: (_deepinvte_ring_insert), (_deepinvte_ring_insert_preserve),
	(_deepinvte_ring_remove), (_deepinvte_ring_append):
	* src/ring.h:
	* src/deepinvte-private.h:
	* src/deepinvte.c: (_deepinvte_reset_row_data), (_deepinvte_terminal_ensure_cursor),
	(_deepinvte_terminal_insert_char), (deepinvte_terminal_reset_rowdata):
	* src/deepinvteseq.c: (deepinvte_insert_line_internal),
	(deepinvte_sequence_handler_scroll_up_or_down),
	(deepinvte_sequence_handler_cd), (deepinvte_sequence_handler_sf),
	(deepinvte_sequence_handler_clear_screen),
	(deepinvte_sequence_handler_screen_alignment_test):

2007-02-04  Chris Wilson  <chris@chris-wilson.co.uk>

	A few more compiler warnings.

	* src/buffer.c: (_deepinvte_buffer_peek_gstring):
	* src/iso2022.c: (process_control):
	* src/deepinvteft2.c: (_deepinvte_ft2_set_text_font):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_set_title_internal):
	* src/deepinvtetc.c: (_deepinvte_termcap_parse_file):

2007-02-04  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 106618 – CJK 'fixed width' font and 's p a c e d o u t' issue

	* src/deepinvtedraw.h:
	* src/deepinvteglyph.c: (_deepinvte_glyph_cache_set_font_description):
	* src/deepinvtepango.c: (_deepinvte_pango_set_text_font):
	* src/deepinvtepangox.c: (_deepinvte_pango_x_set_text_font):
	* src/deepinvtexft.c: (_deepinvte_xft_set_text_font):
		Detect a change in font between wide-chars and recheck for a
		fixed-width estimate.

2007-02-04  Chris Wilson  <chris@chris-wilson.co.uk>

	Micro-opts.

	* src/table.c: (_deepinvte_table_match):
		No need set to NULL.
	* src/deepinvte.c: (_deepinvte_terminal_ensure_cursor):
		If we have added some rows, the last is the current.

2007-02-04  Chris Wilson  <chris@chris-wilson.co.uk>

	Move window/icon title changed to the post-processing emission - helps
	with the artificial benchmark of replaying a recorded jhbuild script.

	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_finalize),
	(deepinvte_terminal_emit_icon_title_changed),
	(deepinvte_terminal_emit_window_title_changed),
	(deepinvte_terminal_emit_pending_signals):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_set_title_internal):

2007-02-04  Chris Wilson  <chris@chris-wilson.co.uk>

	Broke clear-to-end-of-line by lowering the number of cells appended,
	instead of the number of cells invalidated.

	* src/deepinvte.c: (deepinvte_terminal_draw_rows):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_ce):

2007-02-04  Chris Wilson  <chris@chris-wilson.co.uk>

	cf Bug 83285 – Treacle-slow scrolling in gnome-terminal on unaccelerated X server

	Another chunk of performance improvements - the majority focusing on
	reducing the amount of work down per interrupt (input data from
	child).

	To handle reads without addition copies DEEPINVTE_INPUT_CHUNK_SIZE chunks
	are allocated on demand and filled from read with no further copy -
	previously the read was into a local buffer and then immediately
	copied into a _deepinvte_buffer.
	_deepinvte_iso2022_process() is then adjusted to use a ptr+length, rather
	than a _deepinvte_buffer and is called for every input chunk (taking special
	care over the boundary cases).

	* src/interpret.c: (main):
	* src/iso2022.c: (_deepinvte_iso2022_fragment_input),
	(process_8_bit_sequence), (process_cdata), (_deepinvte_iso2022_process):
	* src/iso2022.h:
	* src/deepinvte-private.h:
	* src/deepinvte.c: (get_chunk), (release_chunk), (prune_chunks),
	(_deepinvte_incoming_chunks_release), (_deepinvte_incoming_chunks_length),
	(_deepinvte_incoming_chunks_count), (_deepinvte_incoming_chunks_reverse),
	(deepinvte_terminal_match_check_internal), (_deepinvte_terminal_ensure_cursor),
	(deepinvte_terminal_set_colors), (_deepinvte_terminal_insert_char),
	(deepinvte_terminal_catch_child_exited), (deepinvte_terminal_eof),
	(deepinvte_terminal_process_incoming), (_deepinvte_terminal_feed_chunks),
	(deepinvte_terminal_io_read), (deepinvte_terminal_feed), (deepinvte_terminal_send),
	(deepinvte_terminal_init), (deepinvte_terminal_finalize), (deepinvte_terminal_reset),
	(remove_from_active_list), (need_processing), (update_regions),
	(update_repeat_timeout):
	* src/deepinvte.h:
	* src/deepinvteseq.c: (deepinvte_sequence_handler_cb),
	(deepinvte_sequence_handler_ce), (deepinvte_sequence_handler_ec):

2007-02-04  Chris Wilson  <chris@chris-wilson.co.uk>

	Store whether the codeset is ambiguous in a state variable,
	rather than recomputing the ambiguous width every processing loop.

	* src/iso2022.c: (_deepinvte_iso2022_is_ambiguous),
	(_deepinvte_iso2022_state_new), (_deepinvte_iso2022_find_nextctl):

2007-02-04  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvtexft.c: (_deepinvte_xft_create), (_deepinvte_xft_destroy):
		Remove zero-initialisers after g_slice_new0().
	* src/deepinvtexft.c :(_deepinvte_xft_set_text_font):
		Print out the width range.

2007-02-04  Chris Wilson  <chris@chris-wilson.co.uk>

	* configure.in:
		Missing space between -Wflags.

2007-02-04  Chris Wilson  <chris@chris-wilson.co.uk>

	Eliminate the temporary g_sliced parameter list,
	in favour of an on-stack list.

	* src/table.c: (_deepinvte_table_arginfo_head_init),
	(_deepinvte_table_arginfo_alloc), (_deepinvte_table_arginfo_head_revert),
	(_deepinvte_table_arginfo_head_reverse),
	(_deepinvte_table_arginfo_head_finalize), (_deepinvte_table_addi),
	(_deepinvte_table_matchi), (_deepinvte_table_extract_string),
	(_deepinvte_table_match):

2007-02-02  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvtefc.c: (_deepinvte_fc_patterns_from_pango_font_desc):
		Dump the chosen fonts to DEEPINVTE_DEBUG_MISC.
	* src/deepinvteft2.c: (_deepinvte_ft2_set_text_font):
		Print out the font metrics ala deepinvtexft.c

2007-02-02  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 322241 – Please switch to pkg-config to check for freetype

	* configure.in:
		Prefer to use the freetype2.pc if available.

2007-02-02  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 322240 – Usage of pkg-config privates header

	* deepinvte.pc.in:
		Move @FT2_LIBS@ to Libs.private.

2007-02-01  Chris Wilson  <chris@chris-wilson.co.uk>

	cf Bug 403275 – crash in Terminal: I was typing reset on th...

	Not the crash, just a freeze found whilst trying to reproduce the
	bug on trunk.

	* src/deepinvte.c: (remove_from_active_list):
		Don't remove the terminal from the active list if it still
		has pending redraws.
	
	* src/deepinvte.c: (process_timeout), (update_timeout):
		Reorder the loop to remove the terminal from the active list
		if it no longer needs processing.

2007-02-01  Chris Wilson  <chris@chris-wilson.co.uk>

	* perf/scroll.vim:
		Extract the bits the test needs out of debian.vim.

2007-02-01  Chris Wilson  <chris@chris-wilson.co.uk>

	As spotted on bug 399617c8, we convert an array of unichars to a
	string and then iterate over the string interpreting bytes as
	unichars.

	* src/table.c: (_deepinvte_table_extract_numbers):
		Dispense with the temporary string and process the unichar
		array directly.

2007-02-01  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 403159 – XftDrawSetClipRectangles() silently fails on ppc->i386

	* src/deepinvtexft.c: (_deepinvte_xft_clip):
		Precompute clip offsets.

2007-02-01  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 382245 – __PyGtk_API multiply defined in python module

	* configure.in:
		Add -fno-common to MAYBE_WARN in order to catch future
		errors of this type.
	* python/deepinvte.override:
		Define PYGTK_NO_IMPORT.

2007-01-31  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 155687 – Scroll region \E[NN;MMr should set cursor to home

	Patch originally by Michele Baldessari.

	* src/deepinvteseq.c: (deepinvte_sequence_handler_cs):
		Move the cursor to (0,0) rather than clamping the cursor to 
		be inside the scroll region.

2007-01-31  Chris Wilson  <chris@chris-wilson.co.uk>

	In a few places the contents of a GValue were being used without
	checking that they were of the expected type.

	cf Bug 117945 which mentions stack corruption inside
	deepinvte_sequence_handler_delete_lines() - one of the corrected instances.

	* src/deepinvteseq.c: (deepinvte_sequence_handler_al),
	(deepinvte_sequence_handler_cs), (deepinvte_sequence_handler_cS),
	(deepinvte_sequence_handler_dl),
	(deepinvte_sequence_handler_character_attributes),
	(deepinvte_sequence_handler_insert_lines),
	(deepinvte_sequence_handler_delete_lines),
	(deepinvte_sequence_handler_device_status_report),
	(deepinvte_sequence_handler_dec_device_status_report):
		Check that the GValue holds a long before dereference.

2007-01-31  Chris Wilson <chris@chris-wilson.co.uk>

	Back to the old-style io loop as _deepinvte_buffer_append() is too slow - on
	a slow system the read can fill before the data is copied (even more
	apparent under valgrind).

	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_io_read):

2007-01-31  Chris Wilson  <chris@chris-wilson.co.uk>

	Use the display stashed inside the font and not the default display!

	* src/deepinvtexft.c: (_deepinvte_xft_char_exists), (_deepinvte_xft_text_extents),
	(_deepinvte_xft_font_open), (_deepinvte_xft_font_close),
	(_deepinvte_xft_font_for_char), (_deepinvte_xft_draw_text):

2007-01-31  Chris Wilson  <chris@chris-wilson.co.uk>

	A mixed bag of cleanups.

	* configure.in:
	* src/pty.c: (_deepinvte_pty_set_utf8):
		Test for existence of tc[sg]etattr.
	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_emit_adjustment_changed),
	(deepinvte_terminal_queue_adjustment_changed),
	(deepinvte_terminal_set_color_internal), (deepinvte_terminal_handle_sequence),
	(_deepinvte_terminal_enable_input_source), (deepinvte_terminal_io_read),
	(deepinvte_terminal_init), (deepinvte_terminal_unrealize),
	(deepinvte_terminal_finalize), (deepinvte_terminal_background_update),
	(deepinvte_terminal_queue_background_update),
	(deepinvte_terminal_emit_pending_signals), (process_timeout),
	(update_repeat_timeout), (update_timeout):
		Move idle signal emission to display handlers.
	* src/deepinvtedraw.h:
		Add '&' to the single width characters.
	* src/deepinvteseq.c: (_deepinvte_sequence_get_handler):
	* src/deepinvteseq.h:
		Drop the extraneous GQuark parameter.
	* src/deepinvtexft.c: (_deepinvte_xft_set_text_font):
		Avoid use of strlen for a compile-time fixed length string.

2007-01-31  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 147784 – cursor unvisible under mouse highlight

	Original patch by Chris Health

	* src/deepinvte.c: (deepinvte_terminal_paint):
		Reverse cursor color if it is in the selected region and draw
		it as an outline.

2007-01-31  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 368894 – crash in Terminal: I started gnome-terminal...

	* src/deepinvtebg.c: (deepinvte_bg_cache_search), (deepinvte_bg_get_pixmap),
	(deepinvte_bg_get_pixbuf):
		When retrieving a cached pixmap check that the visual
		matches the current request.

2007-01-31  Chris Wilson  <chris@chris-wilson.co.uk>

	Use gdk_error_trap_{push,pop} around raw Xft calls - about a
	path outside of deepinvte_draw_{begin,end}.

	* src/deepinvtexft.c: (_deepinvte_xft_set_text_font):

2007-01-31  Chris Wilson  <chris@chris-wilson.co.uk>

	Use gdk_error_trap_{push,pop} around raw X11 and Xft calls.
	cf Bug 368894.

	* src/deepinvtexft.c: (_deepinvte_xft_font_for_char), (_deepinvte_xft_start),
	(_deepinvte_xft_end):

2007-01-31  Chris Wilson  <chris@chris-wilson.co.uk>

	Use gperf to calculate a more optimal deepinvte_sequence_get_handler().
	This reduces deepinvte_sequence_get_handler() from ~13% of the runtime
	during 'seq 1 1e6' to ~.5% (cumulative).

	* src/Makefile.am:
	* src/deepinvteseq-2.c: (deepinvteseq_2_hash), (deepinvteseq_2_lookup):
	* src/deepinvteseq-2.gperf:
	* src/deepinvteseq-n.c: (deepinvteseq_n_hash), (deepinvteseq_n_lookup):
	* src/deepinvteseq-n.gperf:
	* src/deepinvteseq.c: (_deepinvte_sequence_get_handler):

2007-01-31  Chris Wilson  <chris@chris-wilson.co.uk>

	Rudimentary vim scrolling benchmark.

	* perf/Makefile.am:
	* perf/UTF-8-demo.txt:
	* perf/scroll.vim:
	* perf/vim.sh:

2007-01-30  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 402329 – Rendering problem with underlines and cursor

	* src/deepinvte.c: (deepinvte_terminal_paint):
		Check hilite state when redrawing character under cursor.

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_io_read):
		Clean up the read IO loop.

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	NULL return from pcre_study() does not necessarily mean an error
	occurred.

	* src/deepinvteregex.c: (_deepinvte_regex_compile), (_deepinvte_regex_exec):

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (_deepinvte_terminal_set_pointer_visible),
	(_deepinvte_terminal_fudge_pango_colors):
		Kill a couple more compiler warnings.

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 336105 – gnome-terminal crashes when termcap not found

	* src/matcher.c: (_deepinvte_matcher_init):
	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_set_default_tabstops),
	(deepinvte_terminal_key_press), (deepinvte_terminal_set_emulation),
	(_deepinvte_terminal_inline_error_message), (deepinvte_terminal_set_termcap),
	(deepinvte_terminal_init), (deepinvte_terminal_finalize),
	(deepinvte_terminal_draw_cells):
		Detect and issue an inline warning when we fail
		to load a termcap.

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	Tighten the invalidated cells.

	* src/deepinvte.c: (_deepinvte_terminal_select_text):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_cb):

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	More compiler warnings.

	* src/deepinvtepangox.c: (_deepinvte_pango_x_set_text_font),
	(_deepinvte_pango_x_draw_text):
	* src/deepinvteregex.c: (_deepinvte_regex_exec):

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	Detect availability of PCRE.

	* configure.in:
	* src/Makefile.am:

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	Improve handling of multi-row clears.

	* src/deepinvte.c: (deepinvte_terminal_draw_cells), (deepinvte_terminal_draw_rows),
	(deepinvte_terminal_paint):

2007-01-29  Chris Wilson <chris@chris-wilson.co.uk>

	Add debugging flags for printing out cells contents and attributes as
	they are rendered.

	* src/debug.c: (_deepinvte_debug_parse_string):
	* src/debug.h:
	* src/deepinvte.c: (deepinvte_terminal_draw_cells):

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_draw_rows):
		Don't issue glyph items for blank cells.

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	* configure.in:
		Add -Wshadow to MAYBE_WARN
	* src/ring.c: (_deepinvte_ring_remove):
	* src/table.c: (_deepinvte_table_matchi):
	* src/deepinvtedraw.c: (_deepinvte_draw_clip):
	* src/deepinvteskel.c:
		Clean up some compiler warnings.

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvteskel.c:
		Add the NULL clip func to the skeleton function table.

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	Update match hilite before showing the pointer as the choice of
	cursor depends on whether the pointer is above a matched region.

	* src/deepinvte.c: (deepinvte_terminal_motion_notify),
	(deepinvte_terminal_button_press), (deepinvte_terminal_button_release):

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	Only update the matched region if we move the pointer outside of the
	currently matched region.
	And only invalidate the cells underneath the matched region.

	* src/deepinvte.c: (_deepinvte_invalidate_region),
	(deepinvte_terminal_match_hilite_clear), (cursor_inside_match),
	(deepinvte_terminal_match_hilite), (deepinvte_terminal_draw_rows):

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/table.c: (_deepinvte_table_free):
		Fix a memleak.

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	==26147== 2,895 (352 direct, 2,543 indirect) bytes in 22 blocks are definitely lost in loss record 107 of 170
	==26147==    at 0x4021380: malloc (vg_replace_malloc.c:149)
	==26147==    by 0x4E85965: g_malloc (gmem.c:131)
	==26147==    by 0x4E95537: g_slice_alloc (gslice.c:777)
	==26147==    by 0x4E7C255: g_list_prepend (glist.c:95)
	==26147==    by 0x428B887: deepinvte_terminal_feed (deepinvte.c:10991)
	==26147==    by 0x429DD20: deepinvte_terminal_io_read (deepinvte.c:3214)
	==26147==    by 0x4EA7A8C: g_io_unix_dispatch (giounix.c:162)
	==26147==    by 0x4E7E481: g_main_context_dispatch (gmain.c:2045)
	==26147==    by 0x4E8145E: g_main_context_iterate (gmain.c:2677)
	==26147==    by 0x4E81808: g_main_loop_run (gmain.c:2881)
	==26147==    by 0x45BA503: gtk_main (gtkmain.c:1148)
	==26147==    by 0x805F7A3: main (terminal.c:1773)

	* src/deepinvte.c: (remove_from_active_list), (process_timeout),
	(update_repeat_timeout):
		g_list_delete_link() is the one that actually frees the link.
		s/g_list_remove_link/g_list_delete_link/.

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	==26147== Conditional jump or move depends on uninitialised value(s)
	==26147==    at 0x42AB9F7: _deepinvte_rdb_search (deepinvterdb.c:95)
	==26147==    by 0x42ABB40: _deepinvte_rdb_quark (deepinvterdb.c:201)
	==26147==    by 0x42ABB9F: _deepinvte_rdb_get_hintstyle (deepinvterdb.c:241)
	==26147==    by 0x42A7952: _deepinvte_fc_patterns_from_pango_font_desc (deepinvtefc.c:302)
	==26147==    by 0x42B4E9B: _deepinvte_xft_set_text_font (deepinvtexft.c:103)
	==26147==    by 0x42A6BE5: _deepinvte_draw_set_text_font (deepinvtedraw.c:258)
	==26147==    by 0x428C62B: deepinvte_terminal_ensure_font (deepinvte.c:5963)
	==26147==    by 0x4290295: deepinvte_terminal_size_request (deepinvte.c:6613)
	==26147==    by 0x4E25228: g_cclosure_marshal_VOID__BOXED (gmarshal.c:566)
	==26147==    by 0x4E17038: g_type_class_meta_marshal (gclosure.c:567)
	==26147==    by 0x4E188FC: g_closure_invoke (gclosure.c:490)
	==26147==    by 0x4E29779: signal_emit_unlocked_R (gsignal.c:2370)
	==26147== 

	* src/deepinvterdb.c: (_deepinvte_rdb_get):
		Check the result of the get_property_string before using the
		returned values.

2007-01-29  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_draw_cells), (deepinvte_terminal_draw_rows):
		Merge draw_cells() with the background clear, as generating
		items for many rows and then splitting again in draw cells is
		simply inefficient.

2007-01-28  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 401215 – Multi-pass renderering

	* src/deepinvte.c: (deepinvte_terminal_draw_cells), (deepinvte_terminal_clear_cells),
	(deepinvte_terminal_draw_cells_with_attributes),
	(deepinvte_terminal_draw_rows), (deepinvte_terminal_paint):
		Break the draw_rows() loop into two passes - first clear the
		background and second render the text.
		Add another function based on draw_cells() that just clears the
		background and make clearing the background optional in
		draw_cells() - updating callers accordingly.
		Adventurous souls are required to clean up draw_rows().

2007-01-27  Chris Wilson  <chris@chris-wilson.co.uk>

	Fix compilation *with* debugging enabled.
	Grrr.

	* src/keymap.c: (_deepinvte_keysym_print):

2007-01-27  Chris Wilson  <chris@chris-wilson.co.uk>

	Fix compilation without debugging enabled.

	* src/keymap.c: (_deepinvte_keysym_print), (_deepinvte_keymap_map):
	* src/deepinvte.c: (display_control_sequence):
	* src/deepinvteapp.c: (main):

2007-01-26  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/debug.h:
		Provide a safe fallback for non-C99 compilers (well actually
		anything that isn't a recent gcc at the moment).

2007-01-26  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 157267 – _deepinvte_terminal_fudge_pango_colors() breaks Japanese input style

	Patch by ynakai@redhat.com.

	* src/deepinvte.c: (_deepinvte_terminal_fudge_pango_colors):
		Check the attributes for each cell rather than assuming the
		pango attributes (and cell attributes) are the same for the
		whole string.

2007-01-26  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvteseq.c: (deepinvte_sequence_handler_vb):
		Iterating over all queued exposures and drawing on top of the
		flash does not sense. Simply flush the draw.

2007-01-26  Chris Wilson  <chris@chris-wilson.co.uk>

	s/_DEEPINVTE_DEBUG_ON/_DEEPINVTE_DEBUG_IF/ and don't include
	the code block inside the macro.

	* src/debug.h:
	* src/iso2022.c: (process_control), (_deepinvte_iso2022_process):
	* src/keymap.c: (_deepinvte_keymap_map):
	* src/matcher.c: (_deepinvte_matcher_init):
	* src/pty.c: (_deepinvte_pty_run_on_pty):
	* src/table.c: (_deepinvte_table_addi), (_deepinvte_table_matchi),
	(_deepinvte_table_extract_numbers), (_deepinvte_table_match):
	* src/trie.c: (_deepinvte_trie_addx):
	* src/deepinvte.c: (deepinvte_terminal_match_check_internal),
	(deepinvte_terminal_match_check), (deepinvte_terminal_handle_sequence),
	(deepinvte_terminal_catch_child_exited), (deepinvte_terminal_process_incoming),
	(deepinvte_terminal_io_write), (deepinvte_terminal_send),
	(deepinvte_terminal_key_press), (deepinvte_terminal_copy_cb),
	(deepinvte_terminal_set_font_full), (deepinvte_terminal_realize),
	(deepinvte_terminal_paint), (deepinvte_terminal_scroll):
	* src/deepinvteapp.c: (main):
	* src/deepinvtebg.c: (deepinvte_bg_root_pixmap):

2007-01-26  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 400834 – Use a global display/process timeout

	Currently each terminal uses it own display timeout. Given that
	typical usage is several active terminals, there is an immediate
	advantage (context switches, fairness, smoothness) to using a single
	common timeout.

	* src/debug.c: (_deepinvte_debug_parse_string):
	* src/debug.h:
		Add DEEPINVTE_DEBUG_TIMEOUT
	* src/deepinvte-private.h:
	* src/deepinvte.c: (update_regions), (_deepinvte_invalidate_cells),
	(_deepinvte_invalidate_all), (deepinvte_terminal_init),
	(deepinvte_terminal_class_init), (add_update_timeout),
	(remove_from_active_list), (remove_update_timeout),
	(add_process_timeout), (deepinvte_terminal_stop_processing),
	(deepinvte_terminal_is_processing), (process_timeout),
	(update_repeat_timeout), (update_timeout):
		Modify to use a global timeout rather than individual
		private timeouts.

2007-01-26  Chris Wilson  <chris@chris-wilson.co.uk>

	Unable to set background scrolling mode from cmdline due to variable
	name confusion.

	* src/deepinvteapp.c: (main):
		--scroll should set scroll=TRUE rather than cursor=TRUE!

2007-01-26  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 401082 – double-draw issue

	The main cause of this bug was not expanding the cleared area to cover
	all the cells affected by the draw and forgetting to offset the clear
	by DEEPINVTE_PAD_WIDTH.

	To counter the performance hit due to the expanded repaint area, each
	backend is presented with the opportunity to apply a clip to the
	exposed region before painting.

	This also fixes bug 333157,

	* src/deepinvte.c: (_deepinvte_invalidate_cells), (deepinvte_terminal_paint_area),
	(deepinvte_terminal_paint):
	* src/deepinvtedraw.c: (_deepinvte_draw_clip):
	* src/deepinvtedraw.h:
	* src/deepinvteft2.c: (_deepinvte_ft2_end), (_deepinvte_ft2_clip):
	* src/deepinvtegl.c:
	* src/deepinvtepango.c: (_deepinvte_pango_clip):
	* src/deepinvtepangox.c: (_deepinvte_pango_x_clip):
	* src/deepinvtexft.c: (_deepinvte_xft_clip), (_deepinvte_xft_draw_text):

2007-01-26  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_match_hilite):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_ce),
	(deepinvte_sequence_handler_dc), (deepinvte_sequence_handler_ec):
		Tighten the _deepinvte_invalidate_cells() to only those that
		we potentially modify.

2007-01-26  Chris Wilson  <chris@chris-wilson.co.uk>

	* src/deepinvtexft.c: (_deepinvte_xft_set_text_font):
		Remove the additional pixel inter-character spacing.
		Compactness over clarity ;)

2007-01-26  Chris Wilson  <chris@chris-wilson.co.uk>

	Apply a one pixel fudge to the Xft character position and width.
	This greatly improves text appearance and hides the misrendering of
	pseudo-bold characters.
	cf bugs 317691, 333157.

	* src/deepinvte.c: (deepinvte_terminal_paint):
		Increase the cursor size to fit around the cell.
	* src/deepinvtexft.c: (_deepinvte_xft_set_text_font), (_deepinvte_xft_draw_text):
		Fudge the Xft font positioning.

2007-01-26  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 318307 – Cursor colour changes to foreground when unfocused

	Whilst setting the colour, tweak the position of the rectangle, and
	extended the invalidate region to account for the OBO nature of bold
	font.

	* src/deepinvte.c: (_deepinvte_invalidate_cells):
		Include the padding to accomodate cell effects.
	* src/deepinvte.c: (deepinvte_terminal_paint):
		Use the cursor color for the rectangle when unfocused.

2007-01-26  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_visibility_notify): Correctly handle
	visibility events: set invalidated_all to FALSE, and invalidate_all
	if fully unobscured.

2007-01-26  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_visibility_notify): Make sure we redraw
	after becoming unobscured.  There still is a bug that I've not found,
	but after obscuring the widget and coming back, a first redraw
	happens, but no update after that.

2007-01-26  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_draw_area):
		Occasionally we generate an exposed area which is computed
		as 0x0 cells. Discard early, before we spend an infinity
		drawing nothing.

2007-01-26  Chris Wilson <chris@chris-wilson.co.uk>

	Janitorial work - near elimination of #ifdef DEEPINVTE_DEBUG from within
	functions, trimming a thousand lines of code.

	We introduce a _deepinvte_debug_print macro to cover the more common
	occurrence of printing a message at a certain debug level.
	And a _DEEPINVTE_DEBUG_ON for a conditional code block.

	src/debug.h     |   11 
	src/iso2022.c   |  201 ++-------
	src/keymap.c    |   41 -
	src/matcher.c   |   24 -
	src/pty.c       |  134 +-----
	src/reaper.c    |   21 
	src/ring.c      |   78 +--
	src/table.c     |   11 
	src/trie.c      |   19 
	src/deepinvte.c       | 1187 ++++++++++---------------------------------------
	src/deepinvteaccess.c |  198 +++------
	src/deepinvteapp.c    |   21 
	src/deepinvtebg.c     |   43 --
	src/deepinvteconv.c   |   60 +-
	src/deepinvteconv.h   |   12 
	src/deepinvtedraw.c   |    6 
	src/deepinvtefc.c     |    4 
	src/deepinvteft2.c    |    5 
	src/deepinvteglyph.c  |   27 -
	src/deepinvtepango.c  |   11 
	src/deepinvtepangox.c |    7 
	src/deepinvteregex.c  |    2 
	src/deepinvteseq.c    |  385 +++++-------------
	src/deepinvtexft.c    |   26 -
	24 files changed, 789 insertions(+), 1745 deletions(-)

	* src/debug.h:
	* src/iso2022.c: (_deepinvte_iso2022_ambiguous_width_guess),
	(_deepinvte_iso2022_state_new), (_deepinvte_iso2022_state_set_codeset),
	(process_8_bit_sequence), (process_cdata), (process_control),
	(_deepinvte_iso2022_process):
	* src/keymap.c: (_deepinvte_keymap_map):
	* src/matcher.c: (_deepinvte_matcher_init), (_deepinvte_matcher_create),
	(_deepinvte_matcher_destroy):
	* src/pty.c: (deepinvte_pty_child_setup), (_deepinvte_pty_run_on_pty),
	(_deepinvte_pty_set_size), (_deepinvte_pty_get_size), (_deepinvte_pty_ptsname),
	(_deepinvte_pty_open_unix98), (_deepinvte_pty_open_with_helper),
	(_deepinvte_pty_open):
	* src/reaper.c: (deepinvte_reaper_emit_signal),
	(deepinvte_reaper_child_watch_cb), (deepinvte_reaper_init),
	(deepinvte_reaper_finalize):
	* src/ring.c: (_deepinvte_ring_insert), (_deepinvte_ring_insert_preserve),
	(_deepinvte_ring_remove):
	* src/table.c: (_deepinvte_table_addi):
	* src/trie.c: (char_class_string_extract), (_deepinvte_trie_addx),
	(_deepinvte_trie_add):
	* src/deepinvte.c: (update_regions), (_deepinvte_invalidate_cells),
	(_deepinvte_invalidate_all), (_deepinvte_invalidate_cell),
	(_deepinvte_invalidate_cursor_once),
	(deepinvte_terminal_emit_selection_changed), (deepinvte_terminal_emit_commit),
	(deepinvte_terminal_emit_emulation_changed),
	(deepinvte_terminal_emit_encoding_changed),
	(deepinvte_terminal_emit_child_exited),
	(_deepinvte_terminal_emit_contents_changed),
	(deepinvte_terminal_emit_cursor_moved), (deepinvte_terminal_emit_eof),
	(deepinvte_terminal_emit_char_size_changed),
	(_deepinvte_terminal_emit_status_line_changed),
	(deepinvte_terminal_emit_increase_font_size),
	(deepinvte_terminal_emit_decrease_font_size),
	(_deepinvte_terminal_emit_text_inserted),
	(_deepinvte_terminal_emit_text_deleted),
	(deepinvte_terminal_emit_text_modified),
	(deepinvte_terminal_emit_text_scrolled), (deepinvte_terminal_deselect_all),
	(deepinvte_terminal_match_check_internal), (deepinvte_terminal_match_check),
	(deepinvte_terminal_emit_adjustment_changed),
	(deepinvte_terminal_queue_adjustment_changed),
	(_deepinvte_terminal_adjust_adjustments), (deepinvte_terminal_scroll_pages),
	(deepinvte_terminal_maybe_scroll_to_bottom), (deepinvte_terminal_set_encoding),
	(_deepinvte_terminal_set_pointer_visible), (deepinvte_terminal_new),
	(deepinvte_terminal_generate_bold), (_deepinvte_terminal_insert_char),
	(deepinvte_terminal_handle_sequence), (deepinvte_terminal_catch_child_exited),
	(deepinvte_terminal_fork_command),
	(deepinvte_terminal_emit_pending_text_signals),
	(deepinvte_terminal_process_incoming), (deepinvte_terminal_io_read),
	(deepinvte_terminal_io_write), (deepinvte_terminal_send),
	(deepinvte_terminal_im_commit), (deepinvte_terminal_im_preedit_start),
	(deepinvte_terminal_im_preedit_end), (deepinvte_terminal_im_preedit_changed),
	(deepinvte_terminal_configure_toplevel),
	(deepinvte_terminal_hierarchy_changed), (deepinvte_terminal_style_changed),
	(deepinvte_terminal_key_press), (deepinvte_terminal_paste_cb),
	(deepinvte_terminal_match_hilite_clear), (deepinvte_terminal_match_hilite),
	(deepinvte_terminal_clear_cb), (deepinvte_terminal_copy_cb),
	(deepinvte_terminal_copy), (deepinvte_terminal_paste),
	(deepinvte_terminal_start_selection), (deepinvte_terminal_extend_selection),
	(deepinvte_terminal_autoscroll), (deepinvte_terminal_motion_notify),
	(deepinvte_terminal_button_press), (deepinvte_terminal_button_release),
	(deepinvte_terminal_focus_in), (deepinvte_terminal_focus_out),
	(deepinvte_terminal_set_font_full), (deepinvte_terminal_set_size),
	(deepinvte_terminal_handle_scroll), (deepinvte_terminal_set_emulation),
	(deepinvte_terminal_set_termcap), (deepinvte_terminal_reset_rowdata),
	(deepinvte_terminal_fc_settings_changed), (deepinvte_terminal_init),
	(deepinvte_terminal_size_request), (deepinvte_terminal_size_allocate),
	(deepinvte_terminal_unrealize), (deepinvte_terminal_finalize),
	(deepinvte_terminal_realize), (deepinvte_terminal_draw_cells),
	(_deepinvte_terminal_map_pango_color), (deepinvte_terminal_draw_area),
	(deepinvte_terminal_paint), (deepinvte_terminal_expose), (deepinvte_terminal_scroll),
	(deepinvte_terminal_class_init), (deepinvte_terminal_copy_clipboard),
	(deepinvte_terminal_paste_clipboard), (deepinvte_terminal_copy_primary),
	(deepinvte_terminal_paste_primary), (deepinvte_terminal_background_update),
	(deepinvte_terminal_queue_background_update),
	(deepinvte_terminal_set_background_saturation),
	(deepinvte_terminal_set_background_tint_color),
	(deepinvte_terminal_set_background_transparent),
	(deepinvte_terminal_set_background_image),
	(deepinvte_terminal_set_background_image_file),
	(deepinvte_terminal_set_word_chars), (process_timeout),
	(update_repeat_timeout), (update_timeout):
	* src/deepinvteaccess.c: (xy_from_offset), (emit_text_caret_moved),
	(emit_text_changed_insert), (emit_text_changed_delete),
	(deepinvte_terminal_accessible_update_private_data_if_needed),
	(deepinvte_terminal_accessible_text_modified),
	(deepinvte_terminal_accessible_text_scrolled),
	(deepinvte_terminal_accessible_invalidate_cursor),
	(deepinvte_terminal_accessible_finalize),
	(deepinvte_terminal_accessible_get_text),
	(deepinvte_terminal_accessible_get_text_somewhere),
	(deepinvte_terminal_accessible_get_run_attributes),
	(deepinvte_terminal_accessible_text_init),
	(deepinvte_terminal_accessible_component_init),
	(deepinvte_terminal_accessible_action_init),
	(deepinvte_terminal_accessible_factory_new):
	* src/deepinvteapp.c: (destroy_and_quit_eof), (destroy_and_quit_exited),
	(take_xconsole_ownership), (main):
	* src/deepinvtebg.c: (deepinvte_bg_root_pixmap), (deepinvte_bg_set_root_pixmap),
	(_deepinvte_bg_resize_pixbuf):
	* src/deepinvteconv.c: (_deepinvte_conv_utf8_utf8), (_deepinvte_conv_open),
	(_deepinvte_conv), (_deepinvte_conv_cu), (_deepinvte_conv_uu), (_deepinvte_conv_uc):
	* src/deepinvteconv.h:
	* src/deepinvtedraw.c: (_deepinvte_draw_new):
	* src/deepinvtefc.c: (_deepinvte_fc_transcribe_from_pango_font_description):
	* src/deepinvteft2.c: (_deepinvte_ft2_draw_text):
	* src/deepinvteglyph.c: (_deepinvte_glyph_cache_free),
	(_deepinvte_glyph_cache_set_font_description):
	* src/deepinvtepango.c: (_deepinvte_pango_set_text_font),
	(_deepinvte_pango_draw_text):
	* src/deepinvtepangox.c: (_deepinvte_pango_x_set_text_font):
	* src/deepinvteregex.c: (_deepinvte_regex_exec):
	* src/deepinvteseq.c: (deepinvte_terminal_emit_deiconify_window),
	(deepinvte_terminal_emit_iconify_window),
	(deepinvte_terminal_emit_icon_title_changed),
	(deepinvte_terminal_emit_window_title_changed),
	(deepinvte_terminal_emit_raise_window), (deepinvte_terminal_emit_lower_window),
	(deepinvte_terminal_emit_maximize_window),
	(deepinvte_terminal_emit_refresh_window),
	(deepinvte_terminal_emit_restore_window),
	(deepinvte_terminal_emit_move_window), (deepinvte_terminal_emit_resize_window),
	(deepinvte_sequence_handler_set_title_internal),
	(deepinvte_sequence_handler_decset_internal), (deepinvte_sequence_handler_bt),
	(deepinvte_sequence_handler_application_keypad),
	(deepinvte_sequence_handler_normal_keypad),
	(deepinvte_sequence_handler_reset_mode), (deepinvte_sequence_handler_decset),
	(deepinvte_sequence_handler_decreset),
	(deepinvte_sequence_handler_erase_in_display),
	(deepinvte_sequence_handler_erase_in_line),
	(deepinvte_sequence_handler_restore_mode),
	(deepinvte_sequence_handler_save_mode),
	(deepinvte_sequence_handler_window_manipulation):
	* src/deepinvtexft.c: (_deepinvte_xft_set_text_font):

2007-01-26  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 317449 – The cursor disappears when clicking on windows above gnome-terminal

	Enter a command that causes partial obscuration of the terminal,
	though it must cover the cursor. Close the new window, observe the
	pointer disappears.

	The issue is that we hide the pointer whilst typing and show it after
	receiving a mouse movement. However in this case we steal the pointer
	away from the terminal without any mouse events and the cursor remains
	invisible.

	* src/deepinvte.c: (deepinvte_terminal_focus_in):
		Ensure the mouse pointer is visible on focus-in.

2007-01-26  Chris Wilson <chris@chris-wilson.co.uk>

	Spend half an hour a day killing warnings...

	* configure.in:
		Remove -Wswitch-enum from MAYBE_WARN. I am that lazy.
	* src/buffer.c:
	* src/iso2022.c: (_deepinvte_iso2022_is_ambiguous),
	(_deepinvte_iso2022_ambiguous_width), (_deepinvte_iso2022_map_get),
	(_deepinvte_iso2022_find_nextctl), (_deepinvte_iso2022_sequence_length),
	(_deepinvte_iso2022_fragment_input), (process_8_bit_sequence),
	(process_cdata), (_deepinvte_iso2022_process_single), (process_control),
	(_deepinvte_iso2022_process):
	* src/keymap.c: (_deepinvte_keymap_map):
	* src/table.c:
	* src/trie.c: (char_class_none_extract),
	(char_class_digit_extract), (char_class_multi_extract),
	(char_class_any_extract), (unichar_snlen), (unichar_sncmp),
	(char_class_string_extract), (_deepinvte_trie_addx), (_deepinvte_trie_add),
	(_deepinvte_trie_matchx), (_deepinvte_trie_match), (_deepinvte_trie_printx),
	(_deepinvte_trie_print), (convert_mbstowcs), (main):
	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_find_charcell),
	(_deepinvte_row_data_find_charcell), (deepinvte_terminal_emit_commit),
	(deepinvte_terminal_match_clear_all), (deepinvte_terminal_match_remove),
	(deepinvte_terminal_match_add), (deepinvte_terminal_match_set_cursor),
	(deepinvte_terminal_match_check_internal), (deepinvte_terminal_set_colors),
	(deepinvte_terminal_emit_pending_text_signals),
	(deepinvte_terminal_is_word_char), (deepinvte_terminal_finalize),
	(deepinvte_terminal_realize), (_deepinvte_terminal_map_pango_color),
	(_deepinvte_terminal_apply_pango_attr),
	(_deepinvte_terminal_translate_pango_cells),
	(deepinvte_terminal_set_scrollback_lines):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_decset_internal):
		Fixup compiler warnings, mostly of the type mixing signed and
		unsigned compares and pointers.

2007-01-25  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (mark_input_source_invalid),
	(_deepinvte_terminal_connect_pty_read), (mark_output_source_invalid),
	(_deepinvte_terminal_connect_pty_write):
		Use the GDestroyNotify to mark the source as invalid.
	* src/deepinvte.c: (deepinvte_terminal_ensure_font):
		Protect ensure fonts against the DeepinvteDraw being destroyed.
	* src/deepinvte.c: (deepinvte_terminal_realize):
	 	Reorder code to setup the style before the fonts.
	* src/deepinvte.c: (deepinvte_terminal_class_init):
		The ->show() handler was redundant.

2007-01-25  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (_deepinvte_terminal_set_default_attributes),
	(_deepinvte_invalidate_cells), (_deepinvte_invalidate_all),
	(_deepinvte_invalidate_cell), (_deepinvte_invalidate_cursor_once),
	(deepinvte_terminal_visibility_notify), (deepinvte_terminal_handle_scroll):
	Replace most of checks for terminal->pvt->visibility_state ==
	GDK_VISIBILITY_FULLY_OBSCURED by terminal->pvt->invalidated_all, and
	adapt.

2007-01-25  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 400759 – update problem with deepinvte trunk

	Otherwise known as the I can't count bug.

	The number of rows and columns to paint were not properly taking
	account of the discrete nature of the cells ie although the floor(x)
	moved the start to the left by one, the extra cell was not being added
	to the width.

	Also since the howmany() macro is pulled from <sys/param.h>, it can
	not be guarranteed to exist on all platforms. So in that case, provide
	a local copy.

	* src/deepinvte.c: (deepinvte_terminal_draw_area):
		Calculate the width as the distance between the explicity
		calculated start and end cells.

2007-01-25  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 400671 – crash in Terminal: detaching of tabs

	The fontdirty flag needed to be set on unrealize to ensure the fonts
	get set on the DeepinvteDraw should the terminal be realized again (e.g
	drag'n'dropping).

	* src/deepinvte.c: (deepinvte_terminal_unrealize):
		Set the fontdirty flag to TRUE.
	* src/deepinvtexft.c: (_deepinvte_xft_set_text_font),
	(_deepinvte_xft_get_char_width), (_deepinvte_xft_draw_text),
	(_deepinvte_xft_draw_char):
		Add safe guards to avoid dereferencing a NULL font as it
		is possible for _deepinvte_xft_font_open() to fail.

2007-01-25  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 399137 – UTF-8 problem in DeepinvteAccess

	Improve the UTF-8 string handling within deepinvteaccess.c
	A long and fraught history to this apparently simple change.
	Many thanks to Joanmarie Diggs and Rich Burridge for testing the
	patches and ensuring they caused no regressions in the ally interface.

	* src/deepinvteaccess.c: (emit_text_changed_insert),
	(emit_text_changed_delete):
		Use g_utf8_pointer_to_offset() rather than open coding.
	* src/deepinvteaccess.c: (deepinvte_terminal_accessible_text_modified):
		Convert the caret into a byte offset before performing the
		ASCII character lookup.
		Iterate backwards over the string using a g_utf8_prev_char,
		and g_utf8_get_char.

2007-01-25  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 400493 – Mouse selection seriously broken

	The rendering of non-text attributes, e.g highlight, backgrounds,
	underlines, was broken by the change to multi-row run of glyphs. This
	was most apparent when selecting regions with a mouse.

	* src/deepinvte.c: (_deepinvte_invalidate_cursor_once),
	(deepinvte_terminal_extend_selection),
	(deepinvte_terminal_draw_rows), (deepinvte_terminal_draw_area),
	(deepinvte_terminal_paint):
		Some janitorial work (a memleak, whitespace, improving debug
		messages, comments).
	* src/deepinvte.c: (deepinvte_terminal_draw_cells):
		Loop over cells and draw attributes for groups of cells on
		each row.

2007-01-25  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 400438 – _deepinvte_invalidate_all triggered on GDK_VISIBILITY_UNOBSCURED

	* src/deepinvte.c: (deepinvte_terminal_visibility_notify):
		Only force an _deepinvte_invalidate_all if we can trivially detect
		that we have switch from fully obscured to fully unobscured.
		Otherwise, we will just handle the GDK expose in the normal
		manner.
	* src/deepinvte.c: (deepinvte_terminal_expose):
		Check the event area to see if we can use _deepinvte_invalidate_all,
		has a slight benefit of discarding further exposed area
		processing.
		

2007-01-25  Chris Wilson <chris@chris-wilson.co.uk>

	GDK tries to coalesce multiple expose events into a single event.
	This is passed to the application as a large region containing
	multiple rectangles. The unfortunate effect of this is having
	broken the invalidated region into 2 small components for vim,
	the expose event was still operating on a single region covering
	both. The reason the effect was invisible to the eye is due to the
	double buffer - GDK generated a backing pixmap for the exposed event
	and only copied from the pixmap to the window exactly the pixels
	exposed. So we regenerated draw commands for the entire area, and
	only saved on the later blit.

	The improvement to this is only issue draw commands for the individual
	rectangles rather than the region as a whole.

	* src/deepinvte.c: (deepinvte_terminal_draw_area), (deepinvte_terminal_paint),
	(deepinvte_terminal_expose):
		Paint the exposed rectangles not the event clipbox!

2007-01-25  Chris Wilson <chris@chris-wilson.co.uk>

	Print out the painted area for DEEPINVTE_DEBUG_UPDATES.

	* src/deepinvte.c: (deepinvte_terminal_paint):

2007-01-24  Chris Wilson <chris@chris-wilson.co.uk>

	cf Bug 400072 – Handling of ; in control sequences

	Moral of the story: wait until the morning.
	Revert r1512, the mistaken attempt at parsing '\e[;30m'.

	* src/table.c: (_deepinvte_table_addi), (_deepinvte_table_matchi),
	(_deepinvte_table_match):

2007-01-24  Chris Wilson <chris@chris-wilson.co.uk>

	cf Bug 399617 – Avoid memory allocations during an expose event.

	Currently we cannot generate long glyph runs due to the text
	painting being broken up into single rows and setting a low
	max run cap. The benefit of longer runs is the backends can
	do more caching within a run and potentially generate fewer
	render calls and/or less network traffic.

	In the simple test case, this increased the performance of a
	remote hexdump by 10%.

	* src/deepinvte.c: (deepinvte_terminal_draw_rows), (deepinvte_terminal_paint):
		Scan entired exposed area for glyph runs.
	* src/deepinvtedraw.h:
		Increase DEEPINVTE_DRAW_MAX_LENGTH
	* src/deepinvtexft.c: (_deepinvte_xft_draw_text):
		Create GlyphSpecs rather than CharFontSpecs, saves a 
		conversion and potential malloc inside libXft, and our
		own malloc.

2007-01-24  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 147495 – screen flicker when opening new terminal windows

	Last in a series of work to reduce extraneous redraws. I no longer
	see the flicker when opening a white terminal.

	* src/deepinvte.c: (_deepinvte_terminal_scroll_region):
		Detect when we can just invalidate all.
	* src/deepinvte.c: (_deepinvte_terminal_fork_basic):
		Don't force an unnecessary redraw.

2007-01-24  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_set_emulation):
		Add a missing '\n' to the debug printerr.
	* src/deepinvte.c: (deepinvte_terminal_init):
		Initialize the row count to DEEPINVTE_MIN_SCROLLBACK (was to 0
		first and then later within the same function to
		DEEPINVTE_MIN_SCROLLBACK).

2007-01-24  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 334755 – Incomplete information from deepinvte_terminal_get_font

	In many situations the font_desc stored in the terminal is incomplete.
	_deepinvte_fc_transcribe_from_pango_font_description() automagically fills
	in default values for the backends but this is hidden from the
	application. By filling in default values up front from the widget
	font description control is returned to the application and theme
	designers.

	Patch by Pedro de Medeiros.
	Also cf bug 335269.

	* src/deepinvte.c: (deepinvte_terminal_set_font_full):
		Pull default font description from widget.
	* src/deepinvtefc.c: (_deepinvte_fc_transcribe_from_pango_font_description):
		Remove default values.

2007-01-24  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 400184 – _deepinvte_pty_open declaration mismatch - breaks on Solaris
	actually revealed a faux-pas in the conversion of the public
	interfaces to GPid - that it broke the ABI.

	However, the intention is to remove the exposed pid_t, cf bug 400333.

	* python/deepinvte.defs:
	* python/deepinvte.override:
	* src/pty.c: (_deepinvte_pty_open):
	* src/pty.h:
	* src/deepinvte.c: (_deepinvte_terminal_fork_basic), (deepinvte_terminal_forkpty):
	* src/deepinvte.h:
		Revert the exposed GPids back to pid_t.

2007-01-24  Chris Wilson <chris@chris-wilson.co.uk>

	==25123== Invalid read of size 1
	==25123==    at 0x4055992: deepinvte_terminal_accessible_text_modified (deepinvteaccess.c:497)
	==25123==    by 0x46A1248: g_cclosure_marshal_VOID__VOID (gmarshal.c:77)
	==25123==    by 0x4693EAA: g_closure_invoke (gclosure.c:490)
	==25123==    by 0x46A4972: signal_emit_unlocked_R (gsignal.c:2440)
	==25123==    by 0x46A5E96: g_signal_emit_valist (gsignal.c:2199)
	==25123==    by 0x46A85ED: g_signal_emit_by_name (gsignal.c:2267)
	==25123==    by 0x403E9E2: _deepinvte_terminal_emit_text_inserted (deepinvte.c:863)
	==25123==    by 0x40517EF: deepinvte_terminal_process_incoming (deepinvte.c:3032)
	==25123==    by 0x40522B5: update_repeat_timeout (deepinvte.c:11332)

	* src/deepinvteaccess.c: (deepinvte_terminal_accessible_text_modified):
		Check that the caret is inside the old string before
		accessing.

2007-01-24  Chris Wilson <chris@chris-wilson.co.uk>

	Revert changes in conjunction with bug 399137 back to r1487,
	which contains Rich Burridge's fix for bug 397724.

	* src/deepinvteaccess.c: (emit_text_changed_insert),
	(emit_text_changed_delete),
	(deepinvte_terminal_accessible_text_modified):

2007-01-24  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvteaccess.c: (deepinvte_terminal_accessible_text_modified):
		Valgrind pointed out a couple of places where we tried to
		access before the start of the string.

2007-01-24  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 400184 – _deepinvte_pty_open declaration mismatch - breaks on Solaris

	Patch by Damien Carbery.

	* src/pty.h:
		Update prototype to match new definition.

2007-01-24  Chris Wilson <chris@chris-wilson.co.uk>

	<mariano> hm, deepinvte is not matching «ESC [ ; 7 m» :/

	* src/table.c: (_deepinvte_table_addi), (_deepinvte_table_matchi),
	(_deepinvte_table_match):
		s/GList/GSList/
		g_slist_append -> g_slist_reverse(g_slist_prepend)
		And finally add the subtable to handle the leading ';'
		in the variable length parameters.

2007-01-23  Chris Wilson <chris@chris-wilson.co.uk>

	A couple of minor buggets.

	* src/iso2022.c: (_deepinvte_iso2022_state_set_codeset):
		Use g_intern_string() instead of from_quark(to_quark(str))
	* src/deepinvtepango.c: (_deepinvte_pango_create), (_deepinvte_pango_destroy),
	(_deepinvte_pango_start), (_deepinvte_pango_end), (_deepinvte_pango_set_text_font):
		Use the widget pango context (we're guarranteed to have a
		screen by this point) and don't unref it!
		Inspired by Pedro de Medeiros in Bug 335269.

2007-01-23  Chris Wilson <chris@chris-wilson.co.uk>

	Regression on Bug 123591:
		mkdir /tmp/aa; cd /tmp/aa; bash; cd ..; rmdir aa
		Open a new tab in g-t -> Failure.	

	* src/pty.c: (_deepinvte_pty_run_on_pty):
		Check the error return from g_spawn and try again with the
		pwd if it reports that the child could not change directory.

2007-01-23  Chris Wilson <chris@chris-wilson.co.uk>

	* src/pty.c: (_deepinvte_pty_run_on_pty):
		Add all g_spawn parameters to DEEPINVTE_DEBUG_MISC output.

2007-01-22  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.15.2.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.15.2.

	* src/Makefile.am: Bumped libtool version to 10:9:1.

2007-01-22  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 399137 - continuation.

	* src/deepinvteaccess.c: (deepinvte_terminal_accessible_text_modified):
		Classic bug:
			clen = cp - old
		rather than the more correct
			clen = cp - current

2007-01-22  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvteapp.c: (char_size_changed), (char_size_realized), (main):
		Don't try to perform gdk operations on unrealized windows.

2007-01-22  Chris Wilson <chris@chris-wilson.co.uk>

	* src/pty.c: (_deepinvte_pty_run_on_pty):
		Print out the argument vector for DEEPINVTE_DEBUG_MISC.

2007-01-22  Chris Wilson <chris@chris-wilson.co.uk>

	* src/pty.c: (_deepinvte_pty_run_on_pty):
		Protect against g_strv_length(NULL)

2007-01-22  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 399137 - continuation.

	* src/deepinvteaccess.c: (deepinvte_terminal_accessible_text_modified):
		After walking back along the UTF-8 string, remember to update
		the string lengths that are used to detect insertions and
		deletions!

2007-01-22  Chris Wilson <chris@chris-wilson.co.uk>

	If the caret is at the end of the buffer, then it set past the
	end of the offset array - do not use this as a lookup!

	* src/deepinvteaccess.c: (deepinvte_terminal_accessible_text_modified):
		If the caret points to past the last character, set the
		offset to the string's NUL terminator.

2007-01-22  Chris Wilson <chris@chris-wilson.co.uk>

	* configure.in:
		Earlier configure.in update introduced a trailing ']', pair
		it with its '['
		

2007-01-22  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 132316 – terminal widget's context menu posting isn't exposed as an AtkAction

	Original patch by <padraig.obriain@sun.com>

	* src/deepinvteaccess.c: (deepinvte_terminal_accessible_free_private_data),
	(deepinvte_terminal_accessible_component_init),
	(deepinvte_terminal_accessible_do_action),
	(deepinvte_terminal_accessible_get_n_actions),
	(deepinvte_terminal_accessible_action_get_description),
	(deepinvte_terminal_accessible_action_get_name),
	(deepinvte_terminal_accessible_action_get_keybinding),
	(deepinvte_terminal_accessible_action_set_description),
	(deepinvte_terminal_accessible_action_init),
	(deepinvte_terminal_accessible_get_type):
		Remove grab_focus and defer to the parent's implementation.
		Add an AtkAction iface.

2007-01-22  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 156161 – AccessibleText_getTextAtOffset returns wrong values in gnome-terminal

	The code for ATK_TEXT_BOUNDARY_WORD_START and
	ATK_TEXT_BOUNDARY_WORD_END is the same.

	Patch by <padraig.obriain@sun.com>

	* src/deepinvteaccess.c: (deepinvte_terminal_accessible_get_text_somewhere):
		Actually provide an implementation for
		ATK_TEXT_BOUNDARY_WORD_END.

2007-01-22  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 399137 – UTF-8 problem in DeepinvteAccess

	* src/deepinvteaccess.c: (emit_text_changed_insert),
	(emit_text_changed_delete):
		use g_utf8_pointer_to_offset() instead of open coding
	(deepinvte_terminal_accessible_update_private_data_if_needed):
		add the number of UTF-8 characters to the debug output.
	(deepinvte_terminal_accessible_text_modified):
		iterate backwards over the UTF-8 string using
		g_utf8_prev_char() and convert the caret into a byte offset
		before it as such.

2007-01-22  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 123591 – deepinvte_terminal_fork_command succeeds even when it does not

	* python/deepinvte.defs:
	* python/deepinvte.override:
	* src/reaper.c: (deepinvte_reaper_child_watch_cb):
	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_catch_child_exited),
	(_deepinvte_terminal_fork_basic), (deepinvte_terminal_forkpty):
	* src/deepinvte.h:
	* src/deepinvteapp.c:
		s/pid_t/GPid/ portable variant, no API/ABI implications
	* src/pty.c: (deepinvte_pty_child_setup), (_deepinvte_pty_run_on_pty),
	(_deepinvte_pty_fork_on_pty_name), (_deepinvte_pty_fork_on_pty_fd),
	(_deepinvte_pty_open_unix98), (_deepinvte_pty_pipe_open), (n_read), (n_write),
	(_deepinvte_pty_start_helper), (_deepinvte_pty_open_with_helper),
	(_deepinvte_pty_open), (main):
		Replace custom fork() and pipe based syncrohonisation scheme
		with g_spawn_async_with_pipes() as it actually handles all
		failure modes correctly, and gives us overtures of portability.
		

2007-01-22  Chris Wilson <chris@chris-wilson.co.uk>

	Hack'n'slash my way through doing a bit of weeding.

	Fixed:
	- Bug 345514 – -no-undefined doesn't work with latest libtool
	- Bug 162003 – deepinvte configure.in X checking can fail
	             – though this may cause other regressions!
	- Bug 314669 – Please specialize AC_PATH_XTRA

	* configure.in:
		Export LIBTOOL_EXPORT_OPTIONS for -no-undefined on windos.
		Add to rather than override X_CFLAGS, X_LIBS
		AC_PATH_XTRA - Find X11 using XFlush() rather than XtMalloc().
		Print configuration details.
	* src/Makefile.am:
		Conditional compilation of backends.

2007-01-22  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 389538 – crash in Terminal: nothing

	* src/deepinvteaccess.c: (deepinvte_terminal_accessible_get_text):
		Guard against negative length strings.

2007-01-22  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 161479 – Scroll wheel generates Release events

	 deepinvte sends release events on scroll but xterm doesn't which breaks
	 mc among others.

	 Patch by Benedikt Meurer.

	* src/deepinvte.c: (deepinvte_terminal_scroll):
		Remove the offending release event.

2007-01-20  Chris Wilson <chris@chris-wilson.co.uk>

	<kmaraas> ickle: sparse complains about dubious 1 bit bitfields
		if you use gboolean instead of guint
	<kmaraas> so s/gboolean/guint at line 166 and 174
	<mariano> unless that changes the API, of course...
	<kmaraas> it doesn't
	<mariano> gboolean a:1 is not very correct anyways
	<kmaraas> ickle: we've done the same change in other modules
	<ickle> if I do it quick, behdad might not even notice ;)

	* src/deepinvte.h:
		Convert signed single bit field to unsigned. The code
		was setting it to 1 anyhow (and not -1 as the type indicated).

2007-01-20  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 398602 – Build Failure

	* src/deepinvte.c: (deepinvte_terminal_expose):
		Fixup typo. [Grrr. Must get git-svn back into sync]

2006-11-19 Rich Burridge <rich.burridge@sun.com>

        * src/deepinvteaccess.c:
        Fixed bug #397724 - Orca incorrect echo's certain input in 
        gnome-terminal when key echo is set to off (on Ubuntu Feisty).

2007-01-20  Chris Wilson <chris@chris-wilson.co.uk>
	
	* src/deepinvte.c: (deepinvte_terminal_expose):
		Also if the entire terminal is invalidated,
		do not add more GTK+ exposes to it.

2007-01-20  Chris Wilson <chris@chris-wilson.co.uk>

	Track when we have invalidated the entire terminal and skip adding
	new regions when possible.

	* src/deepinvte-private.h:
	* src/deepinvte.c: (update_regions), (_deepinvte_invalidate_cells),
	(_deepinvte_invalidate_all), (deepinvte_terminal_size_allocate),
	(reset_update_regions):

2007-01-20  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 398244 – Gnome-terminal opens a huge sized window

	* src/deepinvte.c: (deepinvte_terminal_ensure_font),
	(deepinvte_terminal_set_font_full), (deepinvte_terminal_size_request),
	(deepinvte_terminal_realize), (deepinvte_terminal_get_char_width),
	(deepinvte_terminal_get_char_height), (deepinvte_terminal_get_char_descent),
	(deepinvte_terminal_get_char_ascent):
		Ensure the font metrics are calculated before use.

2007-01-19  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_process_incoming):
		Do not invalidate the old cursor position if it was not
		visible.

2007-01-19  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (process_timeout):
		Make sure ->process_timeout is set to DEEPINVTE_INVALID_SOURCE on
		all paths that remove the timeout.

2007-01-19  Chris Wilson  <chris@chris-wilson.co.uk>

	Add <> to mark boundaries of process_timeout().

	* src/deepinvte.c: (deepinvte_terminal_class_init), (process_timeout):

2007-01-19  Chris Wilson  <chris@chris-wilson.co.uk>

	Add {},[] to mark boundaries of update_timeout() and notice that
	the display limited update_timeout was not dying.

	* src/deepinvte.c: (deepinvte_terminal_class_init), (update_repeat_timeout),
	(update_timeout):

2007-01-19  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_realize), (remove_process_timeout):
		Small cleanup:
		 - protect remove_process_timeout against an invalid source.
		 - move static prototypes into common block.
		 - gdk_window_show() is done in map not realize.

2007-01-19  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_process_incoming):
		Introduce a bit of slack in the bbox check to allow
		for a small of amount of cursor motion e.g. due to line
		scrolling. This turns the long sequence of
		'(?!?!??? ... ????!)'
		during a hexdump into the better behaved 
		'.(?!?!?!??!)-+=.(?!?!??!)-+=........'. Although it is
		puzzling why we now how have a block of IO and then two quick
		display upates...

2007-01-19  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (process_timeout), (update_repeat_timeout),
	(update_timeout):
		Repeat _deepinvte_terminal_process_incoming until we have drained
		the incoming buffers or we can handle no more. Fixes a
		problem where the display wouldn't update if we hadn't
		processed enough data (e.g. on startup, displaying the first
		prompt). This bug corresponds with the sequence
		'*-+=..()?!(?!?!?!)-+=' below, which now reads
		'*-+=..()(?!?!?!)-+='

2007-01-19  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (_deepinvte_invalidate_cursor_once):
		"%ld" for cursor indices.

2007-01-19  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (_deepinvte_invalidate_cells),
	(_deepinvte_invalidate_cursor_once):
		Cursor indices are long.

2007-01-19  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvte-private.h:
	* src/deepinvte.c: (_deepinvte_invalidate_cell):
		Cursor indices are long.
	* src/deepinvte.c: (_deepinvte_terminal_expose):
		Prepend the GTK+ generated expose if we already have an
		display update pending.

2007-01-19  Chris Wilson <chris@chris-wilson.co.uk>

	Add a new debug flag to visualize the work flow.
	DEEPINVTE_DEBUG_FLAGS=work generates output like:
	Debugging work flow (top input to bottom output):
	  .  _deepinvte_terminal_process_incoming
	  (  start _deepinvte_terminal_process_incoming
	  ?  _deepinvte_invalidate_cells (call)
	  !  _deepinvte_invalidate_cells (dirty)
	  *  _deepinvte_invalidate_all
	  )  end _deepinvte_terminal_process_incoming
	  -  gdk_window_process_all_updates
	  +  deepinvte_terminal_expose
	  =  deepinvte_terminal_paint
	*?!**+=*-+=..()?!(?!?!?!)-+=?!-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.().(?!?!?!)-+=.().(?!?!?!)-+=.().().(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!?!)-+=.(?!?!)-+=.............................................................................................................................................................................................................................................................................(?!?!?!?!?!?!?!?!?!?!?!?!?!?!?!?!?!?!?!?!?!?!?!?!?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????!??!)-+=.......................................................................

	Which tells me I have two bugs to track:
		1. the initial '..()' is a missing invalidate.
		2. '(?!?!????????????????????!??!)' is not very efficient.

	* src/debug.c: (_deepinvte_debug_parse_string):
	* src/debug.h:
	* src/deepinvte.c: (update_regions), (_deepinvte_invalidate_cells),
	(_deepinvte_invalidate_all), (deepinvte_terminal_process_incoming),
	(deepinvte_terminal_io_read), (deepinvte_terminal_paint),
	(deepinvte_terminal_expose), (deepinvte_terminal_class_init):
		Add DEEPINVTE_DEBUG_WORK

2007-01-19  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 398150 – cursor leaves trail behind in vim

	* src/deepinvte-private.h:
	* src/deepinvte.c: (_deepinvte_invalidate_cell),
	(deepinvte_terminal_process_incoming):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_decset_internal):
		Invalidate the old cursor position if we detect the cursor
		moved during the sequence or if the cursor changed state.

2007-01-19  Chris Wilson <chris@chris-wilson.co.uk>

	* src/Makefile.am:
		Missing $(X_CFLAGS)

2007-01-19  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 398243 – Crash

	* src/deepinvtebg.c: (deepinvte_bg_cache_prune_int):
		Use the return from g_list_delete_link to maintain the list
		head.

2007-01-18  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (_deepinvte_invalidate_cells):
		Check that the start of the invalid region is on screen.

2007-01-18  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 398116 – lags behind when widget not visible

	* src/deepinvte.c: (deepinvte_terminal_handle_scroll):
		During the spring clean, I converted a few GTK_WIDGET_REALIZED()
		checks to GTK_WIDGET_DRAWABLE()+visibility check.
		Unfortunately, it broke keeping the scroll delta in sync with
		the insert delta. Sync the pair, then perform the check before
		making updates on the visible area.

2007-01-18  Chris Wilson <chris@chris-wilson.co.uk>

	Bug 398083 – background not painted correctly when starting up

	* src/deepinvte.c: (_deepinvte_invalidate_all):
		Compute drawable area in window co-ordinates and not widget
		co-ordinates.

2007-01-18  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_expose):
		Small bit of logic inversion that would have tried to paint
		on unmapped and invisible widgets.

2007-01-18  Chris Wilson <chris@chris-wilson.co.uk>
	And the corresponding overrides. [The downsides of losing track of
	which machine you are working on.]

	* python/deepinvte.override:
		Add (get_text_include_trailing_spaces)

2007-01-18  Chris Wilson <chris@chris-wilson.co.uk>

	Add missing export of deepinvte_terminal_get_text_include_trailing_spaces,
	needed for building a simple testcase for Bug 397724.
	deepinvte.defs needs a bit of love...

	* python/deepinvte.defs:
		Add (get_text_include_trailing_spaces)

2007-01-18  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvterdb.c: (_deepinvte_rdb_search), (_deepinvte_rdb_boolean):
		Fix a couple of compiler warnings.

2007-01-18  Chris Wilson <chris@chris-wilson.co.uk>

	* src/deepinvte.c: (deepinvte_terminal_process_incoming):
		Delete some dead code.

2007-01-18  Chris Wilson <chris@chris-wilson.co.uk>

	* configure.in:
		Restore --enable-debugging. 

2007-01-18  Chris Wilson  <chris@chris-wilson.co.uk>

	Copy Behdad's MAYBE_WARN comprehensive set of warnings from Cairo,
	and fixup the immediate compilation failures.

	* configure.in:
		Iterate over a list of warnings and check that they are valid
		for the compiler.
		
	* src/debug.c: (_deepinvte_debug_on):
		Kill fflush() [redundant with g_printerr].

2007-01-18  Behdad Esfahbod  <behdad@gnome.org>

	* configure.in: Don't call AC_CANONICAL_HOST.  Libtool calls it
	already.

	* src/Makefile.am: Don't build extra, test, programs by default.
	Speeds build up.

2007-01-18  Behdad Esfahbod  <behdad@gnome.org>

	* src/ring.c (_deepinvte_ring_insert_preserve):
	* src/deepinvte.c (deepinvte_terminal_paint):
	Fix loop-optimization warnings.

2007-01-18  Behdad Esfahbod  <behdad@gnome.org>

	* src/ssfe.c (cleanupexit), (barf):
	* src/deepinvtebg.c (deepinvte_bg_cache_prune_int):
	* src/deepinvtetc.c (main):
	Fix more warnings.

2007-01-18  Behdad Esfahbod  <behdad@gnome.org>

	* src/table.c (main):
	* src/trie.c (_deepinvte_trie_addx), (main):
	* src/utf8echo.c (main):
	Fix int vs long int mismatches in printf args.

2007-01-18  Behdad Esfahbod  <behdad@gnome.org>

	* src/iso2022.c (_deepinvte_iso2022_find_nextctl):
	* src/reaper.c (deepinvte_reaper_finalize):
	* src/deepinvte.c (_deepinvte_terminal_insert_char), (deepinvte_terminal_key_press),
	(deepinvte_terminal_init), (deepinvte_terminal_size_allocate):
	* src/deepinvteapp.c (main):
	* src/deepinvtedraw.c (_deepinvte_draw_init_default):
	* src/deepinvteglyph.c (_deepinvte_glyph_cache_free):
	* src/deepinvtergb.c (_deepinvte_rgb_copy):
	* src/deepinvtexft.c (_deepinvte_xft_font_for_char):
	Remove unused variables.

2007-01-18  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 161342 revisited. Reset the box to +-inf and not the current
	cursor otherwise you just reproduce the slow behaviour (an overly
	large invalidation area).

	* src/deepinvte.c: (deepinvte_terminal_process_incoming):
		Reset bbox to +-inf.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	Second breakage: DEEPINVTE_INVALID_SOURCE !=0 and calling
	deepinvte_terminal_set_scrollback_lines with lines == ->scrollback_lines
	is not a nop.

	* src/deepinvte.c: (deepinvte_terminal_background_update),
	(deepinvte_terminal_queue_background_update):
		DEEPINVTE_INVALID_SOURCE != 0
	(deepinvte_terminal_set_scrollback_lines):
		reset the rowdata everytime.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 397414 - port deepinvteapp to GOption

	* src/deepinvteapp.c: (main):
		Translation of getopt switch to GOptionEntry[].
		Missing help for --geometry.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	First breakage spotted: the realized flag is set too late in
	the realize handler. Note to self: not everybody uses a black
	background.

	* src/deepinvte.c: (deepinvte_terminal_realize):
		Restore GTK_WIDGET_SET_FLAGS(REALIZED)

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	Bug 395373 - Allow the user to specify backend priorities.

	* src/deepinvtedraw.c: (_deepinvte_draw_init_user), (_deepinvte_draw_init_default),
	(_deepinvte_draw_new):
		Scan $ENV{DEEPINVTE_BACKEND} for the user's preferred backend
		and failover to the first working backend.
		Discard checking DEEPINVTE_USE_*

	* src/deepinvtedraw.h:
	* src/deepinvteft2.c:
	* src/deepinvteft2.h:
	* src/deepinvtegl.c:
	* src/deepinvtegl.h:
	* src/deepinvtepango.c:
	* src/deepinvtepango.h:
	* src/deepinvtepangox.c:
	* src/deepinvtepangox.h:
	* src/deepinvteskel.c: (_deepinvte_skel_check), (_deepinvte_skel_create),
	(_deepinvte_skel_destroy), (_deepinvte_skel_start):
	* src/deepinvteskel.h:
	* src/deepinvtexft.c:
	* src/deepinvtexft.h:
		Remove the environment variable field, drop the "Deepinvte" prefix
		from the backend names and make the exported structure const.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/iso2022.c: (_deepinvte_iso2022_is_ambiguous):
	* src/deepinvte-private.h:
	* src/deepinvte.c: (_deepinvte_terminal_set_default_attributes),
	(deepinvte_terminal_set_default_tabstops), (deepinvte_terminal_set_encoding),
	(deepinvte_terminal_set_opacity), (deepinvte_terminal_set_default_colors),
	(deepinvte_terminal_emit_pending_text_signals),
	(deepinvte_terminal_feed_child_using_modes),
	(deepinvte_terminal_hierarchy_changed),
	(deepinvte_terminal_send_mouse_button_internal),
	(deepinvte_terminal_maybe_send_mouse_drag), (deepinvte_terminal_set_font),
	(deepinvte_terminal_set_font_from_string), (deepinvte_terminal_set_size),
	(deepinvte_terminal_handle_scroll), (deepinvte_terminal_set_scroll_adjustment),
	(deepinvte_terminal_set_emulation), (deepinvte_terminal_set_termcap),
	(deepinvte_terminal_init), (deepinvte_terminal_size_allocate),
	(deepinvte_terminal_unrealize), (deepinvte_terminal_finalize),
	(deepinvte_terminal_realize), (deepinvte_terminal_determine_colors),
	(deepinvte_terminal_background_update),
	(deepinvte_terminal_queue_background_update),
	(deepinvte_terminal_set_background_transparent),
	(deepinvte_terminal_set_cursor_blinks),
	(deepinvte_terminal_set_scrollback_lines), (deepinvte_terminal_reset),
	(deepinvte_terminal_set_pty):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_st),
	(deepinvte_sequence_handler_vb),
	(deepinvte_sequence_handler_device_status_report),
	(deepinvte_sequence_handler_dec_device_status_report),
	(deepinvte_sequence_handler_window_manipulation):
		Janitorial work to improve code readability and small
		micro-optimisations, such as use the length returned by
		g_snprintf rather then calling strlen on the result or just
		using a constant string.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/ring.h:
		Make the debug checks conditional on DEEPINVTE_DEBUG.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/matcher.c: (_deepinvte_matcher_add), (_deepinvte_matcher_create),
	(_deepinvte_matcher_destroy), (_deepinvte_matcher_new), (_deepinvte_matcher_match),
	(_deepinvte_matcher_print):
	* src/matcher.h:
	* src/table.c: (_deepinvte_table_new):
	* src/table.h:
	* src/trie.c: (_deepinvte_trie_new):
	* src/trie.h:
		_deepinvte_match_match() is called extremely frequently, and the
		switch shows up on the profiles. Replace the switch with a
		function pointer obtained by introducing function tables for
		the matcher implementations.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_terminal_set_font_full), (deepinvte_terminal_realize):
		Don't load a font until the terminal is realized.
		Saves decoding 2 or 3 fonts before g-t is mapped.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/deepinvteseq.c: (deepinvte_g_array_fill):
		Micro-optimise the loop.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/deepinvteft2.c: (_deepinvte_ft2_create), (_deepinvte_ft2_start),
	(_deepinvte_ft2_end), (update_bbox), (_deepinvte_ft2_set_text_font),
	(_deepinvte_ft2_draw_text):
	* src/deepinvtergb.c: (_deepinvte_rgb_buffer_new), (_deepinvte_rgb_buffer_resize),
	(_deepinvte_rgb_draw_color_rgb), (_deepinvte_rgb_copy):
	* src/deepinvtergb.h:
		Reuse converted glyphs within a run.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/deepinvteconv.c: (_deepinvte_conv_utf8_strlen), (_deepinvte_conv):
		Micro-optimise the loops.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/deepinvteglyph.c: (_deepinvte_glyph_free), (_deepinvte_cached_glyph_free),
	(_deepinvte_glyph_cache_new), (_deepinvte_glyph_cache_free),
	(_deepinvte_glyph_cache_set_font_description),
	(_deepinvte_glyph_cache_has_char), (_deepinvte_glyph_remap_char),
	(_deepinvte_glyph_get_uncached), (_deepinvte_glyph_get), (_deepinvte_glyph_draw):
	* src/deepinvteglyph.h:
		Avoid the double glyph lookup in _deepinvte_glyph_get and
		replace the tree with a hash.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/iso2022.c: (_deepinvte_iso2022_state_new),
	(_deepinvte_iso2022_state_free), (_deepinvte_iso2022_state_set_codeset):
	* src/trie.c: (_deepinvte_trie_add), (convert_mbstowcs):
	* src/utf8echo.c: (main):
	* src/deepinvte.c: (deepinvte_terminal_set_encoding), (deepinvte_terminal_send),
	(deepinvte_terminal_init), (deepinvte_terminal_finalize),
	(deepinvte_terminal_set_word_chars):
	* src/deepinvteconv.c: (_deepinvte_conv_open), (_deepinvte_conv_close), (_deepinvte_conv):
	* src/deepinvteconv.h:
	* src/deepinvteseq.c: (deepinvte_sequence_handler_set_title_internal):
		s/(DeepinvteConv)-1/DEEPINVTE_INVALID_CONV/

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/deepinvte.c: (_deepinvte_new_row_data), (_deepinvte_new_row_data_sized),
	(_deepinvte_terminal_find_row_data), (_deepinvte_row_data_find_charcell),
	(deepinvte_line_is_wrappable), (deepinvte_terminal_extend_selection),
	(deepinvte_terminal_draw_row):
		Refactor deepinvte_find_row_data to simplify and improve
		some logic.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/deepinvte.c: (deepinvte_g_array_fill), (deepinvte_terminal_emit_commit),
	(_deepinvte_terminal_ensure_cursor), (_deepinvte_terminal_insert_char),
	(_deepinvte_terminal_fork_basic), (deepinvte_terminal_process_incoming),
	(deepinvte_terminal_key_press), (deepinvte_terminal_visibility_notify),
	(deepinvte_terminal_apply_metrics), (deepinvte_terminal_paint),
	(deepinvte_terminal_expose):
		Callgrind driven rewrite of critical loops.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/deepinvte-private.h:
	* src/deepinvte.c: (_deepinvte_terminal_connect_pty_write),
	(_deepinvte_terminal_disconnect_pty_write), (deepinvte_terminal_io_read),
	(deepinvte_terminal_feed), (deepinvte_terminal_feed_child_binary),
	(deepinvte_terminal_init), (deepinvte_terminal_unrealize),
	(add_process_timeout), (add_update_timeout),
	(remove_process_timeout), (deepinvte_terminal_stop_processing),
	(deepinvte_terminal_is_processing), (deepinvte_terminal_start_processing),
	(process_timeout), (update_repeat_timeout), (update_timeout):
		The rate-limiting step is the display update - we do not need
		to process input faster than we are displaying it. So use the
		update display timeout to process new input (and dirty some
		more pixels).


2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/interpret.c: (main):
	* src/iso2022.c: (_deepinvte_iso2022_fragment_input),
	(_deepinvte_iso2022_process), (main):
	* src/deepinvte.c: (deepinvte_terminal_match_contents_refresh),
	(deepinvte_terminal_process_incoming), (deepinvte_terminal_init),
	(deepinvte_terminal_set_word_chars):
	* src/deepinvteaccess.c:
	(deepinvte_terminal_accessible_update_private_data_if_needed):
	* src/deepinvtefc.c: (_deepinvte_fc_patterns_from_pango_font_desc):
	* src/deepinvtefc.h:
	* src/deepinvteglyph.c: (_deepinvte_glyph_cache_new), (_deepinvte_glyph_cache_free),
	(_deepinvte_glyph_cache_set_font_description):
	* src/deepinvteglyph.h:
	* src/deepinvteregex.c: (_deepinvte_regex_sort_matches):
	* src/deepinvtexft.c: (_deepinvte_xft_font_open), (_deepinvte_xft_font_close),
	(_deepinvte_xft_font_for_char):
		s/g_array_new(TRUE, TRUE/g_array_new(FALSE, FALSE/
		All uses of GArray respect their lengths and do not
		zero-termination or untouched members to be cleared.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/iso2022.c: (_deepinvte_iso2022_state_free):
	* src/matcher.c: (_deepinvte_matcher_free_params_array):
	* src/ring.c: (_deepinvte_ring_free):
	* src/table.c: (_deepinvte_table_free):
	* src/trie.c: (_deepinvte_trie_match):
	* src/deepinvte.c: (_deepinvte_terminal_match_contents_clear),
	(_deepinvte_terminal_fork_basic),
	(deepinvte_terminal_get_text_range_maybe_wrapped), (deepinvte_terminal_copy),
	(deepinvte_terminal_finalize), (deepinvte_terminal_draw_cells_with_attributes):
	* src/deepinvteaccess.c: (deepinvte_terminal_accessible_free_private_data):
	* src/deepinvtebg.c: (deepinvte_bg_root_pixmap), (deepinvte_bg_cache_item_free):
	* src/deepinvteconv.c: (_deepinvte_conv_close):
	* src/deepinvtedraw.c: (_deepinvte_draw_free):
	* src/deepinvteft2.c: (_deepinvte_ft2_destroy):
	* src/deepinvtegl.c: (_deepinvte_gl_destroy):
	* src/deepinvteglyph.c: (_deepinvte_glyph_cache_free):
	* src/deepinvtepango.c: (_deepinvte_pango_destroy):
	* src/deepinvtepangox.c: (_deepinvte_pango_x_destroy):
	* src/deepinvtergb.c: (_deepinvte_rgb_buffer_new), (_deepinvte_rgb_buffer_free):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_se),
	(deepinvte_sequence_handler_so):
	* src/deepinvteskel.c: (_deepinvte_skel_destroy):
	* src/deepinvtexft.c: (_deepinvte_xft_font_close), (_deepinvte_xft_destroy):
		Do not zero memory in destructors, as glib will zero all
		freed memory if G_DEBUG=gc-friendly.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/reaper.c: (deepinvte_reaper_add_child), (deepinvte_reaper_init),
	(deepinvte_reaper_constructor), (deepinvte_reaper_finalize),
	(deepinvte_reaper_class_init), (deepinvte_reaper_get), (main):
	* src/deepinvte.c: (G_DEFINE_TYPE_WITH_CODE), (_deepinvte_terminal_fork_basic),
	(deepinvte_terminal_key_press), (deepinvte_terminal_init), (deepinvte_terminal_show),
	(deepinvte_terminal_finalize), (deepinvte_terminal_get_accessible),
	(deepinvte_terminal_class_init):
	* src/deepinvteaccess.c: (deepinvte_terminal_initialize),
	(deepinvte_terminal_accessible_finalize),
	(deepinvte_terminal_accessible_class_init),
	(deepinvte_terminal_accessible_get_type),
	(deepinvte_terminal_accessible_factory_init),
	(deepinvte_terminal_accessible_factory_new):
	* src/deepinvtebg.c: (deepinvte_bg_native_new), (deepinvte_bg_finalize),
	(deepinvte_bg_class_init), (deepinvte_bg_init), (deepinvte_bg_get_for_screen),
	(deepinvte_bg_cache_item_free), (deepinvte_bg_cache_prune_int),
	(_deepinvte_bg_resize_pixbuf), (deepinvte_bg_set_root_pixmap),
	(deepinvte_bg_cache_add), (deepinvte_bg_cache_search), (deepinvte_bg_get_pixmap),
	(deepinvte_bg_get_pixbuf):
		Use GObject boiler-plate code (G_DEFINE_TYPE),
		as opposed to open coding.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/deepinvte-private.h:
	* src/deepinvte.c: (deepinvte_free_row_data), (deepinvte_g_array_fill),
	(deepinvte_terminal_find_charcell), (deepinvte_terminal_preedit_width),
	(deepinvte_terminal_preedit_length), (_deepinvte_invalidate_cursor_once),
	(deepinvte_invalidate_cursor_periodic), (deepinvte_terminal_deselect_all),
	(deepinvte_terminal_set_default_tabstops),
	(deepinvte_terminal_match_contents_refresh), (deepinvte_terminal_cursor_new),
	(deepinvte_terminal_match_check_internal),
	(deepinvte_terminal_emit_adjustment_changed),
	(deepinvte_terminal_queue_adjustment_changed),
	(deepinvte_terminal_scroll_pages), (deepinvte_terminal_maybe_scroll_to_top),
	(deepinvte_terminal_maybe_scroll_to_bottom),
	(_deepinvte_terminal_set_pointer_visible), (deepinvte_terminal_new),
	(deepinvte_terminal_set_color_internal), (deepinvte_terminal_set_color_bold),
	(deepinvte_terminal_set_color_dim), (deepinvte_terminal_set_color_foreground),
	(deepinvte_terminal_set_color_background),
	(deepinvte_terminal_set_color_cursor),
	(deepinvte_terminal_set_color_highlight), (deepinvte_terminal_handle_sequence),
	(deepinvte_terminal_catch_child_exited),
	(_deepinvte_terminal_connect_pty_read),
	(_deepinvte_terminal_connect_pty_write), (_deepinvte_terminal_fork_basic),
	(deepinvte_terminal_eof), (deepinvte_terminal_im_reset),
	(deepinvte_terminal_process_incoming), (deepinvte_terminal_io_read),
	(deepinvte_terminal_io_write), (deepinvte_terminal_send),
	(deepinvte_terminal_im_commit), (deepinvte_terminal_im_preedit_start),
	(deepinvte_terminal_im_preedit_end), (deepinvte_terminal_im_preedit_changed),
	(deepinvte_terminal_configure_toplevel),
	(deepinvte_terminal_hierarchy_changed), (deepinvte_terminal_style_changed),
	(add_cursor_timeout), (deepinvte_terminal_key_press), (deepinvte_same_class),
	(deepinvte_line_is_wrappable), (deepinvte_terminal_paste_cb),
	(deepinvte_terminal_send_mouse_button_internal),
	(deepinvte_terminal_maybe_send_mouse_drag), (deepinvte_terminal_clear_cb),
	(deepinvte_terminal_copy_cb),
	(deepinvte_terminal_get_text_range_maybe_wrapped),
	(deepinvte_terminal_clipboard_get), (deepinvte_terminal_copy),
	(deepinvte_terminal_paste), (deepinvte_terminal_autoscroll),
	(deepinvte_terminal_start_autoscroll), (deepinvte_terminal_motion_notify),
	(deepinvte_terminal_button_press), (deepinvte_terminal_button_release),
	(deepinvte_terminal_focus_in), (deepinvte_terminal_focus_out),
	(deepinvte_terminal_visibility_notify), (deepinvte_terminal_apply_metrics),
	(deepinvte_terminal_set_font_full), (deepinvte_terminal_refresh_size),
	(deepinvte_terminal_handle_scroll), (deepinvte_terminal_set_scroll_adjustment),
	(deepinvte_terminal_connect_xft_settings),
	(deepinvte_terminal_disconnect_xft_settings),
	(_deepinvte_terminal_codeset_changed_cb), (deepinvte_terminal_init),
	(deepinvte_terminal_size_request), (deepinvte_terminal_size_allocate),
	(deepinvte_terminal_show), (root_pixmap_changed_cb),
	(deepinvte_terminal_unrealize), (deepinvte_terminal_finalize),
	(deepinvte_terminal_realize), (deepinvte_terminal_determine_colors),
	(deepinvte_terminal_paint), (deepinvte_terminal_expose), (deepinvte_terminal_scroll),
	(deepinvte_terminal_get_accessible), (deepinvte_terminal_im_append_menuitems),
	(deepinvte_terminal_background_update),
	(deepinvte_terminal_queue_background_update),
	(deepinvte_terminal_set_background_image),
	(deepinvte_terminal_set_background_image_file),
	(deepinvte_terminal_set_cursor_blinks), (deepinvte_terminal_reset),
	(deepinvte_terminal_set_pty):
	* src/deepinvteaccess.c: (deepinvte_terminal_initialize),
	(deepinvte_terminal_accessible_finalize):
	* src/deepinvtedraw.c: (_deepinvte_draw_new), (_deepinvte_draw_free),
	(_deepinvte_draw_start), (_deepinvte_draw_end):
	* src/deepinvtefc.c: (_deepinvte_fc_transcribe_from_pango_font_description),
	(_deepinvte_fc_defaults_from_gtk), (_deepinvte_fc_connect_settings_changes),
	(_deepinvte_fc_disconnect_settings_changes):
	* src/deepinvteft2.c: (_deepinvte_ft2_destroy),
	(_deepinvte_ft2_set_background_image), (_deepinvte_ft2_clear):
	* src/deepinvtegl.c: (_deepinvte_gl_destroy), (_deepinvte_gl_set_background_image),
	(_deepinvte_gl_clear):
	* src/deepinvtepango.c: (_deepinvte_pango_destroy), (_deepinvte_pango_start),
	(_deepinvte_pango_end), (_deepinvte_pango_set_background_image),
	(_deepinvte_pango_set_text_font):
	* src/deepinvtepangox.c: (_deepinvte_pango_x_destroy), (_deepinvte_pango_x_start),
	(_deepinvte_pango_x_end), (_deepinvte_pango_x_set_background_image),
	(_deepinvte_pango_x_set_text_font):
	* src/deepinvterdb.c: (_deepinvte_rdb_get):
	* src/deepinvteseq.c: (deepinvte_sequence_handler_scroll_up_or_down),
	(deepinvte_sequence_handler_set_title_internal), (deepinvte_terminal_beep),
	(deepinvte_sequence_handler_do), (deepinvte_sequence_handler_sf),
	(deepinvte_sequence_handler_sr), (deepinvte_sequence_handler_vb),
	(deepinvte_sequence_handler_window_manipulation):
	* src/deepinvteskel.c: (_deepinvte_skel_destroy):
	* src/deepinvtetree.c: (_deepinvte_tree_new), (_deepinvte_tree_destroy):
	* src/deepinvtexft.c: (_deepinvte_xft_set_background_image), (_deepinvte_xft_clear):
		Remove superfluous checks and run-time checked type casts.

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	As part of Bug 397439.

	* src/debug.c:
	* src/iso2022.c: (_deepinvte_iso2022_ambiguous_width_guess),
	(_deepinvte_iso2022_state_new), (_deepinvte_iso2022_state_set_codeset),
	(process_8_bit_sequence), (process_cdata), (process_control),
	(_deepinvte_iso2022_process):
	* src/keymap.c: (_deepinvte_keymap_map):
	* src/matcher.c: (_deepinvte_matcher_init), (_deepinvte_matcher_create),
	(_deepinvte_matcher_destroy):
	* src/pty.c: (_deepinvte_pty_run_on_pty), (_deepinvte_pty_fork_on_pty_name),
	(_deepinvte_pty_fork_on_pty_fd), (_deepinvte_pty_set_size),
	(_deepinvte_pty_get_size), (_deepinvte_pty_ptsname), (_deepinvte_pty_open_unix98),
	(_deepinvte_pty_open_with_helper), (_deepinvte_pty_open), (main):
	* src/reaper.c: (deepinvte_reaper_emit_signal),
	(deepinvte_reaper_child_watch_cb), (deepinvte_reaper_init),
	(deepinvte_reaper_finalize):
	* src/reflect.c: (text_changed_insert), (text_changed_delete):
	* src/ring.c: (_deepinvte_ring_insert), (_deepinvte_ring_insert_preserve),
	(_deepinvte_ring_remove), (scrolled_off), (main):
	* src/slowcat.c: (main):
	* src/table.c: (_deepinvte_table_printi), (_deepinvte_table_print):
	* src/trie.c: (char_class_string_extract):
	* src/deepinvte.c: (_deepinvte_invalidate_cursor_once),
	(deepinvte_terminal_emit_selection_changed), (deepinvte_terminal_emit_commit),
	(deepinvte_terminal_emit_emulation_changed),
	(deepinvte_terminal_emit_encoding_changed),
	(deepinvte_terminal_emit_child_exited),
	(_deepinvte_terminal_emit_contents_changed),
	(deepinvte_terminal_emit_cursor_moved), (deepinvte_terminal_emit_eof),
	(deepinvte_terminal_emit_char_size_changed),
	(_deepinvte_terminal_emit_status_line_changed),
	(deepinvte_terminal_emit_increase_font_size),
	(deepinvte_terminal_emit_decrease_font_size),
	(_deepinvte_terminal_emit_text_inserted),
	(_deepinvte_terminal_emit_text_deleted),
	(deepinvte_terminal_emit_text_modified),
	(deepinvte_terminal_emit_text_scrolled), (deepinvte_terminal_deselect_all),
	(deepinvte_terminal_match_check_internal), (deepinvte_terminal_match_check),
	(deepinvte_terminal_emit_adjustment_changed),
	(deepinvte_terminal_queue_adjustment_changed),
	(_deepinvte_terminal_adjust_adjustments), (deepinvte_terminal_scroll_pages),
	(deepinvte_terminal_maybe_scroll_to_bottom), (deepinvte_terminal_set_encoding),
	(_deepinvte_terminal_set_pointer_visible), (deepinvte_terminal_new),
	(deepinvte_terminal_generate_bold), (_deepinvte_terminal_insert_char),
	(display_control_sequence), (deepinvte_terminal_fork_command),
	(deepinvte_terminal_emit_pending_text_signals),
	(deepinvte_terminal_process_incoming), (deepinvte_terminal_io_write),
	(deepinvte_terminal_send), (deepinvte_terminal_im_commit),
	(deepinvte_terminal_im_preedit_start), (deepinvte_terminal_im_preedit_end),
	(deepinvte_terminal_im_preedit_changed),
	(deepinvte_terminal_configure_toplevel),
	(deepinvte_terminal_hierarchy_changed), (deepinvte_terminal_style_changed),
	(deepinvte_terminal_key_press), (deepinvte_terminal_paste_cb),
	(deepinvte_terminal_match_hilite_clear), (deepinvte_terminal_match_hilite),
	(deepinvte_terminal_clear_cb), (deepinvte_terminal_copy_cb),
	(deepinvte_terminal_copy), (deepinvte_terminal_paste),
	(deepinvte_terminal_start_selection), (deepinvte_terminal_extend_selection),
	(deepinvte_terminal_autoscroll), (deepinvte_terminal_motion_notify),
	(deepinvte_terminal_button_press), (deepinvte_terminal_button_release),
	(deepinvte_terminal_focus_in), (deepinvte_terminal_focus_out),
	(deepinvte_terminal_set_font_full), (deepinvte_terminal_set_size),
	(deepinvte_terminal_handle_scroll), (deepinvte_terminal_set_emulation),
	(deepinvte_terminal_set_termcap), (deepinvte_terminal_reset_rowdata),
	(deepinvte_terminal_fc_settings_changed), (deepinvte_terminal_init),
	(deepinvte_terminal_size_request), (deepinvte_terminal_size_allocate),
	(deepinvte_terminal_show), (deepinvte_terminal_unrealize),
	(deepinvte_terminal_finalize), (deepinvte_terminal_realize),
	(deepinvte_terminal_draw_cells), (_deepinvte_terminal_map_pango_color),
	(deepinvte_terminal_paint), (deepinvte_terminal_scroll),
	(deepinvte_terminal_class_init), (deepinvte_terminal_get_type),
	(deepinvte_terminal_copy_clipboard), (deepinvte_terminal_paste_clipboard),
	(deepinvte_terminal_copy_primary), (deepinvte_terminal_paste_primary),
	(deepinvte_terminal_background_update),
	(deepinvte_terminal_queue_background_update),
	(deepinvte_terminal_set_background_saturation),
	(deepinvte_terminal_set_background_tint_color),
	(deepinvte_terminal_set_background_transparent),
	(deepinvte_terminal_set_background_image),
	(deepinvte_terminal_set_background_image_file),
	(deepinvte_terminal_set_word_chars):
	* src/deepinvteaccess.c: (emit_text_caret_moved),
	(emit_text_changed_insert), (emit_text_changed_delete),
	(deepinvte_terminal_accessible_update_private_data_if_needed),
	(deepinvte_terminal_accessible_invalidate_cursor),
	(deepinvte_terminal_accessible_finalize),
	(deepinvte_terminal_accessible_get_text),
	(deepinvte_terminal_accessible_get_text_somewhere),
	(deepinvte_terminal_accessible_text_init),
	(deepinvte_terminal_accessible_component_init),
	(deepinvte_terminal_accessible_factory_new):
	* src/deepinvteapp.c: (main):
	* src/deepinvtebg.c: (deepinvte_bg_root_pixmap), (_deepinvte_bg_resize_pixbuf):
	* src/deepinvtedraw.c: (_deepinvte_draw_new):
	* src/deepinvtepango.c: (_deepinvte_pango_set_text_font):
	* src/deepinvtepangox.c: (_deepinvte_pango_x_set_text_font):
	* src/deepinvteseq.c: (deepinvte_terminal_emit_deiconify_window),
	(deepinvte_terminal_emit_iconify_window),
	(deepinvte_terminal_emit_icon_title_changed),
	(deepinvte_terminal_emit_window_title_changed),
	(deepinvte_terminal_emit_raise_window), (deepinvte_terminal_emit_lower_window),
	(deepinvte_terminal_emit_maximize_window),
	(deepinvte_terminal_emit_refresh_window),
	(deepinvte_terminal_emit_restore_window),
	(deepinvte_terminal_emit_move_window), (deepinvte_terminal_emit_resize_window),
	(deepinvte_sequence_handler_set_title_internal),
	(deepinvte_sequence_handler_decset_internal), (deepinvte_sequence_handler_bt),
	(deepinvte_sequence_handler_application_keypad),
	(deepinvte_sequence_handler_normal_keypad),
	(deepinvte_sequence_handler_window_manipulation):
	* src/deepinvtetc.c: (main):
	* src/deepinvtexft.c: (_deepinvte_xft_set_text_font):
		s/fprintf(stderr,/g_printerr(/

2007-01-17  Chris Wilson  <chris@chris-wilson.co.uk>

	Only invalidate groups of inserted chars and not the whole bbox.
	This speeds up applications like vim which maintain a status line
	at the bottom of the screen. Fixes bug 161342.

	* src/deepinvte-private.h:
	* src/deepinvte.c: (update_regions), (_deepinvte_invalidate_cells),
	(_deepinvte_invalidate_all), (_deepinvte_terminal_scroll_region),
	(deepinvte_terminal_process_incoming), (reset_update_regions),
	(remove_update_timeout), (update_repeat_timeout), (update_timeout):

2007-01-15  Behdad Esfahbod  <behdad@gnome.org>

	Bug 387171 – deepinvte fails to install on FreeBSD due to missing header
	Patch from Roy Marples

	* src/deepinvteseq.c: #include <limits.h>

2007-01-15  Behdad Esfahbod  <behdad@gnome.org>

	Bug 396831 – Unable to compile without X
	Patch from Chris Wilson

	* src/deepinvtebg.c (_deepinvte_bg_display_sync), (deepinvte_bg_root_pixmap): Add stubs.

2007-01-09  Ryan Lortie  <desrt@desrt.ca>

	Bug 394890 – Segfault when running deepinvte or gnome-terminal

	* src/deepinvtetc.c (_deepinvte_termcap_find_string): change 'int' to 'gssize' to
	match previous fixup.  Hopefully that does it. :)

2007-01-08  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.15.1.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.15.1.

	* src/Makefile.am: Bumped libtool version to 10:8:1.

2006-12-29  Ryan Lortie  <desrt@desrt.ca>

	Small fix to the previous patch.

	* src/deepinvtetc.c (_deepinvte_termcap_find_string_length): 'int' is not the same
	as 'gssize' on 64bit platforms, causing compile errors.

2006-12-27  Ryan Lortie  <desrt@desrt.ca>

	Bug 354061 – Excessive use of strlen by _deepinvte_termcap_create

	* src/deepinvtetc.c: near-complete rewrite to use a GMappedFile rather than
	reading a line at a time with excessive strlen/realloc use.

	* str/matcher.c: this shouldn't be calling the strip code as the
	strings it has are already unescaped.

2006-12-27  Ryan Lortie  <desrt@desrt.ca>

	Bug 387475 – Gtk-Warning spew in gnome-terminal

	Problem introduced by fix to bug 356552.

	* src/deepinvte.c (deepinvte_invalidate_cursor_periodic): Add a temporary backward
	compatibility hack to prevent GObject from spewing warnings about
	missing GtkSettings properties in old GTK versions.

2006-12-20  Behdad Esfahbod  <behdad@gnome.org>

	Bug 387482 – Variable modified in signal handler should be volatile
	Patch from Bastien Nocera

	* gnome-pty-helper/gnome-pty-helper.c: Make variable "done" volatile.

2006-12-08  Behdad Esfahbod  <behdad@gnome.org>

	Red Hat Bug 218626: "last -ad" print junk in last column

	* gnome-pty-helper/gnome-utmp.c (write_logout_record),
	(write_login_record): Don't gettimeofday directly into ut.ut_tv.
	That overruns on x86_64.

2006-12-05  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.15.0.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.15.0.

	* src/Makefile.am: Bumped libtool version to 10:7:1.

2006-12-05  Ryan Lortie  <desrt@desrt.ca>

	Bug 356552 – cursor timeout runs all the time

	* src/deepinvte-private.h: Rework how cursor blinking works.
	* src/deepinvte.c: Rework how cursor blinking works.  Only register the
	cursor blink callback when cursor blink is enabled and the window
	is focused.

2006-11-16 Mariano Suárez-Alvarez <mariano@gnome.org>

	Bug 307396 – Mouse scroll mode not controllable

	* src/deepinvte.c(deepinvte_terminal_scroll): make the scrollwheel scroll by tenths of
	a screen (or 1 line, whichever is bigger) instead of half screens.

2006-11-16 Mariano Suárez-Alvarez <mariano@gnome.org>

	Bug 356602 – const cast warning fixes for libdeepinvte
	Patch by Ryan Lortie (desrt)

	* src/matcher.h: Use const char * where appropriate.
	* src/matcher.c: Use const char * where appropriate.  Cast g_strdup
	to (GCacheDupFunc) to avoid a warning.
	* src/deepinvtetc.h: Use const char * where appropriate.
	* src/deepinvtetc.c: Use const char * where appropriate.  Cast g_strdup
	to (GCacheDupFunc) to avoid a warning.
	* src/deepinvte.c: Use const char * where appropriate.

2006-11-01 Rich Burridge <rich.burridge@sun.com>

	* src/deepinvteaccess.c:
	Fixed bug #150858 - In gnome-terminal, the deleted character 
	is reported as "space".

2006-10-13  Behdad Esfahbod  <behdad@gnome.org>

	* po/POTFILES.in: Include deepinvteseq.c

2006-10-11  Mariano Suárez-Alvarez  <msuarezalvarez@arnet.com.ar>

	Bug 337252 – ALT + Arrow keys don't work in irssi through gnome-terminal

	* src/keymap.c (_deepinvte_keymap_key_add_key_modifiers): Match the (newer)
	xterm behavior when reporting modifiers to things running in a terminal.

2006-10-02  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.14.1.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.14.1.

	* src/Makefile.am: Bumped libtool version to 10:6:1.

2006-10-02  Behdad Esfahbod  <behdad@gnome.org>

	Bug 358344 – autoscroll only works one way in fullscreen [PATCH]
	Patch by Egmont Koblinger

	* src/deepinvte.c (deepinvte_terminal_autoscroll),
	(deepinvte_terminal_motion_notify): Fix forward autoscrolling in fullscreen
	mode.

2006-09-20  Behdad Esfahbod  <behdad@gnome.org>

	Bug 353756 – font setting cleanup

	* src/deepinvte.c (deepinvte_terminal_set_font_full): Use 'monospace' family if no
	font is set on a terminal widget

	* src/deepinvte.c (deepinvte_terminal_set_font_from_string_full): Don't
	g_return_if_fail(strlen(name) > 0).  An empty string is a perfectly
	valid pango font description string.

	* src/deepinvte.c (deepinvte_terminal_show): Make sure we have a font loaded.

	* src/deepinvteapp.c (main): Don't fallback on "Monospace 12".  Let the
	widget decide what font to use if no font is set.

2006-09-18  Ryan Lortie  <desrt@desrt.ca>

	Bug 356616 – libdeepinvte broken with new autotools

	* configure.in:
	* src/Makefile.am: Fix broken variable substitution for newer
	versions of automake.

2006-09-13  Behdad Esfahbod  <behdad@gnome.org>

	Bug 354024 – Suppress multiple warnings for missing control sequence
	handlers
	Patch from Chris Wilson

	* src/deepinvte.c (deepinvte_terminal_handle_sequence): Suppress multiple warnings
	for missing control sequence handlers in non-debugging builds.

2006-09-13  Behdad Esfahbod  <behdad@gnome.org>

	Bug 354620 – deepinvte-0.14.0: undefined C code
	Patch from Ales Nosek

	* src/ssfe.c (inschar), (dokbdchar): Replace "*(tmp+1)=(*tmp--);"
	with something well-defined.

2006-09-08  Behdad Esfahbod  <behdad@gnome.org>

	* src/Makefile.am: Define G_LOG_DOMAIN=Deepinvte.

2006-09-04  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.14.0.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.14.0.

	* src/Makefile.am: Bumped libtool version to 10:5:1.

2006-08-31  Behdad Esfahbod  <behdad@gnome.org>

	Bug 340631 – Printed lines containing tab characters are not wrapped 
	correctly

	* src/deepinvteseq.c (deepinvte_sequence_handler_ta): make sure we don't move the 
	cursor back when tabbing past the end of the line.

	* src/pty.c:
	* src/ring.c:
	* src/trie.c:
	* src/deepinvte.c:
	* src/deepinvtebg.c:
	* src/deepinvtetc.c:
	Minor doc syntax update.

2006-08-26  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_get_text_range_maybe_wrapped): Followup on
	the fix for bug 350236.  It was causing empty lines not to be copied.

2006-08-24  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.13.7.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.13.7.

	* src/Makefile.am: Bumped libtool version to 10:4:1.

2006-08-24  Behdad Esfahbod  <behdad@gnome.org>

	Bug 352365 – font caching problem for not-found glyphs

	* src/deepinvtexft.c (_deepinvte_xft_font_for_char): Add caching on a missing
	path.  This only affects the second time a character is looked up.

	* src/deepinvtexft.c (_deepinvte_xft_font_close), (_deepinvte_xft_font_for_char),
	(_deepinvte_xft_char_width): Remove g_assert()'s that are not needed, as
	we will definitely crash pretty soon if the assertion is not true
	anyway.

2006-08-24  Behdad Esfahbod  <behdad@gnome.org>

	Bug 350236 – Cannot copy text containing invalid character sequences

	* src/deepinvte.c (deepinvte_terminal_get_text_range_maybe_wrapped): Fix another
	bug in my rewritten selection code, that was assuming that
	last_nonempty character is one byte long.

2006-08-24  Behdad Esfahbod  <behdad@gnome.org>

	Bug 352439 – URL highlighting seriously broken

	* src/deepinvte.c (deepinvte_terminal_get_text_range_maybe_wrapped): Followup to
	changes made for bug 350623.  Put back the g_array_set_size(), in the
	correct place this time.

2006-08-22  Behdad Esfahbod  <behdad@gnome.org>

	Bug 351494 – Gnome-terminal doesn't kills bash on tab close
	Patch from Aivars Kalvans

	* src/deepinvte.c (deepinvte_terminal_unrealize): Undo the change from bug 348814.
	Dispose draw in unrealize again, but also set has_fonts to FALSE.

2006-08-20  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.13.6.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.13.6.

	* src/Makefile.am: Bumped libtool version to 10:3:1.

2006-08-17  Behdad Esfahbod  <behdad@gnome.org>

	Bug 351696 – crash on Terminal

	* src/deepinvteseq.c (deepinvte_sequence_handler_set_title_internal): Check
	->window is not NULL before setting icon/window title.

2006-08-16  Willie Walker <william.walker@sun.com>

	Bug 350623 – Accessible text getTextAtOffset is broken

	* src/deepinvte.c (deepinvte_terminal_get_text_range_maybe_wrapped): Do not
	resize array before calling deepinvte_g_array_fill since it
	nullifies any effect deepinvte_g_array_fill will have.

2006-08-16  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_get_text_range_maybe_wrapped): Make sure
	attr.column is initialized.

2006-07-31  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.13.5.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.13.5.

	* src/Makefile.am: Bumped libtool version to 10:2:1.

2006-07-30  Behdad Esfahbod  <behdad@gnome.org>

	Bug 158200 – terminal backspace behavior not set to UTF-8 mode
	Based on patch from Egmont Koblinger

	* src/deepinvte.c (_deepinvte_terminal_setup_utf8),
	(deepinvte_terminal_set_encoding), (_deepinvte_terminal_fork_basic),
	(deepinvte_terminal_set_pty): Make sure UTF-8 state is correctly set
	when pty changes.

2006-07-27  Behdad Esfahbod  <behdad@gnome.org>

	Bug 348814 – crash on Terminal
	Patch from Aivars Kalvans

	* src/deepinvte.c (deepinvte_terminal_unrealize): Do not dispose draw in
	unrealize.

2006-07-24  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.13.4.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.13.4.

	* src/Makefile.am: Bumped libtool version to 10:1:1.

2006-07-24  Behdad Esfahbod  <behdad@gnome.org>

	Bug 336947 – [patch] Redundant deepinvte_terminal_set_font_full() calls
	Patch from Aivars Kalvans

	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_terminal_set_font_full), (deepinvte_terminal_init),
	(deepinvte_terminal_realize):
	AVoid redundant set_font_full and invalidate_all calls.

2006-07-19  Behdad Esfahbod  <behdad@gnome.org>

	Bug 134800 – gnome-termnal hung up when input by ATOK
	Patch from Yukihiro Nakai  <nakai@gnome.gr.jp>

	* src/deepinvte.c (deepinvte_terminal_unrealize): Delay _deepinvte_draw_free().

2006-07-19  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_extend_selection):  Oops.  Fix selection
	that I broke recently.

2006-07-11  Behdad Esfahbod  <behdad@gnome.org>

	Bug 339983 – gnome-pty-helper should log username
	Patch from Brian Cameron

	* gnome-pty-helper/gnome-pty-helper.c (pty_remove), (shutdown_pty),
	(pty_add), (open_ptys):
	* gnome-pty-helper/gnome-pty.h:
	* gnome-pty-helper/gnome-utmp.c (write_logout_record):
	Log username if system supports it.

2006-07-10  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.13.3.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.13.3.

	* src/Makefile.am: Bumped libtool version to 10:0:1.

2006-07-10  Behdad Esfahbod  <behdad@gnome.org>

	Bug 141985 – deepinvte does not respond to 'CSI 2 1 t' or 'CSI 2 0 t' with
	the correct window/icon title
	Patch from Mariano Suárez-Alvarez

	* src/deepinvte.c (deepinvte_terminal_realize), src/deepinvteseq.c
	* (deepinvte_sequence_handler_set_title_internal): Set window/icon titles.

2006-07-10  Behdad Esfahbod  <behdad@gnome.org>

	Bug 121904 – copy-paste of empty line
	Bug 25290 – Small UI tweak to select-by-word (only select only letter
	at a time for non-word characters)
	Bug 339986 – Patch to select localized strings exactly

	* src/deepinvte-private.h:
	* src/deepinvte.c (_deepinvte_terminal_set_default_attributes),
	(_deepinvte_terminal_insert_char), (deepinvte_terminal_is_word_char),
	(deepinvte_same_class), (deepinvte_terminal_get_text_range_maybe_wrapped),
	(deepinvte_terminal_extend_selection):
	* src/deepinvteseq.c (deepinvte_sequence_handler_screen_alignment_test):
	Fix a bunch of selection-related issues.  We now recognize explicitly
	put space at the end of lines, and copy/paste it.  The other change is
	that non-wordchar characters are not grouped together.  Also fixes the
	fallback on Unicode properties that I added two commits ago.

2006-07-10  Behdad Esfahbod  <behdad@gnome.org>

	Bug 311855 – Race in deepinvte leads to blocking of input.
	Patch from Kalle Raiskila

	* src/deepinvte-private.h:
	* src/deepinvte.c (_deepinvte_terminal_connect_pty_write),
	(_deepinvte_terminal_disconnect_pty_write), (deepinvte_terminal_init):
	Use a mutex for pty_output_source.

2006-07-10  Behdad Esfahbod  <behdad@gnome.org>

	Bug 339986 – Patch to select localized strings exactly
	Patch from Takao Fujiwara

	* src/deepinvte.c (deepinvte_terminal_is_word_char): Fall back on Unicode
	properties for non-ASCII characters or when no array is set.

2006-07-10  Behdad Esfahbod  <behdad@gnome.org>

	Bug 342396 – Ctrl-space sends " ", not NUL.

	* src/keymap.c (_deepinvte_keymap_map): Fix keymap lookup bug that I
	introduced during the char*->char[] work on 2006-04-18.

2006-07-10  Behdad Esfahbod  <behdad@gnome.org>

	Bug 345377 – real transparency
	Patch from Kristian Høgsberg <krh redhat.com>

	* doc/reference/tmpl/deepinvte.sgml:
	* doc/reference/deepinvte-sections.txt:
	* python/deepinvte.defs:
	* src/deepinvte-private.h:
	* src/deepinvte.c (deepinvte_terminal_set_opacity), (deepinvte_terminal_init),
	(deepinvte_terminal_background_update):
	* src/deepinvte.h:
	* src/deepinvteapp.c (main):
	* src/deepinvtedraw.c (_deepinvte_draw_set_background_color):
	* src/deepinvtedraw.h:
	* src/deepinvteft2.c (_deepinvte_ft2_set_background_color):
	* src/deepinvtegl.c (_deepinvte_gl_set_background_color):
	* src/deepinvtepango.c (_deepinvte_pango_set_background_color):
	* src/deepinvtepangox.c (_deepinvte_pango_x_set_background_color):
	* src/deepinvteskel.c (_deepinvte_skel_set_background_color):
	* src/deepinvtexft.c (_deepinvte_xft_create), (_deepinvte_xft_set_background_color),
	(_deepinvte_xft_clear):
	Add deepinvte_terminal_set_opacity().

2006-07-05  Behdad Esfahbod  <behdad@gnome.org>

	* src/Makefile.am: Allow _deepinvte_debug_.* into exported symbols.

2006-06-21  Behdad Esfahbod  <behdad@gnome.org>

	Bug 345514 – -no-undefined doesn't work with latest libtool

	* src/Makefile.am: Remove -no-undefined.

2006-06-12  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.13.2.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.13.2.

	* src/Makefile.am: Bumped libtool version to 9:2:0.

2006-06-12  Behdad Esfahbod  <behdad@gnome.org>

	Bug 344666 – Problems with *_CFLAGS and *_LDFLAGS in makefiles
	Patch from Stepan Kasal <kasal@ucw.cz>.

	* src/Makefile.am (AM_CFLAGS, AM_LDFLAGS, *_CFLAGS, *_LDADD):
	Replace @FOO@ references by $(FOO), remove redundant (or buggy)
	occurences of `@CFLAGS@'.
	* gnome-pty-helper/Makefile.am (AM_CFLAGS, AM_LDFLAGS): Likewise.
	* python/Makefile.am (deepinvtemodule_la_CFLAGS): Likewise.
	* src/Makefile.am (AM_CFLAGS): Add $(FT2_CFLAGS).

2006-06-08  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (remove_display_timeout): Fix typo which may have been
	causing things like crashes.  Reported by muntyan.  Also reordered
	some code around update_timeout for better matching the current
	timeouts in style.

2006-06-07  Behdad Esfahbod  <behdad@gnome.org>

	Bug 339529 – gnome-terminal (deepinvte) crashes when detatched window is
	closed

	* src/deepinvte.c (deepinvte_invalidate_region): Bail out if terminal->window is
	NULL.

2006-05-27  Behdad Esfahbod  <behdad@gnome.org>

	Bug 342549 – uninitialized var (coverity)
	Patch from Paolo Borelli.

	* src/deepinvte.c (deepinvte_cell_is_selected): Remove uninitialized var ret.

2006-05-27  Behdad Esfahbod  <behdad@gnome.org>

	Bug 342082 – deepinvte_invalidate_region() may check whether terminal is
	realiazed or not
	Patch from Kouhei Sutou.

	* src/deepinvte.c (deepinvte_invalidate_region): Return if not realized.

2006-05-22  Behdad Esfahbod  <behdad@gnome.org>

	Bug 340363 – deepinvte Cygwin build fixes
	Patch from Cygwin Ports maintainer

	* configure.in, src/keymap.c, src/pty.c, src/ssfe.c, src/trie.c,
	src/utf8echo.c, src/deepinvte.c, src/deepinvteseq.c, src/deepinvtetc.c: Check and
	include syslimits.h and ncurses/curses.h

2006-05-22  Behdad Esfahbod  <behdad@gnome.org>

	Bug 341793 – deepinvte.h doesn't need to include X11/Xlib.h
	Patch from Kouhei Sutou

	* src/deepinvte.h: Don't #include <X11/Xlib.h>

2006-05-17  Wouter Bolsterlee  <uws+gnome@xs4all.nl>

	* configure.in: Require intltool 0.35.0 to have
	translations in the dist tarballs.

2006-05-17  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.13.1.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.13.1.

	* src/Makefile.am: Bumped libtool version to 9:1:0.

2006-05-14  Behdad Esfahbod  <behdad@gnome.org>

	* NEWS, ChangeLog: Add vim and emacs footers for UTF-8.

2006-04-27  Behdad Esfahbod  <behdad@gnome.org>

	Bug 339980 – nativeecho needs glib in LDADD to build on Solaris
	Patch from Brian Cameron.

	* src/Makefile.am: Fix it.

2006-04-26  Behdad Esfahbod  <behdad@gnome.org>

	Bug 331803 – style needs to be attached/detached to the window on
	realize/unrealize
	Patch from Benjamin Berg  <benjamin@sipsolutions.net>.

	* src/deepinvte.c: (deepinvte_terminal_unrealize), (deepinvte_terminal_realize):
	attach and detach the style of the terminal widget.

2006-04-25  Behdad Esfahbod  <behdad@gnome.org>

	* src/Makefile.am: Pass -no-undefined linker flag.

2006-04-23  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.13.0.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.13.0.

	* src/Makefile.am: Bumped libtool version to 9:0:0.

2006-04-23  Behdad Esfahbod  <behdad@gnome.org>

	Bug 339448 – selection doesn't respect hard newlines

	* src/deepinvte.c (deepinvte_terminal_get_text_range_maybe_wrapped): Add newline
	to the end of each line that is not soft-wrapped.

2006-04-23  Behdad Esfahbod  <behdad@gnome.org>

	Bug 148720 – Word selection erroneously captures text from next line
	Patch from Chris Heath.

	* src/deepinvteseq.c (deepinvte_sequence_handler_cd), (deepinvte_sequence_handler_ce),
	(deepinvte_sequence_handler_clear_current_line),
	(deepinvte_sequence_handler_clear_above_current): Reset soft_wrapped flag.

2006-04-23  Behdad Esfahbod  <behdad@gnome.org>

	Bug 126376 – Uncoinditional definition of _XOPEN_SOURCE breaks build
	on NetBSD
	Patch from Dan Winship.

	* configure.in:
	* gnome-pty-helper/configure.in: Define XOPEN_SOURCE on solaris only.

2006-04-23  Behdad Esfahbod  <behdad@gnome.org>

	Bug 97719 – Selection: double/triple click doesn't cross line boundaries
	Patch from Chris Heath.

	* src/deepinvte.c (deepinvte_same_class): Fix problem with selecting whitespace
	from adjacent lines, on word selection.

2006-04-22  Behdad Esfahbod  <behdad@gnome.org>

	Bug 160782 – Deepinvte isn't multi-screen safe
	Patch from Benedikt Meurer.

	* src/deepinvte.c (deepinvte_terminal_unrealize), (deepinvte_terminal_realize):
	* src/deepinvtebg.c (deepinvte_bg_native_new), (_deepinvte_bg_display_sync),
	(deepinvte_bg_root_pixmap), (deepinvte_bg_get_for_screen), (deepinvte_bg_init),
	(deepinvte_bg_get_pixmap), (deepinvte_bg_get_pixbuf):
	* src/deepinvtebg.h:
	* src/deepinvteft2.c (_deepinvte_ft2_set_background_image):
	* src/deepinvtegl.c (_deepinvte_gl_set_background_image):
	* src/deepinvtepango.c (_deepinvte_pango_set_background_image):
	* src/deepinvtepangox.c (_deepinvte_pango_x_set_background_image):
	* src/deepinvtexft.c (_deepinvte_xft_set_background_image): Handle per-screen
	backgrounds.

2006-04-22  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_cursor_new), (deepinvte_terminal_clipboard_get):
	* src/deepinvteapp.c (take_xconsole_ownership):
	* src/deepinvtebg.c (deepinvte_bg_native_new), (_deepinvte_bg_display_sync),
	(deepinvte_bg_root_pixmap):
	* src/deepinvtedraw.c (_deepinvte_draw_get_colormap):
	* src/deepinvtefc.c (_deepinvte_fc_transcribe_from_pango_font_description),
	(_deepinvte_fc_defaults_from_gtk):
	* src/deepinvtepango.c (_deepinvte_pango_start), (_deepinvte_pango_set_text_font):
	* src/deepinvtepangox.c (_deepinvte_pango_x_set_text_font):
	* src/deepinvterdb.c (_deepinvte_rdb_get):
	* src/deepinvteseq.c (deepinvte_terminal_beep),
	(deepinvte_sequence_handler_window_manipulation):
	* src/deepinvtexft.c (_deepinvte_xft_char_exists), (_deepinvte_xft_text_extents),
	(_deepinvte_xft_font_open):
	* src/deepinvtegl.c: Remove obsolete #ifde GTK_CHECK_VERSION(2,2,0) checks.

2006-04-22  Behdad Esfahbod  <behdad@gnome.org>

	Bug 330441 – Remove libzvt support
	Patch from Guilherme de S. Pastore  <gpastore@gnome.org>

	* configure.in, src/Makefile.am, src/reflect.c: remove remnants
	from the old, broken, and unmaintained libzvt.

2006-04-21  Behdad Esfahbod  <behdad@gnome.org>

	Bug 328850 – Crash when pasting selection

	* src/deepinvte.c: Protect against passing NULL selection to strcmp.

2006-04-20  Behdad Esfahbod  <behdad@gnome.org>

	* doc/reference/tmpl/internals.sgml:
	* doc/reference/tmpl/reaper.sgml:
	* doc/reference/tmpl/deepinvte-unused.sgml:
	* doc/reference/tmpl/deepinvte.sgml:
	* doc/reference/tmpl/deepinvteaccess.sgml:
	* doc/reference/deepinvte-sections.txt: Misc fixes and updates.

	* python/deepinvte.defs:
	* python/deepinvte.override: Updates.

	Bug 160134 – mouse events occurring past column 95 are not passed
	through to terminal application
	Based on patch from Sean Estabrooks.

	* src/deepinvte.h:
	* src/deepinvte.c (deepinvte_terminal_feed_child_binary): New public function.

	* src/deepinvte.c (deepinvte_terminal_send_mouse_button_internal),
	(deepinvte_terminal_maybe_send_mouse_drag): Use feed_child_binary.

2006-04-19  Behdad Esfahbod  <behdad@gnome.org>

	Bug 135230 – Feature request to attach DEEPINVTE to existing pty
	Based on patch from eric@brouhaha.com, John Swensen, and
	Chris Moller  <cmoller@redhat.com>

	* src/deepinvte.c:
	* src/deepinvte.h:
	* python/deepinvte.defs:
	* doc/reference/deepinvte-sections.txt: Added deepinvte_terminal_set_pty().

2006-04-18  Behdad Esfahbod  <behdad@gnome.org>

	Bug 337442 – [patch] Reduce .plt section

	* src/Makefile.am: Pass export-symbols-regex to libtool.

2006-04-18  Behdad Esfahbod  <behdad@gnome.org>

	* src/caps.c (_deepinvte_capability_init), src/caps.h:
	* src/keymap.c (_deepinvte_keymap_map), src/keymap.h: Make some data
	structures const by changing char * to char [].

	* src/deepinvte.c (deepinvte_update_delay_timeout), (deepinvte_update_timeout),
	(deepinvte_terminal_extend_selection), (_deepinvte_terminal_fudge_pango_colors):
	Fix warnings and adapt to above changes.

2006-04-18  Behdad Esfahbod  <behdad@gnome.org>

	* configure.in, po/LINGUAS: Use intltool 0.34.90 format.

2006-04-12  Behdad Esfahbod  <behdad@gnome.org>

	Bug 142247 – use of uninitialized value

	* src/pty.c: Initialize the arbitrary byte that we send on the pipe
	to zero.

2006-04-12  Behdad Esfahbod  <behdad@gnome.org>

	Bug 149633 – gnome-terminal messes up boxdrawing chars aligment

	* src/deepinvte.c: Try to use the font first for all graphic characters.
	This results in better looking graphics with modern fonts.

2006-04-12  Behdad Esfahbod  <behdad@gnome.org>

	Bug 144456 – UK pound currency symbol rendered incorrectly

	* src/deepinvte.c: Offset characters drawn in draw_graphic for padding.

2006-04-12  Behdad Esfahbod  <behdad@gnome.org>

	Bug 307403 – xticker doublefree

	* src/xticker.c: Avoid double free.

2006-04-10  Behdad Esfahbod  <behdad@gnome.org>

	Bug 337877 – Patch to use po/LINGUAS
	Patch from Michiel Sikkes.

	* configure.in, po/LINGUAS: Move list of translations to po/LINGUAS.

2006-04-06  Behdad Esfahbod  <behdad@gnome.org>

	Bug 337552 – Insufficient version requirement for gtk+

	* configure.in: Depend on Gtk+ 2.6.

2006-03-30  Behdad Esfahbod  <behdad@gnome.org>

	Bug 168251 – add support for 256 colors terminals
	Patch from dann@godzilla.ics.uci.edu.

	* src/deepinvte-private.h, src/deepinvte.c, src/deepinvteseq.c: Implement support
	for 256 colors.

2006-03-30  Behdad Esfahbod  <behdad@gnome.org>

	Bug 120276 – Wishlist: Support Rectangular Selection
	Patch from Pedro de Medeiros.

	* src/deepinvte.c, src/deepinvte-private.h: Implement block (rectangular)
	selection using ctrl+mouse.

2006-03-30  Behdad Esfahbod  <behdad@gnome.org>

	Bug 336117 – [patch] Use g_slice API
	Patch from Aivars Kalvans.

	* src/*.c: Use g_slice instead of g_malloc for structs.
	Also, replace g_string_new("") with g_string_new(NULL).

2006-03-30  Behdad Esfahbod  <behdad@gnome.org>

	Branchpoint for deepinvte-0-12.

2006-03-30  Guntupalli Karunakar  <karunakar@indlinux.org>

	* configure.in: Added "dz" (Dzongkha) to ALL_LINGUAS.

2006-03-26  Behdad Esfahbod  <behdad@gnome.org>

	Bug 336128 – vim scrolling issues - emulation errors

	* src/deepinvteseq.c (deepinvte_sequence_handler_sf): Update start and end
	when updating insert_delta.

2006-03-15  Behdad Esfahbod  <behdad@gnome.org>

	Bug 334385 – Use intltool

	* Makefile.am, configure.in: Add intltool support.

	* src/iso2022.c, src/reaper.c, src/deepinvteaccess.c, src/deepinvteapp.c,
	src/deepinvtebg.c, src/deepinvtexft.c, src/deepinvte.c: Include glib/gi18n-lib.h
	instead of #ifdefing gettext stuff.

	* src/deepinvte.c (deepinvte_terminal_class_init): Use GETTEXT_PACKAGE instead
	of PACKAGE in bindgettextdomain.

2006-03-14  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_size_allocate): More tweaks to the
	previous changes.  Reported by dholbach again.

2006-03-13  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_size_allocate): Put the stuff changed in
	previous commit in their original order.  Problem reported by
	dholbach.

2006-03-13  Behdad Esfahbod  <behdad@gnome.org>

	Bug 104841 – scrolling doesn't work inside "screen" windows

	* src/deepinvte.c (deepinvte_terminal_size_allocate): Fix restricted scrolling
	region readjustment.  Moreover, do not do unnecessary updates when
	number of rows & columns has not changed.

2006-03-13  Behdad Esfahbod  <behdad@gnome.org>

	Bug 333768 – deepinvteapp debug stuff should be conditional
	Patch from Egmont Koblinger.

	* src/deepinvteapp.c: Make pwd and setting env vars conditional on debug.

2006-03-08  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.12.0.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.12.0.

2006-03-09  Abel Cheung  <maddog@linuxhall.org>

	* configure.in: Readd kn to ALL_LINGUAS and make sure everything
	builds fine.

2006-03-08  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.11.21.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.11.21.

	* configure.in: Removed kn from ALL_LINGUAS, as it was breaking
	the build.

2006-03-08  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c, src/deepinvte-private.h: Fix deepinvte_update_timeout repeat to
	25ms. (bug #333776, Egmont Koblinger)

2006-03-07  Abel Cheung  <maddog@linuxhall.org>

	* configure.in: Added "kn" "zh_HK" to ALL_LINGUAS.

2006-02-28  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte-private.h: Step up COALESCE_TIMEOUT and DISPLAY_TIMEOUT
	from 2ms to 10ms.  This is more compatible with the updated timeout
	that we are doing at around 25ms.

2006-02-27  Behdad Esfahbod  <behdad@gnome.org>

	* MAINTAINERS: Added.

2006-02-25  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.11.20.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.11.20.

2006-02-25  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvtexft.c: (_deepinvte_xft_font_for_char): Rever the patch to
	optimize memory usage by releasing fonts that aren't needed early.
	Because that was inserting destroyed fonts into cache. Closes bug
	#332580 and reverts bug #309322.

2006-02-25  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.11.19.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.11.19.

2006-02-17  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c: Make shift+insert paste PRIMARY and ctrl+shift+insert
	paste CLIPBOARD (switched them. bug #123844)

2006-02-17  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c: Better update-timeout handling.  Always delay updates
	a bit.  Schedule updates as G_PRIORITY_DEFAULT_IDLE.  And, set delay
	as the number of lines, in milliseconds.

2006-02-14  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq-gen.c (main): Return 0.  (bug #331178)

2006-02-14  Behdad Esfahbod  <behdad@gnome.org>

	* gnome-pty-helper/gnome-pty-helper.c (main): Use getpwnam to
	correctly log multiple users with the same UID. (bug #319564,
	patch from Laszlo (Laca) Peter.

2006-02-13  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (update_timeout): Only discontinue timer if nothing
	was updated in the last cycle.

2006-02-13  Behdad Esfahbod  <behdad@gnome.org>

	* gnome-pty-helper/gnome-pty-helper.c: Fix race condition when
	shutdown_helper may be called again from the signal handler when
	it's already running. (bug #331056)

2006-02-13  Behdad Esfahbod  <behdad@gnome.org>

	* configure.in: Do not prepend X_LIBS and X_CFLAGS to LIBS and
	CFLAGS. (bug #331021, Sylvain BERTRAND)

2006-02-13  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (deepinvte_terminal_key_press): Handle Ctrl+Shift+Insert to
	paste PRIMARY.

2006-02-11  Behdad Esfahbod  <behdad@gnome.org>

	Released deepinvte-0.11.18.

	* NEWS: Updated.

	* configure.in: Bumped version to 0.11.18.

2006-02-11  Behdad Esfahbod  <behdad@gnome.org>

	* src/iso2022.c: Change INVALID_CODEPOINT from 0xFFFF to 0xFFFD.
	(bug #317235, Egmont Koblinger)

2006-02-11  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (_deepinvte_invalidate_cells): Guard more against off values.

2006-02-10  Behdad Esfahbod  <behdad@gnome.org>

	Update the build infrastructure.  make distcheck works now!

	* autogen.sh: Use a generic autogen.sh that uses gnome-common.

	* configure.in: Simplify gtk-doc stuff.  Update to newer syntax.

	* Makefile.am, src/Makefile.am, doc/reference/Makefile.am: Updated.

2006-02-10  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c (_deepinvte_invalidate_cells): Throttle invalidating to at most
	40 times per second, using a timeout.

2006-02-10  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteseq.c: Removed the huge sequence handler table.  Changed to
	use the compact tables in deepinvteseq-table.h.

	* src/deepinvteseq-gen.c: Generator containing the table removed from above,
	that generates compact tables.

	* src/deepinvteseq-table.h: Table generated by above.  Can be regenerated
	using make.

	* src/Makefile.am: Adjusted.

	* src/deepinvteapp.c: Set default font to Monospace instead of Sans.

2006-02-10  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c: Allocate terminal->pvt using GObject private data.

2006-02-10  Behdad Esfahbod  <behdad@gnome.org>

	Moved all sequence handler codes into a separate file.

	* src/deepinvte.c: Stuff moved to other files.

	* src/deepinvte-private.h: Includes all struct definitions from deepinvte.c.

	* src/deepinvteseq.c, src/deepinvteseq.h, src/deepinvteseq-list.h: The sequence
	handlers are all here now.

2006-02-09  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvteapp.c: Make a couple debug messages conditional on
	DEBUG_MISC.

2006-02-03  Behdad Esfahbod  <behdad@gnome.org>

	* src/deepinvte.c: Warning cleanup.  A couple were actually bugs.

	* src/deepinvteapp.c: No need to run $SHELL by default.  Handled
	by deepinvte.c now.  A bug was causing nothing to be run...

2006-02-03  Behdad Esfahbod  <behdad@gnome.org>

	* src/debug.c, src/debug.h, src/matcher.c: Add the debug
	flag TRIE for printing out the trie (previous was using
	MISC.)

	* src/deepinvte.c (deepinvte_invalidate_cells): Update row_count and
	column_count when clamping their respective _start values.

	* src/deepinvte.c (deepinvte_terminal_extend_selection, _deepinvte_terminal_select_text): 
	Pass row_count to deepinvte_invalidate_cells(), instead of row_stop.

	* src/deepinvteapp.c: Run $SHELL by default.

2006-02-01  Behdad Esfahbod  <behdad@gnome.org>

	* doc/reference/tmpl/internals.sgml: Added to CVS.

	* deepinvte/src/deepinvte.c: Fix selection vs. primary that have been
	borked forever. Closes bug #123844.

2006-01-30  Guilherme de S. Pastore  <gpastore@gnome.org>

	* src/trie.c: applied patch from Tomas Mraz to fix a double
	  free. Closes bug #161337.

2006-01-30  Erdal Ronahi  <erdal.ronahi@gmail.com>

	* configure.in: added ku (Kurdish) to ALL_LINGUAS

2006-01-28  Guilherme de S. Pastore  <gpastore@gnome.org>

	* src/Makefile.am: add -DG_DISABLE_ASSERT to CFLAGS.

	* NEWS: updated.

	* deepinvte.spec: bumped version to 0.11.17.

2006-01-28  Guilherme de S. Pastore  <gpastore@gnome.org>

	* src/deepinvte.c: only try to guess the user's shell when actually
	  forking, so we avoid unnecessary work if the application
	  already has to do that itself.
	
2006-01-15  Guilherme de S. Pastore  <gpastore@gnome.org>

	* src/: applied patch from Kjartan Maraas that replaces g_return
	  functions with g_assert. Should give an 8% speed boost.

2006-01-14  Guilherme de S. Pastore  <gpastore@gnome.org>

	* doc/reference/Makefile.am: install more than *.html, based on the
	  patch from Ed Catmur. Closes bug #321909.

2006-01-14  Olav Vitters  <olav@bkor.dhs.org>

	* src/caps.c: Support save and restore cursor position using \033[s
	and \033[u. Reported by Dag Wieers. Fixes bug 170032.

2005-12-31  Olav Vitters  <olav@bkor.dhs.org>

	* deepinvte.pc.in: Backup patch from Steve Langasek. It needs pkg-config
	changes.

2005-12-12  Kjartan Maraas  <kmaraas@gnome.org>

	* deepinvte.pc.in: Cleanups for the pkg-config file.
	Patch from Steve Langasek. Closes bug #322240.

2005-12-12  Kjartan Maraas  <kmaraas@gnome.org>

	* python/deepinvte.override: python-deepinvte seems to have a small bug in
	the override file that prevents the forkpty() method to be generated.
	The attached patch fixes this problem. Patch from Michael Vogt.
	Closes bug #169201.

2005-11-30  Kjartan Maraas  <kmaraas@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_preedit_length): Remove some
	unused code.
	(deepinvte_terminal_process_incoming): Don't emit signals for every
	character that's output. Patch from Padraig O'Briain. Huge
	performance gain when a11y is activated.

2005-11-16  Timur Jamakeev  <timurj@cvs.gnome.org>

	* confgiure.in: Added 'ky' to ALL_LINGUAS

2005-11-08  Kjartan Maraas  <kmaraas@gnome.org>

	* NEWS: Update.
	* Makefile.am:
	* autogen.sh:
	* configure.in:
	* python/Makefile.am:
	I'm attaching a patch that modernizes the python binding 
	build stuff. Notably, it excludes python/deepinvte.c from the dist.
	Right now as it stands, the file is disted, which means people's 
	builds will not work unless they build against pygtk 2.8, 
	which makes this bug somewhat important. Patch from Manish Sing
	Closes bug #320931.

2005-11-01  Bill Haneman <billh@gnome.org>

	* src/deepinvteaccess.c: 
	(deepinvte_terminal_accessible_get_text):
	Swap offsets if start > end; fixes crasher
	bug #153405.  Patch from padraig o'briain,
	thanks to Kjartan for review.

2005-10-02  Kjartan Maraas  <kmaraas@gnome.org>

	* src/deepinvtebg.c: (_deepinvte_property_get_pixmaps):
	* src/deepinvterdb.c: (_deepinvte_property_get_string):
	Fix gdk warnings. Patch from Michele Baldessari.
	Closes bug #309025.

2005-09-16  Kjartan Maraas  <kmaraas@gnome.org>

	* src/deepinvtexft.c: (_deepinvte_xft_font_for_char): Optimize memory
	usage by releasing fonts that aren't needed early. Patch
	from Mike Hearn. Closes bug #309322.

2005-08-13  Kjartan Maraas  <kmaraas@gnome.org>

	* gnome-pty-helper/gnome-pty-helper.c: (init_msg_pass):
	Make DEEPINVTE work on NetBSD, OpenBSD (sparc and macppc).
	Reported by Adrian Bunk, patches by Dan Winship and
	Rich Edelman. Closes bug #126554.

2005-08-12  Kjartan Maraas  <kmaraas@gnome.org>

	* src/deepinvtetc.c: (_deepinvte_termcap_destroy): Don't crash
	if there's no termcap file. Michele Baldessari
	Closes bug #312260.

2005-08-12  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.in: Correct test for recvmsg(). Patch from
	Robert Basch. Closes bug #304815 and possibly bug #122055.

2004-08-10  Kjartan Maraas  <kmaraas@gnome.org>

	Patch from: Padraig O'Briain  <padraig.obriain@sun.com>
	Closes bug #113590.

	* src/deepinvte.c, src/deepinvteint.h:
	Add new functions to support accessible text selection:
	_deepinvte_terminal_get_selection, _deepinvte_terminal_get_start_selection,
	_deepinvte_terminal_get_end_selection, _deepinvte_terminal_select_text,
	_deepinvte_terminal_remove_selection
	* src/deepinvteaccess.c:
	(xy_from_offset): Fix for offset being entire text.
	(deepinvte_terminal_accessibility_selection_changed): DeepinvteTerminal's
	selection-changed signal handler which emits text-selection-changed
	signal.
	(deepinvte_terminal_accessible_initialize): Connect to DeepinvteTerminal's
	selection-changed signal.
	(deepinvte_terminal_accessible_get_n_selections) Add implementation.
	(deepinvte_terminal_accessible_get_selection) Add implementation.
	(deepinvte_terminal_accessible_add_selection) Add implementation.
	(deepinvte_terminal_accessible_remove_selection) Add implementation.
	(deepinvte_terminal_accessible_set_selection) Add implementation.

2005-08-05  Kjartan Maraas  <kmaraas@gnome.org>

	* gnome-pty-helper/gnome-pty-helper.c: (exit_handler), (main):
	Clean up utmp/wtmp under vncserver if things fall apart under
	the terminal. (Dave Lehman). Closes bug #312373

2005-07-26  Michele Baldessari  <michele@pupazzo.org>

	* python/deepinvte.override (_wrap_deepinvte_terminal_set_colors): 
	pyg_boxed_get should be on item not py_palette. 
	Reported with fix by Ethan Glasser-Camp <glasse@rpi.edu>
	Closes bug #311570

2005-07-25  Michele Baldessari  <michele@pupazzo.org>

	* src/deepinvtepango.c (_deepinvte_pango_create): Initialize 
	PangoContext * data->ctx with NULL. Closes bug #126262

2005-07-21  Danilo Šegan  <danilo@gnome.org>

	Fixes #149925.
	
	* src/deepinvte.c (deepinvte_terminal_io_read): Added simple comment for 
	translators.

2005-07-07  Matthias Clasen  <mclasen@redhat.com>

	* src/deepinvte.c (deepinvte_terminal_unrealize): Unset the user data
	on the gdk window. 

2005-06-15  Theppitak Karoonboonyanan  <thep@linux.thai.net>

	* configure.in: Added 'th' (Thai) to ALL_LINGUAS.

2005-06-11  Kjartan Maraas  <kmaraas@gnome.org>

	* NEWS: Update some.
	* doc/reference/tmpl/reaper.sgml:
	* doc/reference/tmpl/deepinvte-unused.sgml:
	* doc/reference/tmpl/deepinvte.sgml:
	* doc/reference/tmpl/deepinvteaccess.sgml: Docs updates.
	* src/deepinvte.c: (deepinvte_terminal_init), (deepinvte_terminal_finalize),
	(deepinvte_terminal_get_accessible), (deepinvte_terminal_class_init):
	Apply patch from Padraig O'Briain <padraig.obriain@sun.com>
	to fix a crash. Closes bug #119913.

2005-06-09  Kjartan Maraas  <kmaraas@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_style_changed):
	Fix a crash when reparenting. Closes bug #169326.
	Patch from Michele Baldessari.

2005-06-05  Ignacio Casal Quinteiro  <nacho.resa@gmail.com>

	* configure.in: Added 'gl' to ALL_LINGUAS.

2005-04-29  Kjartan Maraas  <kmaraas@gnome.org>

	* src/table.c: (_deepinvte_table_literal_new), (_deepinvte_table_free),
	(_deepinvte_table_addi), (_deepinvte_table_matchi), (_deepinvte_table_match),
	(_deepinvte_table_printi): Final bits of the memory reduction patch
	from Aivars Kalvans. bug #160993 comment #9
	* src/deepinvte.c: (deepinvte_terminal_scroll_region): Patch from Egmont
	Koblinger to fix some scrolling issues. bug #164153
	* deepinvte.spec: Bump version.

2005-04-07  Abduxukur Abdurixit  <abduxukur.abdurixit@t-systems.ch>

	* configure.in: Added "ug" to ALL_LINGUAS.

2005-04-01  Adi Attar  <aattar@cvs.gnome.org>

	* configure.in: Added "xh" to ALL_LINGUAS.

2005-03-31  Steve Murphy  <murf@e-tools.com>

        * configure.in: Added "rw" to ALL_LINGUAS.

2005-03-29  Kjartan Maraas  <kmaraas@gnome.org>

	* autogen.sh: Use head -n 1 instead of head -1 to avoid
	warning about the latter being deprecated in newer versions.
	Reported by Ali Akcaagac. Closes bug #156022.
	* deepinvte.spec: Bump version

2005-03-16  Manish Singh  <yosh@gimp.org>

	* python/deepinvtemodule.c: Remove stray underscores so python module
	works again. Fixes bug #150760.

2005-03-14  Kjartan Maraas  <kmaraas@gnome.org>

	* src/Makefile.am: 
	* src/interpret.c: (main):
	* src/matcher.c: (_deepinvte_matcher_add), (_deepinvte_matcher_init),
	(_deepinvte_matcher_create), (_deepinvte_matcher_destroy), (_deepinvte_matcher_new),
	(_deepinvte_matcher_free):
	* src/matcher.h:
	* src/deepinvte.c: (deepinvte_terminal_set_emulation), (deepinvte_terminal_init):
	* src/deepinvtetc.c: (_deepinvte_termcap_create), (_deepinvte_termcap_destroy),
	(_deepinvte_termcap_new), (_deepinvte_termcap_free):
	* src/deepinvtetc.h: Add patch for excessive memory consumption when
	opening new tabs. This patch makes struct _deepinvte_matcher and
	struct _deepinvte_termcap shared between terminals and should reduce
	memory consumption with multiple tabs a lot. Patch from Aivars
	Kalvans <kalvans at inbox lv>. From bug #160993.

2005-03-14  Kjartan Maraas  <kmaraas@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_scroll_region),
	(deepinvte_sequence_handler_al), (deepinvte_sequence_handler_dl),
	(deepinvte_sequence_handler_sr), (deepinvte_sequence_handler_insert_lines),
	(deepinvte_sequence_handler_delete_lines), (deepinvte_terminal_handle_scroll):
	Back out one of the fedora patches since it apparently causes
	screen corruption for some users. It was rumored to have issues
	from the start, so...

2005-03-02  Kjartan Maraas  <kmaraas@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_process_incoming): Fix the
	crash in minicom when resizing the window. Closes
	bug #163814. Also adjust the coalesce and display timeouts.
	This makes g-t and xterm behave just about the same visually
	but g-t is still a bit faster when using the same font and
	utf8.

2005-03-02  Kjartan Maraas  <kmaraas@gnome.org>

	* src/Makefile.am: Add deepinvtetree.[ch]
	* src/deepinvte.c: (deepinvte_terminal_draw_row): Don't use a GArray
	but use calloc'ed memory to speed up things further.
	From bug #137864. Patch from Benjamin Otte.
	* src/deepinvtetree.c: (_deepinvte_tree_new), (_deepinvte_tree_destroy),
	(_deepinvte_tree_insert), (_deepinvte_tree_lookup): New file
	* src/deepinvtetree.h: New file
	* src/deepinvtexft.c: (_deepinvte_xft_font_open), (_deepinvte_xft_font_close),
	(_deepinvte_xft_font_for_char), (_deepinvte_xft_char_width): Use the new
	functions to speed up things. From bug #137864. Patch from
	Benjamin Otte. There are still two patches in there that don't
	apply cleanly any more. Will look at those later.
	* deepinvte.spec: Bump version.

2005-02-28  Kjartan Maraas  <kmaraas@gnome.org>

	* src/deepinvte.c: (deepinvte_sequence_handler_send_primary_device_attributes):
	Patch from Mariano to make deepinvte claim to be the right type terminal.
	Closes bug #130671.

2005-02-28  Kjartan Maraas  <kmaraas@gnome.org>

	* src/iso2022.c: (_deepinvte_iso2022_is_ambiguous),
	(_deepinvte_iso2022_find_nextctl):
	* src/uniwidths:
	* src/deepinvte.c: (deepinvte_terminal_catch_child_exited), (deepinvte_terminal_eof),
	(deepinvte_terminal_process_incoming), (deepinvte_terminal_feed),
	(deepinvte_terminal_init), (deepinvte_terminal_finalize), (deepinvte_terminal_reset),
	(add_display_timeout), (add_coalesce_timeout),
	(remove_display_timeout), (remove_coalesce_timeout),
	(deepinvte_terminal_stop_processing), (deepinvte_terminal_start_processing),
	(deepinvte_terminal_is_processing), (display_timeout),
	(coalesce_timeout):
	* src/deepinvtexft.c: (_deepinvte_xft_drawcharfontspec), (_deepinvte_xft_draw_text):
	Apply fix from Fedora package for performance problems. Closes
	bug #143914. Patch was written by Søren Sandmann.

2005-02-28  Kjartan Maraas  <kmaraas@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_scroll_region): Fix for
	problem with redrawing when scrolling back then forward
	Closes bug #122150. Patch from Benjamin Otte.

2005-02-28  Kjartan Maraas  <kmaraas@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_unrealize): Fix a crash
	when trying to use input methods. From Fedora.
	Closes bug #168213.

2005-02-28  Kjartan Maraas  <kmaraas@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_scroll_region),
	(deepinvte_sequence_handler_al), (deepinvte_sequence_handler_dl),
	(deepinvte_sequence_handler_sr), (deepinvte_sequence_handler_insert_lines),
	(deepinvte_sequence_handler_delete_lines), (deepinvte_terminal_handle_scroll):
	Another patch from fedora. Make sure the screen is fully redrawn
	before scrolling. Apparently this patch has some issues, but those
	were found to be small enough to apply in Fedora, so I guess
	the same holds true here. Closes bug #168212

2005-02-28  Kjartan Maraas  <kmaraas@gnome.org>

	* src/iso2022.c: (_deepinvte_iso2022_process): Apply another
	patch from Fedora. This should fix some screen corruption
	with multibyte charsets. Closes bug #168211 and possibly
	others.

2005-02-28  Kjartan Maraas  <kmaraas@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_adjust_adjustments),
	(deepinvte_terminal_maybe_scroll_to_bottom),
	(deepinvte_terminal_update_insert_delta), (deepinvte_terminal_handle_scroll),
	(deepinvte_terminal_set_scroll_adjustment), (deepinvte_terminal_size_allocate):
	Apply patch from Fedora to fix some scrolling issues. Closes
	bug #168210 and possibly others.

2005-02-15  Kjartan Maraas  <kmaraas@gnome.org>

	* src/deepinvte.c: (deepinvte_terminal_visibility_notify): Fix black
	backgrounds in new terminals. Fix from Jon Nettleton
	<nettleton at gmail com>. Closes bug #125364. Has been
	in Fedora Core for months already.

2005-02-15  Kjartan Maraas  <kmaraas@gnome.org>

	* src/keymap.c: (_deepinvte_keymap_map): Fix keypad behaviour
	to be like xterm. Closes bug #128099. Fix is from
	<jylefort at brutele be> and has been used in Fedora the last
	three months at least.

2005-02-15  Kjartan Maraas  <kmaraas@gnome.org>

	* src/deepinvteregex.h: Don't include <config.h> here. It breaks
	building on AIX and can cause problems for l10n. Closes
	bug #161352.

2005-02-15  Kjartan Maraas  <kmaraas@gnome.org>

	* src/dumpkeys.c: Fix build on NetBSD and Darwin.
	Patch from Adrian Bunk <bunk at stusta de>. Closes
	bug #126377.

2004-12-07 Rajesh Ranjan<rranjan@redhat.com>
	* configure.in: included the hi locale in ALL_LINGUAS 
2004-11-16 nalin
	* src/deepinvte.c(deepinvte_terminal_io_read,deepinvte_terminal_io_write): silence a
	couple of warnings by expecting a GIOCondition instead of a
	GtkInputCondition as a parameter.

2004-11-16 nalin
	* autogen.sh: accept more, newer versions of autoconf/automake.  Treat
	autoconf >= 3 as acceptable instead of just > 3.

2004-11-16 nalin
	* src/deepinvte.c(deepinvte_terminal_sequence_handler_scroll_up_or_down): add.
	* src/deepinvte.c(deepinvte_terminal_sequence_handler_scroll_up_once): add.
	* src/deepinvte.c(deepinvte_terminal_sequence_handler_scroll_down_once): add.
	* src/deepinvte.c(deepinvte_terminal_sequence_handler_scroll_up): add.
	* src/deepinvte.c(deepinvte_terminal_sequence_handler_scroll_down): add.
	* src/table.c(_deepinvte_table_addi): expand "%m" locally so that we can
	distinguish between control sequences which differ only in the number
	of numeric arguments they expect.  This means we have a new upper
	limit on the length of a numeric argument list we'll recognize.
	* src/caps.c(_deepinvte_xterm_capability_strings): remove alternates for
	strings which include '%m' as a specifier -- that's handled at the
	matching layer now.
	* src/deepinvte.c(deepinvte_terminal_paste_cb): drop the supplied data if it isn't
	valid UTF-8 (Red Hat #119099).
	* src/keymap.c(_deepinvte_keymap_map): try xterm variants if we're xterm, not
	the other way around.

2004-08-18  David Lodge <dave@cirt.net>

	* configure.in: Added "ang" to ALL_LINGUAS.

2004-08-18  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.in: Added «nb» to ALL_LINGUAS.

2004-08-16  Christian Rose  <menthos@menthos.com>

	* configure.in: Added "bs" to ALL_LINGUAS.

2004-08-13  Gora Mohanty  <gmohanty@cvs.gnome.org>

	* configure.in: Added "or" to ALL_LINGUAS.

2004-07-17  Dinesh Nadarajah <dinesh_list@sbcglobal.net>

	* ta.po: Added tamil Translation

2004-05-02 nalin
	* src/reaper.c(deepinvte_reaper_add_child): pass the global reaper in as
	data when adding the child source, not the terminal which called us.
	Stop accepting a data argument, because we'd discard it anyway.  Return
	the ID of the source which is added, if that happens.
	* configure.in: define DEEPINVTE_INVALID_SOURCE for internal use.

2004-05-01 nalin
	* README: add pointers to info on bidirectional text and shaping.

2004-05-01 nalin
	* src/deepinvte.c(deepinvte_terminal_get_text_maybe_wrapped): add a parameter to
	control whether or not trailing whitespace is trimmed (padraig.obriain,
	#141148).
	* src/deepinvte.c,src/deepinvte.h(deepinvte_terminal_get_text_include_trailing_spaces):
	add as a wrapper for the new deepinvte_terminal_get_text_maybe_wrapped()
	(padraig.obriain, #141148).
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_update_private_d): use
	deepinvte_terminal_get_text_include_trailing_spaces to ensure that we get
	trailing spaces (padraig.obriain, #141148).
	* src/deepinvte.c(deepinvte_terminal_insert_char): clean up some autowrap stuff.

2004-04-30 nalin
	* deepinvte.pc.in, deepinvte-uninstalled.pc.in: declare the defaultemulation
	variable as one kind of variable, not that other kind (#141515).

2004-04-30 nalin
	* src/deepinvte.c(deepinvte_terminal_button_release): complete selection if we were
	selecting, not just if Shift is held down (allows Press Shift, Press
	Button, Release Shift, Release Button in addition to already-recognized
	Press Shift, Press Button, Release Button, Release Shift) (#121905).
	* deepinvte.spec: buildrequire gtk-doc, manually copy png images at
	install-time.

2004-04-29 nalin
	* src/deepinvte.c, NEWS, doc/reference/deepinvte-sections.txt,
	doc/reference/tmpl/deepinvte-unused.sgml: documentation updates.
	* doc/reference/tmpl/reaper.sgml: note that we just proxy for glib 2.4
	child_watch functionality, if present.

2004-04-29 nalin
	* python/deepinvte.defs: include get_default_emulation binding.

2004-04-29 nalin
	* deepinvte.spec: update version to 0.11.11

2004-04-29 nalin
	* src/deepinvte.c(deepinvte_terminal_unrealize): don't unref our accessible peer;
	it may be accessed while we're unrealized, causing it to be destroyed
	and re-created needlessly (#128049).
	* src/deepinvte.c(deepinvte_terminal_finalize): unref our accessible peer.

2004-04-29 nalin
	* src/deepinvte.c(deepinvte_terminal_finalize): don't clear the child's PID early,
	so that we'll SIGHUP it properly (the kernel should do that anyway,
	but...) (#128291).

2004-04-29 nalin
	* src/deepinvte.c(deepinvte_terminal_insert_char): only deselect the current
	selection if just-inserted text affected the selected region of the
	screen (#135259).

2004-04-29 nalin
	* README: assorted updates.
	* configure.in: check for <sys/termios.h>
	* src/pty.c: include <sys/termios.h> if found (#141392).
	* src/dumpkeys.c, src/mev.c, src/pty.c, src/ssfe.c, src/deepinvte.c: do the
	same.
	* doc/reference/deepinvte-sections.txt: add several functions which are new
	but which weren't in the generated docs.
	* doc/reference/deepinvte-unused.txt: sort.

2004-04-29 nalin
	* src/deepinvte.c(deepinvte_terminal_scroll_region): remove stray debug printfs.

2004-04-29 nalin
	* configure.in: add a --with-default-emulation argument (part of
	#115750).  Use AS_HELP_STRING wherever we need help strings.
	* deepinvte.pc.in, deepinvte-uninstalled.pc.in: add DefaultEmulation variable
	* deepinvte.spec: specify "xterm" as the default-emulation, even though it's
	the default default
	* termcaps/Makefile.am: build and install the default emulation's
	termcap, assuming it's some kind of xterm variant.
	* src/keymap.c(_deepinvte_keymap_map): check for xterm-xfree86 definitions
	if the terminal type includes xterm, not if it exactly matches xterm
	* src/reaper.c(deepinvte_reaper_add_child): add.  The glib 2.4 SIGCHLD
	watcher requires us to register particular PIDs for monitoring, so now
	we require applications to do so.
	* src/reaper.c(deepinvte_reaper_child_watch_cb): add.
	* src/reaper.c(deepinvte_reaper_init): Don't hook the SIGCHLD handler if
	we're running under glib 2.4, expect to use the g_child_watch
	mechanism.
	* src/deepinvte.c: remove hard-coded definition of DEEPINVTE_DEFAULT_EMULATION,
	to be picked up from config.h instead.
	* src/deepinvte.c(deepinvte_sequence_handler_cs): remove stray debug printfs.
	* src/deepinvte.c(deepinvte_terminal_insert_char): only do what we were doing for
	xn if LP was also set (#141445).
	* src/deepinvte.c(deepinvte_terminal_get_default_emulation): add.
	* src/deepinvte.c(_deepinvte_terminal_fork_basic): call deepinvte_reaper_add_child for
	new children.

2004-04-27 nalin
	* src/deepinvte.c(deepinvte_terminal_fork_command): more clearly document what
	the argv and envv arguments are expected to contain (#127979).
	* src/deepinvte.c(deepinvte_terminal_insert_char): attempt to more closely match
	the behavior of am and xn on terminals -- if am is set {if xn is set,
	autowrap should only happen before a character is output, and then only
	if it's a graphic character, otherwise we autowrap after a character is
	output}

2004-04-21 nalin
	* src/deepinvte.c(deepinvte_terminal_get_text_range_maybe_wrapped): also trim back
	lines which are nothing but whitespace (#140765).
	* src/deepinvte.c(deepinvte_terminal_configure_toplevel): invalidate the whole
	window if we're "transparent", because we don't get expose events
	unless some portion of our area came out from behind something else,
	but we still need to repaint it (#122243).

2004-04-20 nalin
	* doc/reference/tmpl/reaper.sgml: document the child-exited signal.
	* doc/reference/tmpl/deepinvte.sgml: document the emulation-changed and
	encoding-changed signals.

2004-04-20 nalin
	* Makefile.am: add rule for generating deepinvte-uninstall.pc (Gman, #136129)
	* deepinvte-uninstalled.pc.in: add (Gman, #136129)

2004-04-19 nalin
	* src/deepinvte.c(deepinvte_terminal_key_press): don't steal keys from the input
	method.

2004-04-19 nalin
	* src/pty.c(_deepinvte_pty_set_utf8): toggle the IUTF8 flag, if
	it was defined at compile-time (maybe for #129317).
	* src/deepinvte.c(deepinvte_terminal_set_encoding): call _deepinvte_pty_set_utf8.
	* src/deepinvte.h (deepinvte_terminal_anti_alias_get_type): declare.
	* src/deepinvtebg.c(deepinvte_bg_get_pixmap): Optimisation to fix the ridiculous
	amount of time required to render solid colour or extremely small
	image tiled backgrounds.  This fixes bug #123903.  (desrt)
	* src/deepinvtebg.c(deepinvte_bg_root_pixmap): move resize code into a separate
	function.
	* src/deepinvtebg.c(deepinvte_bg_get_pixmap): Resize all image sources, in case
	we're using a very small image file for the background.

2004-04-19 nalin
	* python/Makefile.am: move python module to site-packages/gtk-2.0,
	which is added to the search path only by pygtk 2 (#92252).

2004-04-19 nalin
	* python/deepinvte.override: define a modulename override so that the
	Terminal class is registered in the proper namespace so that python's
	help() builtin sees the Terminal class (#130267).

2004-04-19 nalin
	* src/deepinvte.c(deepinvte_terminal_anti_alias_get_type): add, for the sake of
	bindings.

2004-04-19 nalin
	* src/deepinvte.c(deepinvte_terminal_key_press): call GtkWidget's key_press_event
	callback for keys, in case GtkWidget has pre-programmed behavior for
	that key (#133878).
	* configure.in, gnome-pty-helper/configure.in: quote names of defined
	functions (#133222).
	* configure.in: make compilation of gnome-pty-helper actually
	conditional (#133077).
	* src/deepinvte.c(deepinvte_terminal_process_incoming): Doh #132610, actually
	call deepinvte_terminal_emit_contents_changed() when the contents change.

2004-04-19 nalin
	* src/deepinvte.h, src/deepinvte.c (deepinvte_terminal_set_font_full): Add (#134429).
	* src/deepinvteglyph.c(_deepinvte_glyph_cache_set_font_description): take a
	DeepinvteTerminalAntiAlias argument.
	* src/deepinvteft2.c, src/deepinvtegl.c, src/pango.c, src/pango.x, src/deepinvtexft.c
	(*_set_text_font): take a DeepinvteTerminalAntiAlias argument.

2004-04-19  Victor Zverovich  <vitaut@users.sourceforge.net>
	* src/deepinvte.h src/deepinvte.c: Added default signal handlers to
	DeepinvteTerminalClass (#137961).  [NOTE: ABI change.]

2004-04-19 nalin
	* src/deepinvte.c(deepinvte_terminal_configure_toplevel): don't re-invalidate
	everything, apparently unnecessary (#122243).  Might need to back this
	out if I ever remember what specific combination of software and
	versions prompted its addition in the first place.
	* src/deepinvte.c(deepinvte_terminal_class_init): tell gettext that messages
	retrieved from this domain should be returned in UTF-8 (#139542).

2004-04-19 nalin
	* configure.in: don't disable use of deprecated APIs unless asked
	to do so.
	* src/keymap.c(_deepinvte_keymap_GDK_space): add Meta case (gafton).
	* src/deepinvtefc.c(_deepinvte_fc_width_from_pango_stretch): add.
	* src/deepinvtefc.c(_deepinvte_fc_transcribe_from_pango_font_description): handle
	PangoStretch characteristics using _deepinvte_fc_width_from_pango_stretch.
	* src/deepinvteregex.c: add random comments.
	* src/deepinvte.c(DeepinvteTerminal): track the "xn" terminal attribute.

2004-04-10  Guntupalli Karunakar  <karunakar@freedomink.org>

        * configure.in: Added "gu" (Gujarati) to ALL_LINGUAS.

2004-03-20  Gareth Owen  <gowen72@yahoo.com>

	* configure.in: Added en_GB to ALL_LINGUAS

2004-03-10  Alexander Winston  <alexander.winston@comcast.net>

	* configure.in: Added en_CA to ALL_LINGUAS.

2004-03-04  Guntupalli Karunakar  <karunakar@freedomink.org>

	* configure.in: Added "pa" for Punjabi to ALL_LINGUAS.

2004-02-07  Robert Sedak  <robert.sedak@sk.htnet.hr>

	* configure.in: Added "hr" (Croatian) to ALL_LINGUAS.

2004-02-02  Martin Kretzschmar  <m_kretzschmar@gmx.net>

	* docs/reference/Makefile.am: use gtk-doc in xml-mode.

	* docs/reference/deepinvte-docs.sgml: sgml->xml, update to DocBook XML
	4.1.2 DTD (fixes Bug #132945)

2004-02-02 Alastair McKinstry <mckinstry@computer.org>

	* configure.in: Added 'ga' to ALL_LINGUAS
	* po/ga.po: Added Gaeilge (Irish) translation.

2004-01-27  Åsmund Skjæveland  <aasmunds@fys.uio.no>

	* configure.in: Added 'nn' to ALL_LINGUAS
	* po/nn.po: Added Norwegian Nynorsk translation.

2003-12-20  Arafat Medini <lumina@silverpen.de>

	* configure.in: Added Arabic Locale "ar" to ALL_LINGUAS

2003-12-10  Tõivo Leedjärv  <toivo@linux.ee>

	* configure.in: Added et to ALL_LINGUAS.

2003-12-06  Iñaki Larrañaga  <dooteo@euskalgnu.org>

	* configure.in: Added "eu" (Basque) to ALL_LINGUAS.

2003-10-14  Christian Rose  <menthos@menthos.com>

	* configure.in: Added "ne" to ALL_LINGUAS.

2003-10-07  Žygimantas Beručka  <uid0@tuxfamily.org>

	* configure.in: Added "lt" to ALL_LINGUAS.

2003-09-15 nalin
	* src/deepinvteapp.c: add options for exercising the cursor and highlight
	colors.
	* src/debug.c: flush output streams when we check if debugging is
	enabled, because we'll probably output a string next.
	* src/iso2022.c: don't print a zero-length string.  Yay compiler
	warnings.
	* src/interpret.c: use g_print() instead of fprintf() to print.
	* src/keymap.c,src/ssfe.c: include <stdarg.h>, hopefully fixing
	bug #121880 (or not).

2003-09-15 nalin
	* python/deepinvte.defs: add specs for set_color_cursor and
	set_color_highlight.

2003-09-15 nalin
	* src/deepinvte.h,src/deepinvte.c: add deepinvte_terminal_set_color_cursor.
	* src/deepinvte.h,src/deepinvte.c: add deepinvte_terminal_set_color_highlight (#69776).
	* src/deepinvte.c(deepinvte_terminal_determine_colors): add parameters for
	specifying if the cell being rendered is the cursor or is highlighted,
	probably for being selected.  If either flag is set, and we've been
	given a color to use for the purpose by a caller, use the supplied
	color, else use inverse colors.

2003-09-15 nalin
	* src/iso2022.c(process_control): don't reset the conversion state
	when we hit an end-of-line.  I wasn't reading RFC1468 closely enough,
	as it states that each line begins in the same encoding as the end of
	the previous line, and read "application should reset before end-of-
	line" as "terminal resets at end-of-line" (bug #122156).

2003-09-11 nalin
	* src/deepinvteapp.c: silence a compiler warning.

2003-09-11 nalin
	* README: ask for LC_* in addition to LANG if weird spacing errors
	crop up.
	* src/deepinvteconv.c,src/deepinvteconv.h: add wrappers for _deepinvte_conv which weed
	out some warnings.
	* src/iso2022.c: use _deepinvte_conv_cu instead of _deepinvte_conv.
	* src/trie.c: use _deepinvte_conv_cu instead of _deepinvte_conv.
	* src/deepinvte.c: give _deepinvte_terminal_fudge_pango_colors a return type again.
	* src/deepinvtebg.c: ifdef out deepinvte_bg_source_name, which is unused.
	* src/deepinvtebg.c,src/deepinvterdb.c: wrap calls to gdk_property_get to weed out
	some compiler warnings.

2003-09-11 nalin
	* src/deepinvte.c(deepinvte_terminal_draw_cells_with_attributes): properly resolve
	colors and cell properties to drawing colors.
	* src/deepinvte.c(_deepinvte_terminal_fudge_pango_colors): add a function for
	mapping GTK+ white-on-black preedit text to default reverse-colored
	text for the terminal.
	* src/deepinvte.c(_deepinvte_terminal_translate_pango_cells): don't bother
	doing anything with the attribute for a range if the list is NULL.
	Fudge white-on-black text to default colors in reverse so that it
	works when the terminal is in a black-on-white color scheme.

2003-09-11 nalin
	* src/deepinvte.c(_deepinvte_terminal_apply_pango_attr): map weight attributes to
	the terminal's bold attribute.

2003-09-11 nalin
	* src/deepinvte.c(_deepinvte_terminal_map_pango_color): add.
	* src/deepinvte.c(deepinvte_terminal_im_preedit_changed): don't discard the
	attributes list for the preedit string -- save them.
	* src/deepinvte.c(deepinvte_terminal_draw_cells_with_attributes): add.
	* src/deepinvte.c(deepinvte_terminal_paint): use draw_cells_with_attributes to
	use the preedit attributes list when drawing the preedit string.  This
	changes the way the preedit string is presented to the user, but it
	now looks [more] like GTK+ suggests it should look, so it should be a
	good change.

2003-08-13 nalin
	* src/caps.c: add sequences for linux-console-cursor-attributes, which
	we'll ignore (bug #108232).

2003-08-13 nalin
	* configure.in: if we don't find the python headers (even if we found
	python), disable compilation of python bindings (bug #116756).  Make the
	checks for python support sequential for easier maintenance.
	* python/deepinvte.defs: add def for deepinvte_terminal_match_set_cursor_type.  Make
	the color argument to deepinvte_terminal_set_background_tint_color const.
	* python/deepinvte.override(_wrap_deepinvte_terminal_forkpty): add.
	* python/deepinvte.override(_wrap_deepinvte_terminal_fork_command): don't leak envv.

2003-08-13 nalin
	* src/deepinvte.c(deepinvte_terminal_fork_command,deepinvte_terminal_forkpty): doc update
	to note that directory and envv can be NULL for both.

2003-08-13 nalin
	* src/deepinvteapp.c(main): if -S is passed, use forkpty to start a child that
	just counts until killed with Ctrl-C.

2003-08-13 nalin
	* doc/reference/deepinvte-sections.txt: add deepinvte_terminal_forkpty.
	* src/pty.c(_deepinvte_pty_run_on_pty): exit on any error, to avoid leaving
	random unreaped children running.  Accept NULL command indicating that
	no exec() should occur, but still error out if command isn't NULL and
	exec() fails.
	* src/pty.c(_deepinvte_pty_fork_on_pty_name,_deepinvte_pty_fork_on_pty_fd): store
	0 as the new child's PID if we're the child.
	* src/pty.c(main): don't run "tty" by default, test the forkpty() case
	instead.
	* src/deepinvte.c(deepinvte_terminal_fork_command): rename to
	_deepinvte_terminal_fork_basic.  Remove code to replace NULL command with
	the user's shell.
	* src/deepinvte.c(deepinvte_terminal_fork_command): new! wrap
	_deepinvte_terminal_fork_basic, replacing a NULL command with the user's
	shell.
	* src/deepinvte.c(deepinvte_terminal_forkpty),src/deepinvte.h: new! wrap
	_deepinvte_terminal_fork_basic, passing NULL for the command and argv
	arguments (bug #116450).
	* src/Makefile.am: update shared library version.

2003-08-12 nalin
	* configure.in: if <ft2build.h> isn't found, then we can't use any
	freetype-specific bits, and that's not useful.  Error out, and say
	that we need freetype 2.0.2 or newer, which introduced this header
	into the procedure (bug #116341).

2003-08-12 nalin
	* src/deepinvte.c: don't create an accessible peer at init() time in
	debug mode.
	* gnome-pty-helper/gnome-pty-helper.c(struct pty_info): add a field to
	keep track of whether or not we created a lastlog record.
	* gnome-pty-helper/gnome-pty-helper.c(shutdown_pty): also try to
	write a logout record if pi->lastlog is true, because in doing so we
	free pi->data, closing a leak (bug #116091).

2003-08-12 nalin
	* src/deepinvteapp.c(resize_window): don't add the padding in when calculating
	the new window size.

2003-08-12 nalin
	* doc/reference/tmpl/deepinvte.sgml: note that dimensions passed in with
	the resize-window signal include padding (more of bug #119141).

2003-08-12 nalin
	* src/deepinvte.c(deepinvte_sequence_handler_character_attributes,
	deepinvte_sequence_handler_decset_internal): remove redundant type checks.
	* src/deepinvte.c(all signal handlers): return a boolean indicating whether
	or not to exit the processing loop instance early to allow the
	application to deal with some input (usually along the lines of a
	signal requesting that the terminal be resized) (bug #118938).

2003-08-12 nalin
	* python/deepinvte.override(get_text,get_text_range): reorder arguments to
	match the order for the C versions (#118882).
	* python/deepinvte.override(get_text,get_text_range,call_callback): fix
	refcounting and callback argument marshalling (bug #118882).
	* python/deepinvte-demo.py: exercise get_text() on "window-raise" signals.

2003-08-12  Padraig O'Briain  <padraig.obriain@sun.com>

	* src/deepinvteaccess.c:
	(deepinvte_terminal_initialize): New function containing initialization code
	previously in deepinvte_terminal_accessible_new. Also set role in
	this function.
	(deepinvte_terminal_accessible_class_init): Specify function pointer for
	deepinvte_terminal_initialize.
	(deepinvte_terminal_accessible_get_type): Do not set instance data size or
	GInstanceInitFunc. Remove deepinvte_terminal_accessible_init.

	This fixes bug #119694.

2003-08-11 nalin
	* python/deepinvte.override: add binding for get_padding() (bug #118834).

2003-08-11 nalin
	* python/deepinvte.override: add binding for get_cursor_position()
	(bug #118800).

2003-08-11 nalin
	* python/deepinvte.defs: give length parameters for feed() and feed_child()
	default values of -1 (bug #118711).
	* python/deepinvte.override: use the length parameter if it's supplied to the
	feed() and feed_child() methods.

2003-08-11 nalin
	* python/deepinvte.override: add overrides for feed() and feed_child()
	methods which use the length of the string as given in C, to hopefully
	allow passing NUL bytes around as part of strings (bug #118711).  Make
	the length parameter optional, and ignored, to try to avoid breaking
	existing Python code in an obvious way.

2003-08-11 nalin
	* src/deepinvte.c(deepinvte_terminal_start_selection,deepinvte_terminal_extend_selection):
	drop an unnecessary cast-and-check, which we don't need because we have
	no use for the GtkWidget pointer to the terminal.  Fix initial shift-
	click (bug #118106).

2003-08-11 nalin
	* configure.in: error out if we don't find ncurses, curses, or
	libtermcap development headers (bug #117754).

2003-08-11 nalin
	* autogen.sh: export WANT_AUTOCONF_2_5 for the sake of Mandrake autoconf
	wrapper (bug #119066).

2003-08-05 nalin
	* src/deepinvte.c(deepinvte_sequence_handler_decset_internal,
	deepinvte_sequence_handler_window_manipulation): include the widget's padding
	widths in resize requests (bug #119141).

2003-07-30 nalin
	* autogen.sh: check for autoconf-2.51, autoconf-2.50, autoconf-2.5 when
	looking for autoconf 2.5x (bug #118627).

2003-07-21 nalin
	* gnome-pty-helper/configure.in: define _XOPEN_SOURCE_EXTENDED,
	_XOPEN_SOURCE, and __EXTENSIONS__ for Solaris, as we do in the top-level
	configure (#117636).

2003-07-16 nalin
	* gnome-pty-helper/configure.in: check for grantpt in libc and then
	in libpt.  Check for openpty in libc before checking libutil.  Check for
	sendmsg in libc before checking libsocket (with libnsl) (#117636).

2003-07-11  Pablo Saratxaga <pablo@mandrakesoft.com>
	* configure.in: Added Walloon (wa) to ALL_LINGUAS

2003-07-10 nalin
	* src/deepinvteregex.h, src/deepinvteregex.c: add.
	* src/deepinvte.c: use interfaces from deepinvteregex for doing dingus matching.

2003-07-03 nalin
	* src/deepinvte.c(deepinvte_sequence_handler_return_terminal_status): return an
	empty string in response to the ENQ control sequence instead of "xterm".
	Report and patch from Mariano Suárez-Alvarez (#116495).

2003-06-27 nalin
	* src/iso2022.c: treat the "big5hkscs" encoding as an East Asian
	encoding, which uses ambiguous widths (#116078).  Report and patch
	from Roger So.
	* src/dumpkeys.c, src/iso2022.c, src/iso8859mode.c, src/nativeecho.c,
	src/utf8echo.c, src/utf8mode.c, src/deepinvte.c: don't use the literal escape
	character, express it as an octal sequence.

2003-06-16 nalin
	* src/caps.c: add vertical-tab and form-feed to the list of control
	sequences.
	* src/deepinvte.c(deepinvte_controL_sequence_handler_form_feed): add.
	* src/deepinvte.c(deepinvte_controL_sequence_handler_vertical_tab): add.

2003-06-16 nalin
	* src/deepinvteaccess.c(xy_from_offset): fix a compiler warning.

2003-06-16 nalin
	* src/deepinvteint.h: add.  Move private DeepinvteTerminal stuff which needs to be
	shared with other modules in the library here.
	* src/deepinvtedraw.c, src/deepinvtedraw.h: add get_char_width(), for use in drawing
	the cursor.
	* src/deepinvte.c(deepinvte_invalidate_cursor_once): if the character under the
	cursor doesn't fit into its cell, expose the column to the right of
	it so that we can paint into the adjacent cell.
	* src/deepinvte.c(deepinvte_terminal_paint): when clearing the area behind the
	cursor or drawing the hollow rectangle to indicate its position when
	we don't have focus, use the visible width of the character instead
	of just assuming it will fit.  This complies better with assertion 2.

2003-06-09 nalin
	* src/deepinvte.c(deepinvte_terminal_set_encoding): set the encoding for the iso2022
	converter (spotted by havill).

2003-06-04 nalin
	* src/deepinvtebg.c, src/deepinvterdb.c: sync the display before trapping errors
	to ensure that any errors we'll get will be handled before we remove
	the error handlers.

2003-06-03 nalin
	* src/deepinvtebg.c(_deepinvte_bg_get_pixmap, _deepinvte_bg_get_pixbuf): trap X errors
	while retrieving the contents of the root pixmap.
	* doc/ambiguous.txt: add.
	* README: update.
	* deepinvte.spec: rebuild.

Tue Jun  3 15:50:38 2003  Jonathan Blandford  <jrb@redhat.com>

	* src/pty.c (n_read): add a missing break in the switch statement.

2003-06-03  Kenneth Rohde Christiansen  <kenneth@gnu.org>
	* configure.in: Added Limburgish (li) to ALL_LINGUAS.

2003-06-02 nalin
	* src/Makefile.am: start using libtool versioning in earnest.

2003-06-01 nalin
	* src/deepinvtegl.c(_deepinvte_gl_set_text_font): compile fix.

2003-05-30 nalin
	* src/deepinvte.c(deepinvte_sequence_handler_decset_internal): fix logic for
	skipping over particular settings so that setting 1048 actually works.
	* src/deepinvte.c(deepinvte_terminal_process_incoming): in debug mode, print out
	characters with codepoints higher than 255 in hex rather than decimal.
	* src/iso2022.c(_deepinvte_iso2022_ambiguous_width): rename to
	_deepinvte_iso2022_ambiguous_width_guess because that's all we can do without
	more context.
	* src/iso2022.c(_deepinvte_iso2022_ambiguous_width): add for using the
	current encoding to determine what the width of an ambiguously-wide
	character should be.  This seems to work better.

2003-05-30  Padraig O'Briain  <padraig.obriain@sun.com>
	* src/deepinvteaccess.c: Add implementation for get_character_extents,
	get_offset_at_point and get_run_attributes. This fixes bug #110770.
	Add casts to fix complier warnings on Solaris.
	
	* src/deepinvtexft.c (_deepinvte_xft_text_extents): Do not call return as function
	returns void. Fixes compiler error on Solaris.

2003-05-29 nalin
	* src/deepinvteapp.c: require -i for icon-title-changed messages, which got
	really annoying really fast.
	* src/trie.c(main): use g_quark_from_static_string for static strings.

2003-05-29 nalin
	* src/deepinvte.c(deepinvte_terminal_send): fix newline stuffing (used in linefeed
	mode).
	* src/deepinvte.c(deepinvte_unicode_strlen): rename to deepinvte_unichar_strlen.
	* src/deepinvte.c(deepinvte_terminal_set_title_internal): don't leak the new title
	in the unlikely cases.
	* src/deepinvte.c(deepinvte_terminal_process_incoming): be more careful with control
	characters to avoid cases where we could be tricked into a loop.
	* src/deepinvteapp.c: emit a message when the icon title is changed.

2003-05-29 nalin
	* src/deepinvte.c(deepinvte_terminal_process_incoming): handle control characters
	in the middle of control sequences.
	* src/deepinvte.c(deepinvte_sequence_handler_cm): fix origin mode.
	* src/deepinvte.c(deepinvte_sequence_handler_cv): fix origin mode.
	* src/deepinvte.c(deepinvte_sequence_handler_cs): snap the cursor to the scrolling
	region which is set.
	* src/table.c(_deepinvte_table_extract_number): extract a number digit by
	digit as we do in the trie parser.
	* src/deepinvte.h: declare 'struct deepinvte_char_attributes' again to restore API
	back compat with 0.10.x.
	* src/iso2022.c(_deepinvte_iso2022_sequence_length): don't recognize PM
	messages -- Xterm doesn't do anything with them and we don't want to
	appear to hang when we're really just waiting for the end of the
	message.

2003-05-28 nalin
	* src/deepinvtefc.c(_deepinvte_fc_defaults_from_rdb): only apply DPI if we were
	able to get a value.
	* src/deepinvterdb.c, src/deepinvterdb.h: use the display and screen of a passed-in
	widget if asked to do so, else use screen 0 of the default display.

2003-05-28 nalin
	* configure.in: check for GTK+ 2.2, and if found, force use of
	multihead-safe APIs to try to flush out some bugs.
	* src/deepinvte.c, src/deepinvteapp.c, src/deepinvtedraw.c, src/deepinvtefc.c, src/deepinvteglyph.c:
	clean up some sloppy multihead changes.
	* src/deepinvte.c, src/deepinvte.h (deepinvte_terminal_match_set_cursor_type): add.
	* src/deepinvtedraw.c, src/deepinvtedraw.h: add a draw_char() method which is
	allowed to fail.
	* src/deepinvte.c(deepinvte_terminal_draw_graphic): separate the width of a column
	and the number of columns to be drawn.  Use _deepinvte_draw_char() to avoid
	crude approximations of characters when we have a font for them.

2003-05-21 nalin
	* src/deepinvte.c(deepinvte_terminal_scroll_region): force an entire window repaint
	if we're supposed to scroll the background but we're not scrolling the
	entire window.  This means we need to repaint the scrolled region, and
	to keep things looking right, we need to repaint everything.
	* src/deepinvteapp.c(main): enable visible bell if we're disabling the
	audible bell, and vice-versa.
	* src/deepinvte.c: flesh out some doc comments.
	* doc/reference/tmpl/deepinvte.sgml: flesh out some notes on signals.

2003-05-21 nalin
	* src/deepinvteconv.c(_deepinvte_conv): pass zero bytes which trigger EILSEQ
	through and keep going.
	* src/deepinvteconv.c: replace use of g_utf8_strlen with an internal function
	which doesn't stop counting at NUL characters.

2003-05-21 nalin
	* src/interpret.c: use _deepinvte_matcher_free_params_array.
	* src/deepinvte.c(deepinvte_invalidate_cursor_once): add a parameter for indicating
	if this is a "cursor blink" (periodic) refresh, and if it is set and
	the cursor isn't supposed to blink, suppress the invalidate.

2003-05-21 nalin
	* src/iso2022.c(_deepinvte_iso2022_process): free the temporary array.
	* src/matcher.c(_deepinvte_matcher_free_params_array): add.
	* src/deepinvte.c: use _deepinvte_matcher_free_params_array instead of the local
	copy, which is removed.
	* src/interpret.c, src/table.c, src/trie.c: use
	_deepinvte_matcher_free_params_array to free parameter arrays instead of
	g_value_array_free, which doesn't take care of the pointer values.
	* src/deepinvte.c(deepinvte_sequence_handler_set_title_internal): only attempt to
	close the conversion descriptor if it was opened successfully.
	* src/deepinvteapp.c: add the -k option to spin after gtk_main() returns.
	* src/deepinvtefc.c: make copies of patterns with FcPatternDuplicate so that
	we know where all of the returned patterns came from.
	* src/deepinvtexft.c(_deepinvte_xft_font_for_char): set the item in the pattern
	array to NULL if we successfully opened a font using the pattern.

2003-05-20 nalin
	* src/iso2022.c: clarify comments near one of the warning messages.
	* src/deepinvtefc.c(_deepinvte_fc_transcribe_from_pango_font_description): unref
	the Pango context, which was created for us.
	* src/deepinvtepango.c: keep track of the Pango context, and unref it when
	it is no longer needed.

2003-05-20 nalin
	* src/Makefile.am: try juggling the CFLAGS and LIBS order to let the
	xft CFLAGS/LIBS take precedence over everything else (#113335).

2003-05-20 nalin
	* src/ssfe.c: compile fix for Solaris, patch from #113344.

2003-05-20 nalin
	* src/deepinvte.c: remove no-longer-used tree structure.
	* src/deepinvtefc.c: free strings returned by g_object_get().

2003-05-20 nalin
	* src/deepinvte.c(deepinvte_terminal_realize): create the terminal's draw structure.
	* src/deepinvte.c(deepinvte_terminal_unrealize): free the terminal's draw structure.
	* src/deepinvteapp.c(main): enforce a clean shutdown by requiring that the
	terminal and top-level window are both finalized before gtk_main()
	returns.

2003-05-20 nalin
	* src/deepinvte.c(deepinvte_terminal_finalize): properly send a SIGHUP to the child
	process if it hasn't already exited (#112505).
	* src/deepinvteapp.c: don't exit on EOF, only on child-exited.
	* src/deepinvte.c(deepinvte_sequence_handler_sf): increment the scrolling offset
	to avoid flickering when the application has defined a scrolling region
	with top row == 1.

2003-05-19 nalin
	* src/iso2022.c, src/keymap.c, src/mev.c, src/deepinvtebg.h, src/deepinvteglyph.h:
	remove comma from end of enum declaration (#111925).
	* src/deepinvtetc.c: don't use parameter-as-array-size compiler
	extension (#111925).
	* src/ssfe.c: don't assume that the compiler interprets \e correctly,
	use %c with value of 27 instead (#111925).
	* doc/reference/Makefile.am: obey CPPFLAGS and LDFLAGS (#111925).
	* gnome-pty-helper/gnome-utmp.c: only include <utmp.h> if HAVE_UTMP_H
	was defined (#111925).
	* src/keymap.c, src/ssfe.c: unconditionally include <term.h> if we
	defined HAVE_CURSES or HAVE_NCURSES, as having the header is a
	precondition for defining either (#111925).
	* src/iso2022.c: make each array have at least one element (#111925).
	* src/pty.c, src/gnome-login-support.c: try to open /dev/ptc if opening
	/dev/ptmx fails due to ENOENT (#111925).

2003-05-19 nalin
	* src/deepinvteapp.c: don't exit on eof, just child-exited.
	* src/deepinvte.c(deepinvte_terminal_eof): don't disconnect from SIGCHLD on eof,
	the child might still be running.

2003-05-19 nalin
	* src/Makefile.am: change all instances of "termcap" to "deepinvtetc".
	* src/termcap.c, src/termcap.h: rename to deepinvtetc.c, deepinvtetc.h, to avoid
	conflicts with system headers.

2003-05-19 nalin
	* src/keymap.c: fix KP_PageDown in application keypad mode (#113187).
	* src/reaper.c: add a finalize method which properly cleans things up
	so that the singleton can at least theoretically be destroyed (part of
	a fix for #112172).
	* src/deepinvte.c: obtain a ref to a reaper object whenever we are waiting
	for a child to exit.
	* po/POTFILES.in: add more source files for scanning.
	* src/iso2022.c: rework pieces to handle incomplete sequences at the
	end of input.  Check for 8-bit SS2 and SS3 in case of EILSEQ.  Build
	a fake ISO-8859-1 map for conversions using invalid maps.
	* src/iso2022.c(_deepinvte_iso2022_state_free): free the state's buffer.
	* src/deepinvteconv.c: internalize UTF-8 to UTF-8 conversions, fix handling
	of incomplete sequences at the end of the available data.
	* src/deepinvte.c: implement send/receive and automatic linefeed modes.
	* src/deepinvte.c(deepinvte_sequence_handler_sr): invalidate the row which contains
	the cursor to ensure that it doesn't leave a trail.
	* src/deepinvte.c(deepinvte_sequence_handler_return_terminal_id): add.
	* src/deepinvte.c(deepinvte_terminal_feed_child_using_modes): add.

2003-05-19 Telsa Gwynne  <hobbit@aloss.ukuu.org.uk>

	* configure.in: Add cy (Welsh) to ALL_LINGUAS

2003-05-13 nalin
	* src/iso2022.c(_deepinvte_iso2022_find_nextctl): don't recognize 8-bit
	SS2 and SS3 by default, it breaks UTF-8 and other encodings (#112879).

2003-05-13 nalin
	* src/deepinvtedraw.c, src/deepinvtedraw.h: add _deepinvte_draw_needs_repaint() to
	indicate if the drawing back-end can only handle entire-window paints.
	* src/deepinvteconv.c: return a value from _deepinvte_conv_close(), even though
	it isn't used.
	* src/deepinvte.c(deepinvte_terminal_paint): don't look at drawing starting at
	negative row or coumn offsets.
	* src/deepinvtegl.c: prefer glX double-buffering to GDK's, and use double-
	buffered possibly-direct windows instead of indirect pixmaps.

2003-05-12 nalin
	* src/deepinvtebg.c(_deepinvte_bg_get_pixmap, _deepinvte_bg_get_pixbuf): account for the
	foreign root pixmap not having a colormap by default, using the root
	window's colormap if it doesn't already have one set.

2003-05-12 nalin
	* src/iso2022.c(_deepinvte_iso2022_state_new): if we can't convert from the
	locale encoding to UTF-8, use UTF-8 as the locale encoding (#112614).
	* src/deepinvtegl.c(_deepinvte_gl_start): enable point smoothing.

2003-05-08 nalin
	* src/deepinvtedraw.c, src/deepinvtedraw.h (_deepinvte_draw_get_colormap): let the caller
	control whether or not we return the default colormap.
	* src/deepinvtegl.c: enable blending.  Don't specify any buffer depths.  Set
	the current drawable before we do any drawing.  Call gluOrtho2D with
	the right args to set up the right projection.
	* src/deepinvteskel.c: quiet compiler warning by removing a "const".
	* src/deepinvtedraw.c: juggle the preferred render order again.

2003-05-08  Abel Cheung  <maddog@linux.org.hk>

	* configure.in: Added "mk" to ALL_LINGUAS.

2003-05-07 nalin
	* src/iso2022.c: let OSC command sequences be subject to code
	conversion again (#112485).

2003-05-07 nalin
	* src/deepinvteconv.c, src/deepinvteconv.h: add DeepinvteConv as a thin wrapper around
	GIConv.
	* src/iso2022.c: use DeepinvteConv.
	* src/matcher.c(_deepinvte_matcher_find_valid_encoding): remove.
	* src/matcher.c(_deepinvte_matcher_wide_encoding): remove.
	* src/trie.c: use DeepinvteConv.
	* src/utf8echo.c: use DeepinvteConv.
	* src/deepinvte.c: use DeepinvteConv (#112446).

2003-05-06 nalin
	* src/deepinvte.c: add "Since: 0.11" to documentation for functions which
	aren't available in the 0.10 series.
	* src/iso2022.c: default G2 to JIS0201, G3 to JIS0212 for Japanese,
	because they appear to not be used by anyone else.
	* deepinvte.spec: merge with .spec file from RHL.

2003-05-06 nalin
	* src/deepinvtegl.c: get text rendering semi-working.

2003-05-06 nalin
	* src/deepinvteft2.c, src/deepinvtegl.c, src/deepinvtepango.c, src/deepinvtepangox.c,
	src/deepinvtexft.c: when setting up backgrounds, don't deref an existing
	background before fetching a new one, in case they're the same.
	* src/deepinvteglyph.c(_deepinvte_glyph_draw): fix computation of the input offset.
	* src/deepinvtegl.c: implement drawing of backgrounds.

2003-05-06 nalin
	* src/iso2022.c(_deepinvte_iso2022_map_J): include the whole JIS0201 map
	instead of just the lower half.
	* src/iso2022.c(_deepinvte_iso2022_map_get): set the and_mask to clear the
	high bits of pairs before looking them up in the maps.
	* src/iso2022.c(_deepinvte_iso2022_fragment_input): recognize the 8-bit
	versions of SS2 and SS3.
	* src/iso2022.c(_deepinvte_iso2022_process_control): recognize the 8-bit
	versions of SS2 and SS3.

2003-05-06  Danilo Šegan  <dsegan@gmx.net>

	* configure.in: Added "sr" and "sr@Latn" to ALL_LINGUAS.

2003-05-05 nalin
	* src/debug.h: include <glib.h> for gboolean type definition.
	* src/matcher.c: include "config.h" and "debug.h".
	* src/matcher.h: use G_BEGIN_DECLS/G_END_DECLS
	* src/table.h: use G_BEGIN_DECLS/G_END_DECLS
	* src/termcap.h: include <glib.h>, again for gboolean.
	* src/deepinvtebg.h,src/deepinvterdb.h,src/deepinvtergb.h: adjust macro used to prevent
	multiple inclusions to match the rest of the tree.
	* src/deepinvtefc.c(_deepinvte_fc_patterns_from_pango_font_desc): provide a callback
	which can be used to override all defaults.
	* src/deepinvtegl.h,src/deepinvtexft.h: don't include "config.h"
	* src/deepinvteglyph.c, src/deepinvteglyph.h: add _deepinvte_glyph_get_uncached().

2003-05-04 nalin
	* gnome-pty-helper/gnome-login-support.c(n_read,n_write): if ERESTART
	is defined, treat it like EINTR and EAGAIN.
	* src/pty.c(n_read,n_write): if ERESTART is defined, treat it like
	EINTR and EAGAIN.

2003-05-02 nalin
	* configure.in: define _XOPEN_SOURCE_EXTENDED, _XOPEN_SOURCE, and
	__EXTENSIONS__ to get definitions for msg_control and msg_controllen
	on Solaris (#112036).
	* src/deepinvtedraw.c(_deepinvte_draw_set_scroll): don't try to return a value from
	this void function (#112036).  Patch from Hidetoshi Tajima.
	* src/xticker.c: don't include getopt.h, which isn't even needed for
	regular getopt() (#112036).  Patch from Hidetoshi Tajima.

2003-05-01 nalin
	* src/deepinvtebg.c(deepinvte_bg_set_root_pixmap,deepinvte_bg_root_pixmap): remove some
	debugging g_print() calls.
	* src/iso2022.c(process_cdata): skip over NUL bytes (#112022).
	* src/deepinvte.c(deepinvte_terminal_background_update): map the bgcolor values to
	a pixel value before setting the window background color.
	* src/nativeecho.c(main): echo NUL bytes if asked to do so.

2003-05-01 nalin
	* src/deepinvtebg.c, src/deepinvtebg.h: add a singleton object for managing
	copies of background images, either the desktop background, an
	in-memory pixbuf, or an on-disk file, with tinting.  Using a single
	store for this stuff lets multiple widgets share images and should
	reduce both CPU and memory consumption in applications which create
	more than one DeepinvteTerminal instance with similar settings.
	* src/deepinvtedraw.c, src/deepinvtedraw.h: adapt the set_background_pixbuf()
	interface to the deepinvtebg method and rename to set_background_image().
	* src/deepinvteft2.c, src/deepinvtegl.c, src/deepinvtepango.c, src/deepinvtepangox.c,
	src/deepinvteskel.c, src/deepinvtexft.c: update to work with newer deepinvtebg/deepinvtedraw
	interfaces.
	* src/deepinvte.c(deepinvte_terminal_filter_property_changes): remove in favor
	of deepinvtebg method.  Manage background state for deepinvtebg.

2003-05-01 Kang Jeong-Hee <Keizi@mail.co.kr>
	* doc/reference/Makefile.am: s/index.sgml/index.html/.
	There's no index.sgml in html directory, but a index.html.

2003-04-29 nalin
	* src/deepinvte.c(deepinvte_sequence_handler_local_charset): remove the unused
	DEFAULT_ISO_8859_1 case.
	* src/deepinvte.c(deepinvte_terminal_class_init): don't call
	_deepinvte_matcher_narrow_encoding(), because we don't need it any more.
	Change the error message emitted when _deepinvte_matcher_wide_encoding()
	fails (#111925), and mark it for translation.
	* src/trie.c(main): don't call _deepinvte_matcher_narrow_encoding() just
	to print its result.
	* src/deepinvte.c(deepinvte_terminal_set_encoding): include the right codeset name
	in the error message.
	* src/deepinvteglyph.c(_deepinvte_glyph_get): mark error message for translation.
	* src/matcher.c, src/matcher.h: remove _deepinvte_matcher_narrow_encoding().
	Make tables of strings "const".

2003-04-29 nalin
	* src/deepinvte.c(deepinvte_terminal_unrealize): set the IM context's client window
	to NULL before unreferencing it to avoid crashes when preedit is active.

2003-04-29 nalin
	* src/keymap.c: add keymaps for GDK_slash and GDK_question (#108299).

2003-04-29 nalin
	* src/deepinvterdb.c(_deepinvte_rdb_get): use INT_MAX instead of LONG_MAX when
	passing in the maximum length, because it's returned in an int.

2003-04-29 nalin
	* src/iso2022.txt: fix the UTF-8 sample text which corresponds to the
	ISO-2022-KR sample text so that it actually matches the text.

2003-04-29 nalin
	* src/iso2022.c(_deepinvte_iso2022_map_U): add map for CP437.
	* src/unitable.CP437: add.
	* src/mkunitables.sh: add CP437.
	* src/Makefile.am: add unitable.CP437 to the file list.

2003-04-29 nalin
	* src/iso2022.c(_deepinvte_iso2022_process_control): accept and warn about
	bogus map names (#110300).

2003-04-28 nalin
	* src/deepinvte.c(deepinvte_invalidate_cursor_once): rework to simplify the logic
	of how many cells to invalidate when we have a preedit string.
	* src/deepinvte.c(deepinvte_terminal_paint): draw the preedit string correctly for
	cases more complicated than the default IM (seems to fix #111767).
	* src/deepinvterdb.c(_deepinvte_rdb_get): use g_strncpy() and the property length
	to avoid going past the end of the possibly-not-nul-terminated string.
	* src/Makefile.am: build a standalone deepinvterdb binary.

2003-04-28 nalin
	* src/deepinvte.c(deepinvte_terminal_insert_char): add another flag to skip over
	sanity-checking the buffer when adding characters.
	* src/deepinvte.c(deepinvte_terminal_process_incoming): sanity-check the buffer
	only when necessary to save time.
	* src/deepinvte.c(deepinvte_terminal_scroll_region): invalidate the region which
	is exposed when we scroll so that the entire cell gets redrawn, avoiding
	clipping problems (#111683).
	* src/deepinvte.c(deepinvte_terminal_paint): fix math for determining where to
	stop drawing.
	* src/deepinvte.c(deepinvte_terminal_fill_rectangle): rename to ..._int to reduce
	confusion over which internal drawing commands are offset and which are
	not.
	* src/deepinvte.c(deepinvte_terminal_insert_char): if performing a single
	substitution, check the encoded width of the output char, not the
	input char, which doesn't have one.

2003-04-28 nalin
	* src/deepinvterdb.c, src/deepinvterdb.h: add routines for pulling Xft antialiasing
	and hinting options from the resource database.
	* src/deepinvtefc.c(_deepinvte_fc_patterns_from_pango_font_desc): apply settings
	from the resource database after applying settings from GTK+.
	* src/deepinvtefc.c(_deepinvte_fc_defaults_from_rdb): added, for adding default
	settings based on the resource database.

2003-04-27 nalin
	* src/deepinvtefc.c(_deepinvte_fc_defaults_from_gtk): complain when the installed
	version of GTK+ doesn't support reporting Xft antialiasing and hinting
	settings.

2003-04-25 nalin
	* src/deepinvte.c(deepinvte_sequence_handler_sf): freeze the window when scrolling
	down in a restricted scrolling area again.

2003-04-23 nalin
	* src/iso2022.c(_deepinvte_iso2022_state_set_codeset): save the new codeset.
	* src/iso2022.c(process_cdata): compare the new codeset to the name of
	the UTF-8 codeset instead of the local codeset to see if we need to
	notify callers of a change.

2003-04-23 nalin
	* src/deepinvte.c(deepinvte_sequence_handler_sf): don't use the window freeze count
	to check if it's safe to scroll using gdk_window_scroll(), require other
	parts of this widget to declare it unsafe for those cases.

2003-04-23 nalin
	* src/deepinvtexft.c(_deepinvte_xft_char_width): take an explicit XftFont instead
	of figuring out which one to use ourselves.
	* src/deepinvtexft.c(_deepinvte_xft_draw_text): pass the XftFont which we're already
	using to _deepinvte_xft_char_width to save a call to _deepinvte_xft_font_for_char.

2003-04-23 nalin
	* autogen.sh: accept libtool 1.5 in addition to 1.4 (#15968).

2003-04-23 nalin
	* src/deepinvte.c,src/deepinvte.h: (_deepinvte_terminal_accessible_ref): add.
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_new): call
	_deepinvte_terminal_accessible_ref to ensure that accessible signals are
	going to be emitted.

2003-04-23 nalin
	* src/dumpkeys.c: formatting fixup.
	* src/iso2022.c: formatting fixups.  Try using U+FFFF as the "invalid"
	marker character instead of '?', because it's actually invalid.
	* src/pty.c: formatting fixup.
	* src/reflect.c: formatting fixup.
	* src/ring.c: formatting fixup.
	* src/ssfe.c: formatting fixups.
	* src/trie.c: formatting fixup.
	* src/deepinvte.c: formatting fixups.
	* src/deepinvte.c(deepinvte_terminal_get_accessible): don't add a weak pointer to
	the AtkObject if it isn't a valid AtkObject.  Only emit text-changed
	signals if we managed to create a valid accessible peer.
	* src/deepinvteaccess.c: formatting fixups.
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_init): unset the EXPANDABLE
	Atk state.  Set the RESIZABLE state.
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_class_init): Remove
	spurious(?) call to bind_textdomain.
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_get_type): check if the
	accessible peer of our peer's ancestor is derived from GtkAccessible,
	and if it isn't derive from GtkAccessible instead of that.
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_get_type): register our
	factory type.
	* src/deepinvteaccess.c, src/deepinvteaccess.c: add DeepinvteTerminalAccessibleFactory.
	* src/deepinvtedraw.c: formatting fixup.

2003-04-23 nalin
	* src/deepinvte.c(deepinvte_terminal_background_update): always refetch the
	root pixmap if we don't currently have a background image (#111386).

2003-04-23 nalin
	* src/deepinvteaccess.c: implement an AtkComponent interface (part of
	#110770).
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_focus_in): set the focus
	state on the accessible peer (part of #110770).
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_focus_out): unset the focus
	state on the accessible peer (part of #110770).
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_init): connect to the widget's
	visibility-notify signals.
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_finalize): disconnect from
	the widget's visibility-notify signals.

2003-04-23 nalin
	* src/deepinvte.c(deepinvte_terminal_background_update): don't bother generating
	a new pixmap or panning the pixbuf -- we can use the desaturated
	pixbuf directly now (#111386).
	* src/deepinvte.c(deepinvte_terminal_paint): use the drawing offsets because we
	don't regenerate new background pixmaps when the window is moved.
	* src/deepinvte.c(deepinvte_terminal_draw_cells): add jittered bold text back in,
	fell out in the drawing overhaul (#111430).

2003-04-22 nalin
	* src/iso2022.c(_deepinvte_iso2022_fragment_input): account for valid CSI
	sequences which were missed earlier.

2003-04-22 nalin
	* src/deepinvte.c(deepinvte_terminal_eof): dispose of the PTY completely.
	* src/deepinvte.c(deepinvte_terminal_child_exited): dispose of the PTY completely.

2003-04-22 nalin
	* configure.in: add missing check for recvmsg.
	* gnome-pty-helper/gnome-login-support.c: formatting and spelling fixes.
	* gnome-pty-helper/gnome-login-support.c(n_read): reorganize.
	* gnome-pty-helper/gnome-login-support.c(n_write): add.
	* gnome-pty-helper/gnome-login-support.h: add prototype for n_write.
	* gnome-pty-helper/gnome-pty-helper.c: only define the I_SENDFD version
	of pass_fd() if I_SENDFD is defined, to clarify compile errors when it
	isn't defined.
	* src/pty.c(main): exercise session logging.
	* src/pty.c(_deepinvte_pty_open_with_helper): add more debug messages.

2003-04-22 nalin
	* src/iso2022.c(_deepinvte_iso2022_map_get): force visible widths to 2 columns
	for CJK maps which use 2 bytes per character.
	* src/iso2022.c(_deepinvte_iso2022_fragment_input): recognize CSI/OSC/PM
	sequences as control sequences and not raw text, allowing us to treat
	them specially later.
	* src/iso2022.c(process_control): pass CSI/OSC/PM sequences through
	unmodified (without going through maps).

2003-04-22 nalin
	* src/deepinvte.c(deepinvte_invalidate_cursor_once): don't bother doing anything if
	we're fully obscured (related to #102703).

2003-04-22 nalin
	* src/deepinvteapp.c(main): stop messing with fontconfig's list of font
	directories.

2003-04-22 nalin
	* configure.in: rework link order so that xft2 is linked before anything
	else.  You're still screwed if you link with both xft1 and xft2 libs,
	but maybe this'll help (#107285).

2003-04-22 nalin
	* src/deepinvteglyph.c: fix a couple of #errors.
	* src/deepinvte.c(deepinvte_invalidate_cells): if the area we're invading is on the
	edge, invalidate the edge as well.
	* src/pty.c: implement and use wrappers for read and write which handle
	EINTR and EAGAIN.
	* src/deepinvte.c(deepinvte_terminal_scroll_region): don't use gdk_window_scroll if
	the window is frozen for updates.
	* src/deepinvte.c(deepinvte_terminal_sequence_handler_sf): when scrolling down while
	we have a defined scrolling region, freeze the window to avoid flicker
	when we update the scrolling offsets (#108058).

2003-04-21 nalin
	* gnome-pty-helper/gnome-login-support.c(n_read): don't bail out if
	read() returns -1 and errno is either EINTR or EAGAIN, candidate fix for
	#107534.

2003-04-21 nalin
	* src/deepinvte.c(deepinvte_terminal_io_read): add a couple of assertions here
	just to be sure (#108066).

2003-04-21 nalin
	* src/pty.c(_deepinvte_pty_ptsname): don't depend on PATH_MAX being
	available and correct (#109805).
	* src/deepinvte.c(deepinvte_terminal_set_termcap): don't depend on PATH_MAX being
	available and correct (#109805).
	* src/deepinvte.c(deepinvte_terminal_io_read): fix signed/unsigned comparison
	(#108066).

2003-04-21 nalin
	* Makefile.am: add MESSAGE-OF-DOOM to EXTRA_DIST
	* src/keymap.c: make Alt+Return generate ESC newline (#108863).

2003-04-21 nalin
	* src/Makefile.am: drop unitable.KSC5601
	* src/iso2022.c: fixup comment re: KS X 1001 (#107119).
	* src/mkunitables.sh: add two characters from KS X 1001:1998 (#107119).

2003-04-21 nalin
	* src/deepinvte.c(deepinvte_terminal_eof): don't try to process incoming data if
	there isn't any (#110946).
	* src/deepinvtexft.c: mark a warning message for translation.
	* src/deepinvtegl.c: make the warning when glX isn't available debug-only.

2003-04-21 nalin
	* src/deepinvteglyph.c: use #if HAVE_DECL_XXX instead of #ifdef HAVE_DECL_XXX,
	noted by Bob Doan.

2003-04-20 nalin
	* src/deepinvtexft.c: work around for garbled glyphs when drawing runs of
	text using multiple fonts while mixing bitmap and antialiased fonts

2003-04-17 nalin
	* src/deepinvte.c: add missing prototype for deepinvte_terminal_process_incoming().

2003-04-17 nalin
	* src/deepinvteglyph.c(_deepinvte_glyph_get): quiet a compiler warning.
	* src/iso2022.c: use KSX-1001 instead of KSC-5601 for Korean (#107119),
	add maps for CNS 11643 planes 3,4,5,6,7 (can't test them, but hey).
	Rework so that we get the data before it's passed to g_iconv(), and
	return gunichars.
	* src/interpret.c: adapt to changes in the iso2022 interfaces.
	* src/deepinvte.c: adapt to changes in the iso2022 interfaces.
	* src/mkunitables.sh: add snippets for KSX 1001.
	* src/iso2022.txt: add iso-2022-cn example text.

2003-04-17 nalin
	* src/deepinvte.c(deepinvte_terminal_process_incoming): invalidate a larger
	rectangle to fix behavior wrt openi18n assertion 2.

2003-04-16 nalin
	* src/deepinvte.c(deepinvte_terminal_paint): fix logic error drawing the cursor
	which caused ALTGR characters to always be used.  Draw the preedit
	string in the right location.
	* src/deepinvte.c(deepinvte_invalidate_cursor_once): expose the visible width of
	the preedit string, not its length.

2003-04-15 nalin
	* src/deepinvteaccess.c: fix broken debug message.

2003-04-15 nalin
	* src/deepinvte.c: make row_data a structure containing an array instead of a
	simple array.  Add a field to row data structures which tracks whether
	or not we soft-wrapped from this line to the next one.  Make use of the
	field when copying text and selecting by "line" (#105189).
	* src/reflect.c: put the label in a scrolled window to avoid mad loops
	when we resize it to accomodate more text, which shrinks the terminal,
	which removes text from the label, which resizes it to be smaller, which
	gives the terminal more space, which adds text to the viewable area,
	which requires a bigger label, and so on.
	* src/deepinvte.c: move deepinvte_terminal_get_text_range logic into
	deepinvte_terminal_get_text_range_maybe_wrapped for internal use,
	deepinvte_terminal_get_text likewise.

2003-04-14 nalin
	* src/deepinvte.c: don't snap the beginning of selection to the next line in
	select-by-line mode.

2003-04-14 nalin
	* configure.in, src/deepinvteglyph.c: fix macro invocations so that when
	LCD and GRAY2/GRAY4 pixel modes are supported by freetype, we don't
	get confused by them.
	* src/deepinvtepango.c, src/deepinvtepangox.c: fix background scrolling.

2003-04-14 nalin
	* autogen.sh: require automake 1.6, 1.5 chokes on AM_LDFLAGS, which 1.7
	wants instead of LDFLAGS(!).  Require autoconf 2.52 or newer, because
	older versions bail on configure.in.
	* configure.in: Check if ft_render_mode_mono, FT_RENDER_MODE_NORMAL,
	FT_PIXEL_MODE_MONO, ft_pixel_mode_mono, FT_PIXEL_MODE_GRAY2,
	FT_PIXEL_MODE_GRAY4, FT_PIXEL_MODE_GRAY, ft_pixel_mode_grays,
	FT_PIXEL_MODE_LCD are declared.
	* src/deepinvte.c, src/deepinvteapp.c, src/deepinvtefc.c, src/deepinvtepango.c: handle being
	built with GTK+ 2.0 or 2.2.
	* src/deepinvtegl.c: disable for GTK+ < 2.2.0.
	* src/deepinvtepangox.c: use a PangoX context instead of a Pango context
	when determining font metrics.
	* src/deepinvteglyph.c: handle the twisty maze of load and render options and
	pixel modes various versions of freetype support.

2003-04-14 nalin
	* configure.in: disable pangox, xft, glx drawing if run invoked with
	the --without-x flag.
	* deepinvte.pc.in: include CFLAGS found by AC_PATH_XTRA when built with X.
	* src/iso2022.c(_deepinvte_iso2022_substitute_single): clean up and ensure
	that ambiguous widths are respected.
	* src/iso2022.c, src/iso2022.h: add _deepinvte_iso2022_unichar_width().
	* src/deepinvte.c: remove old xft2/xft1/pango/pangox/core drawing code,
	making draw the only supported method.  Remove most dependencies on
	gdkx and Xlib, except for root pixmap ID watching.
	* src/deepinvtedraw.c: only use pangox, xft if X_DISPLAY_MISSING is not
	defined.
	* src/deepinvtedraw.c, src/deepinvtedraw.h: add get_using_fontconfig() method.
	* src/deepinvte.c(deepinvte_terminal_get_using_xft): use
	_deepinvte_draw_get_using_fontconfig(), which is what apps really want to
	know when they call this function.
	* src/deepinvtegl.c: wrap in #ifndef X_DISPLAY_MISSING.
	* src/deepinvtepangox.c: wrap in #ifndef X_DISPLAY_MISSING.
	* src/deepinvtexft.c: wrap in #ifndef X_DISPLAY_MISSING.
	* src/deepinvteglyph.c(_deepinvte_glyph_cache_set_description): use horizontal
	advance instead of bitmap width when calculating display widths.
	Rename to _deepinvte_glyph_cache_set_font_description.

2003-04-09 nalin
	* src/deepinvte.c: add back some variables which are used after all.

2003-04-09 nalin
	* configure.in: add specific checks for PangoX and glX.
	* src/deepinvteft2.c, src/deepinvteft2.h: add drawing method using freetype and
	GdkRGB.
	* src/deepinvteglyph.c, src/deepinvteglyph.h: add.
	* src/deepinvtepangox.c, src/deepinvtepangox.h: add drawing method using PangoX.
	* src/deepinvtergb.c, src/deepinvtergb.h: add.
	* src/deepinvtegl.c, src/deepinvtegl.h: add placeholder drawing method using
	freetype and glX.
	* src/Makefile.am: add newly-added source files to libdeepinvte.la target.
	* src/deepinvtedraw.c, src/deepinvtedraw.h: add get_visual and get_colormap
	methods so that drawing methods can override the default visual and
	colormap.  Rename get_text_base() to get_text_ascent(), which is more
	correct.  Remove scroll(), which would just wrap gdk_window_scroll().
	* src/deepinvte.c: fix logic for choosing alternate render methods when
	DEEPINVTE_USE_XFT is "0".
	* src/deepinvteapp.c: add -- option to stop parsing options with getopt.
	* src/deepinvtefc.c: fix incorrect DPI read due to type mismatch (#109513).

2003-03-31  Laurent Dhima  <laurenti@alblinux.net>

	* configure.in: Added "sq" to ALL_LINGUAS.
	 
2003-03-26 nalin
	* src/Makefile.am: specify AM_CFLAGS and AM_LDFLAGS instead of CFLAGS
	and LDFLAGS so that automake 1.7 doesn't kick us to the curb

2003-03-13  Christian Rose  <menthos@menthos.com>

	* configure.in: Added "ml" to ALL_LINGUAS.

2003-03-07 nalin	
	* src/deepinvte.c(deepinvte_terminal_paint): adjust coordinates for the border when
	clearing rectangles.
	* src/deepinvteskel.c, src/deepinvteskel.h: add.
	* src/deepinvtedraw.c: use the skeleton drawing code.
2003-03-07 nalin	
	* src/deepinvte.c(deepinvte_terminal_visibility_notify): watch for Visibility
	events.
	* src/deepinvte.c(deepinvte_invalidate_cells,deepinvte_invalidate_all): don't synthesize
	an expose event if we're fully obscured, that's just silly.

2003-03-06 nalin	
	* src/deepinvte.c, src/deepinvte.h(deepinvte_terminal_set_background_tint_color): take a
	const GdkColor* instead of a non-const color.

2003-03-06 nalin	
	* python/deepinvte.defs: regenerate.
	* python/deepinvte.override: update for deepinvte_char_attributes rename.

2003-03-06 nalin	
	* src/deepinvte.c, src/deepinvte.h, src/deepinvteaccess.c: rename struct
	deepinvte_char_attributes to DeepinvteCharAttributes, fixup some docs.
	* doc/reference: finish up docs.

2003-03-05 nalin	
	* deepinvte.pc.in: add FT2_LIBS and FT2_CFLAGS to our libs and cflags.  Add
	xft >= 2.0 and fontconfig as hard requirements.

2003-03-05 nalin	
	* src/deepinvtedraw.c: don't spit out which rendering method we're using
	except in debug mode.

2003-03-05 nalin	
	* src/deepinvtepango.c, src/deepinvtexft.c: don't print "Bogus font." when we think
	the font metrics are screwy.

2003-03-05 nalin	
	* configure.in: require Xft2 and fontconfig, drop Xft1.  Require
	freetype2.
	* src/Makefile.am, src/xticker.c: add xticker, useless but interesting.
	* src/deepinvte.c, src/deepinvte.h: add deepinvte_terminal_set_scroll_background() to
	enable background scrolling (where supported by the drawing code).
	* src/deepinvteapp.c: set the tinting color to the default background color
	to see what that's like.  Add -s option to toggle scrolling backgrounds.
	* src/deepinvtefc.c, src/deepinvtefc.h: add.  For converting PangoFontDescriptions
	to sorted lists of FcPatterns suitable for passing to XftFontOpenPattern
	or FT_New_Face.
	* src/deepinvtedraw.c, src/deepinvtedraw.h: add.  New drawing layer.
	* src/deepinvtepango.c, src/deepinvtepango.h: add.  Drawing layer using Pango.
	* src/deepinvtexft.c, src/deepinvtexft.h: add.  Drawing layer using Xft2.
	* src/deepinvte.c: add render type DeepinvteRenderDraw for transitional period in
	preparation for nuking other drawing code.  Merge HAVE_XFT bits into
	HAVE_XFT2 areas.  Nuke Xft1-specific stuff.  Move drawing of lines
	and rectangles to dedicated functions.  Always call deepinvte_unichar_width()
	instead of g_unichar_iswide().

2003-03-04 nalin	
	* src/deepinvte.c(deepinvte_sequence_handler_set_title_internal): fix swap of
	one variable for another which prevented stripping of control chars,
	spotted by Nam SungHyun.

2003-03-04 nalin	
	* src/deepinvte.c(deepinvte_terminal_insert_char): wrap properly when a scrolling
	region is set (#107559).

2003-02-28  Takeshi AIHANA <aihana@gnome.gr.jp>

	* po/ja.po: Added Japanese translations from gnome-2-2.

2003-02-26 nalin
	* src/iso2022.c(_deepinvte_iso2022_substitute,_deepinvte_iso2022_substitute_single):
	force characters substituted through the ACS map to have width of 1.

2003-02-26 nalin
	* src/deepinvte.c(deepinvte_terminal_font_open_xft,deepinvte_terminal_font_open_pango):
	use an array of codepoints instead of a UTF-8 string so that we can
	check for lack of font coverage in Xft fonts.

2003-02-26 nalin
	* src/deepinvte.c: formatting fixups.

2003-02-26 nalin
	* src/deepinvte.c(deepinvte_terminal_font_open_xft,deepinvte_terminal_font_open_pango):
	patch from Jungshik Shin for detecting and handling fonts where ASCII
	characters are double-width (#106618)

2003-02-26  Taneem Ahmed  <taneem@eyetap.org>

	* configure.in:  Added "bn" to ALL_LINGUAS.

2003-02-25 nalin
	* src/deepinvteapp.c(main): take a shot at implementing xconsole-like
	functionality when started with the -C flag: we open /dev/console and
	TIOCCONS it, and just feed data to the widget until we lose ownership
	of the MIT_CONSOLE_$(hostname) clipboard.

2003-02-25 Samúel Jón Gunnarsson <sammi@techattack.nu>

	* configure.in: added "is" to ALL_LINGUAS.

2003-02-24 nalin
	* src/deepinvte.c(deepinvte_sequence_handler_window_manipulation): don't report the
	user-settable title and icon strings to applications, based on H D
	Moore's "Terminal Emulator Security Issues" (CAN-2003-0070).
	* src/deepinvte.c(deepinvte_sequence_handler_set_title_internal): strip out control
	characters just to be on the safe side.

2003-02-24 nalin
	* src/deepinvte.c(deepinvte_sequence_handler_decset_internal): home the cursor when
	we switch to the alternate screen (#105075).

2003-02-23  Duarte Loreto <happyguy_pt@hotmail.com>

        * configure.in: Added "pt" to ALL_LINGUAS.

2003-02-21  Metin Amiroff  <metin@karegen.com>

	* configure.in:  Added az to ALL_LINGUAS.

2003-02-20 nalin
	* src/keymap.c(_deepinvte_keymap_map): in debug mode, skip coverage assertions
	for specific keys (GDK_2 - GDK_8).
	* src/keymap.c: remove unshifted entries for GDK_2 - GDK_8 (#106667)

2003-02-20 nalin
	* src/deepinvte.c(deepinvte_terminal_im_commit,deepinvte_terminal_paste_cb): stop
	gratuitously resetting the IM context.
	* src/deepinvte.c(deepinvte_terminal_process_incoming): correctly determine when
	we have an IM context -- it should be iff we're realized.
	* src/deepinvte.c(deepinvte_terminal_key_press/release): only filter keypresses
	through the IM context if we're realized, otherwise it doesn't exist.

2003-02-20 nalin
	* src/deepinvte.c(deepinvte_terminal_paint): reverse that last change -- don't
	always assume proportional text.
	* src/deepinvte.c(deepinvte_sequence_handler_ta): eliminate dead code.

2003-02-20 nalin
	* src/deepinvte.c(deepinvte_terminal_draw_row): move the initial drawing x left
	whenever we back up to a previous cell to avoid drawing fragments.
	* src/deepinvte.c(deepinvte_terminal_paint): always assume non-monospaced text,
	because the "missing glyph" glyph consistently looks screwy otherwise.

2003-02-20 nalin
	* src/deepinvte.c(deepinvte_terminal_feed_child): don't reset the input method
	here -- it may be in the middle of something (Red Hat #81542).
	* src/deepinvte.c(deepinvte_terminal_im_commit): reset the input method when we
	get text committed (Red Hat #81542).

2003-02-19 nalin
	* src/deepinvte.c(deepinvte_terminal_focus_in,deepinvte_terminal_focus_out): if we're not
	currently realized, don't try to tell our IM context that our focus
	state changed, because we don't have one.  While we're at it, it's
	silly to try to force the cursor to be drawn when we're not realized,
	either.
	* src/deepinvte.c(deepinvte_terminal_background_update): disconnect self, just in
	case we were called directly while still queued, which would otherwise
	leak the source, leading to potential problems later (Red Hat #84368).

2003-02-19 nalin
	* src/deepinvte.c(deepinvte_terminal_scroll_window): use gdk_window_scroll if the
	first row to be scrolled is the first visible row, not just if it's the
	first row we ever saw (Red Hat #83472).

2003-02-19 nalin
	* src/deepinvte.c(deepinvte_terminal_button_press): grab input focus on button 1
	press (#106573, Red Hat #84384).

2003-02-19 nalin
	* src/deepinvte.c(deepinvte_terminal_sequence_handler_bt): add missing chunk of
	fix for backtab.

2003-02-19 nalin
	* src/deepinvte.c: turn on update debugging if DEEPINVTE_DEBUG_FLAGS includes
	"updates"

2003-02-19 nalin
	* src/keymap.c: add map entries for unmodified digit keypresses.

2003-02-19 nalin
	* src/deepinvte.c(deepinvte_terminal_match_add): use the default cursor by default,
	so that we don't look weird to people who aren't used to the cursor
	changing this way.
	* configure.in: forcibly define DEEPINVTE_DEBUG to "1" when we define it.

2003-02-19 nalin
	* src/deepinvteaccess.c: emit focus-event signals from the accessible peer
	when the widget receives focus-in and focus-out events, noted by
	Marc Mulcahy.

2003-02-18  Roozbeh Pournader  <roozbeh@sharif.edu>

	* configure.in: Added "fa" to ALL_LINGUAS.

2003-02-18 nalin
	* src/deepinvte.c, src/deepinvte.h: add deepinvte_terminal_match_set_cursor() (#105986).

2003-02-18 nalin
	* src/Makefile.am: add @LDFLAGS@ to all of the LDADD clauses, hopefully
	fixing #105415.

2003-02-17 nalin
	* src/deepinvte.c(deepinvte_terminal_sequence_handler_cs): recognize and discard
	invalid arguments (#57453).

2003-02-17 nalin
	* src/keymap.c: add map entries for Ctrl+digit keys (#106193, Red Hat
	#83563).

2003-02-17  Alessio Frusciante  <algol@firenze.linux.it>

	* configure.in: Added "it" (Italian) to ALL_LINGUAS.

2003-02-16  Dmitry G. Mastrukov  <dmitry@taurussoft.org>

	* configure.in: Added Belarusian to ALL_LINGUAS.

2003-02-14 nalin
	* src/deepinvte.c(deepinvte_terminal_sequence_handler_bt): fix to move back to the
	leftmost column if there are no previous tabstops, exercised by
	make menuconfig.

2003-02-14 nalin
	* src/deepinvte.c(deepinvte_terminal_background_update): handle pixbufs with
	n_channels != 3.

2003-02-14 nalin
	* src/interpret.c: handle width masks now that we're encoding widths for
	all characters.

2003-02-14 nalin
	* src/deepinvte.c: more comments to keep myself from getting confused later.

2003-02-13 nalin
	* src/deepinvte.c: change the coalescing timeout to 2ms.

2003-02-13 nalin
	* src/deepinvte.c(deepinvte_terminal_io_read): attempt to coalesce data received
	within about 10ms to reduce load on the X server on systems where the
	scheduler wakes us up as soon as we have a few bytes available.  Based
	on a suggested fix by msw.
	* src/deepinvte.c(deepinvte_terminal_io_read): never free buf, it's not a heap
	variable any more.  Spotted by msw.

2003-02-12 nalin
        * src/deepinvte.c(deepinvte_terminal_finalize): close fd leak.
        * src/deepinvte.c(deepinvte_terminal_fork_command): close potential fd leak.

2003-02-12 nalin
	* src/reflect.c(main): handle cases where the widget has no data and
	returns NULL when we ask for it.

2003-02-12 nalin
	* src/reflect.c(main): do a complete read of the widget before we
	start off in main to ensure we have accurate data.
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_update_private_data_if_needed):
	only attempt to free the previous snapshot if it existed.

2003-02-12 nalin
	* src/reflect.c(main): connect to signals before any get emitted.
	* src/deepinvteaccess.c: use a GString to store snapshot text so that we
	always have proper length information.

2003-02-12 nalin
	* src/reflect.c(text_changed_delete): spit out a warning if we receive
	an out-of-range text_changed::delete signal.

2003-02-11 nalin
	* src/genwidths, src/uniwidths: add data for tracking ambiguous-width
	Unicode characters.
	* src/iso2022.c, src/iso2022.h: add _deepinvte_iso2022_is_ambiguous() for
	checking if a character is ambiguous, and _deepinvte_iso2022_ambiguous_width()
	for guessing how wide it should be based on the current locale.  Rename
	_deepinvte_iso2022_get/set_width to ...encoded_width to clarify the intent,
	ditto for the related macros.
	* src/table.c,src/trie.c: use renamed macros for reading encoded widths.
	* src/iso2022.c(_deepinvte_iso2022_substitute_single,_deepinvte_iso2022_substitute):
	handle ambiguous widths properly, and always encode a width.
	* src/Makefile.am: use the default LDFLAGS, I think.
	* src/deepinvte.c,src/deepinvte.h: add deepinvte_terminal_set_background_tint_color().
	* src/deepinvte.c(deepinvte_terminal_unrealize): unhook from background update
	sources, because we may not have a display after that.
	* src/deepinvte.c(deepinvte_terminal_size_allocate): only queue a background update
	if we're in transparent mode and either we've been moved or we have no
	background yet.  If our size changed, force a repaint.
	* src/deepinvte.c(deepinvte_sequence_handler_window_manipulation): snip off the
	padding along the edges when responding to requests for the window size
	and location -- apps have no way to query it.
	* src/deepinvte.c(deepinvte_terminal_get_text_range): skip over fragments properly.
	* src/deepinvte.c(deepinvte_terminal_draw_row): skip over fragments properly.
	* src/deepinvte.c(deepinvte_unichar_width): rework in terms of the width checking
	in the iso2022 module for consistency.

2003-02-06  Christian Rose  <menthos@menthos.com>

	* configure.in: Added "id" to ALL_LINGUAS.

2003-02-03 nalin
	* src/deepinvte.c(deepinvte_terminal_size_allocate): suppress background updates if
	we haven't moved and the background image already exists (#104868).

2003-01-31 nalin
	* src/deepinvte.c(deepinvte_terminal_get_accessible): keep a weak pointer to the
	accessible peer instead of a static pointer (part of #104909).
	* src/deepinvte.c(deepinvte_terminal_finalize): if the accessible peer still exists,
	remove its weak pointer before attempting to unref it.
	* src/deepinvte.c: rename accessible_exists member to accessible_emit, which
	more accurately reflects its purpose.
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_update_private_data_if_needed):
	always update the cursor position, in case text was added or removed
	without the cursor itself moving.
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_get_text_somewhere): don't
	emit a warning when the caller attempts to read the Nth character when
	we have 0 to N-1, just return an empty string.
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_new): make the terminal peer
	a weak pointer (part of #104909).
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_finalize): if the terminal
	peer is not NULL, disconnect it as a weak pointer and don't bother
	disconnecting from its signals (part of #104909).  Add a debug message.
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_text_finalize):  Add a debug
	message.

2003-01-31 nalin
	* src/deepinvte.c(deepinvte_unichar_isgraphic): rename to deepinvte_unichar_is_graphic,
	to match conventions used elsewhere.
	* src/deepinvte.c(deepinvte_unichar_is_graphic): count 0xa3, 0x3c0, 0x2592,
	0x25ae, 0x25c6 as graphic characters.
	* src/iso2022.txt: add sample text using character set 0.

2003-01-30  Fatih Demir <kabalak@gtranslator.org>

	* configure.in: Added "tr" (Turkish) to the languages' list.

2003-01-30 nalin	
	* MESSAGE-OF-DOOM: added, for scaring people away.
	* deepinvte.spec: bump to 0.11.x for development.
	* src/mev.c(main): reset modes before quitting.
	* src/deepinvte.c(deepinvte_terminal_button_press): don't always extend selection
	when not in event mode.

2003-01-28 nalin	
	* configure.in: make debugging support an explicit option to configure.
	don't automatically enable debugging in maintainer mode.

2003-01-27 nalin	
	* src/deepinvte.c(deepinvte_terminal_realize): create the "invisible" cursor using
	a bitmap instead of a pixmap, changing it from a 1x1 black square to
	nothing.

2003-01-27 nalin	
	* src/deepinvte.c(deepinvte_terminal_decset_internal): make the various mouse event
	modes mutually-exclusive, because apps expect them to be (#104395).
	* src/deepinvte.c: add a prototype for deepinvte_terminal_background_update before
	it is used to silence a compiler warning.

2003-01-27 nalin	
	* src/deepinvte.c(deepinvte_terminal_realize): force a background update immediately
	when we realize instead of queuing it up (#104381).

2003-01-26  Daniel Yacob <locales@geez.org>

	* configure.in: Added "am" to ALL_LINGUAS.

2003-01-24 nalin
	* src/deepinvte.c(deepinvte_terminal_background_update): fix declaration order
	(#13795).

2003-01-24  Nam SungHyun  <namsh@kldp.org>

	* configure.in: Added "ko" to ALL_LINGUAS.

2003-01-23 nalin
	* src/caps.c, src/deepinvte.c: recognize and ignore attempts to set text
	properties 21 and 2L, whatever those are (possible workaround #104154).

2003-01-23 nalin
	* src/iso2022.c: accept "1" and "2" as aliases for "B" (#104257).

2003-01-23 nalin
	* configure.in: check for curses if we don't have ncurses (the order
	is ncurses, curses, libtermcap), as Solaris has neither ncurses nor
	libtermcap.  Reported by Brian Cameron.
	* src/keymap.c, src/ssfe.c: accept either curses or ncurses as
	equivalent.

2003-01-22 nalin
	* src/Makefile.am, src/mev.c: add mev.
	* src/deepinvte.c(deepinvte_sequence_handler_clear_screen): don't home the cursor
	automatically.
	* src/deepinvte.c(deepinvte_terminal_button_pressed): fix sense of shift overriding
	event mode.  Ignore double- and triple-click in event mode.
	* src/deepinvte.c(deepinvte_terminal_scroll): in event mode, send button release
	events to the terminal if it's expecting them.
	* src/deepinvte.c(deepinvte_terminal_send_mouse_button_internal): clamp coordinates
	to existing cells.
	* src/deepinvte.c(deepinvte_terminal_maybe_send_mouse_drag): compare integral cell
	locations, not floating point, when choosing whether or not to drop
	events in cell tracking mode.  Don't lose the modifiers.
	* src/deepinvte.c(deepinvte_terminal_motion_notify): don't autoscroll in events
	mode.

2003-01-22 nalin
	* src/caps.c: accept OSC{number};{string}ST as set-text-parameters,
	per XTerm docs (part of #104154).
	* src/keymap.c: revert change to prepend "1;" to keys with
	modifiers (#104139).

2003-01-22  Christian Rose  <menthos@menthos.com>

	* configure.in: Added "mn" to ALL_LINGUAS.

2003-01-21 nalin
	* src/deepinvte.c: streamline background images and transparency handling,
	should use less memory now.

2003-01-20 nalin
	* src/reflect.c: add some debugging messages if REFLECT_VERBOSE is
	set in the environment.

2003-01-20 nalin
	* src/Makefile.am, src/reflect.c: add reflect-text-view, for testing
	with GtkTextView for sanity's sake.

2003-01-20 nalin
	* src/reflect.c: account for atk_text_get_text() being 0-clean.

2003-01-20 nalin
	* configure.in, src/Makefile.am, src/reflect.c: try to build reflect
	with both deepinvte and libzvt, building a useless binary if libzvt isn't
	available.

2003-01-20 nalin
	* src/deepinvte.c: colors 90-97 and 100-107 are bold colors, noted and patched
	by Matthijs Melchior (#103874).

2003-01-19  He Qiangqiang  <carton@linux.net.cn>

	* configure.in: Added "zh_CN" (Simplified Chinese) to ALL_LINGUAS.

2003-01-19  Marius Andreiana <marius galuna.ro>

	* configure.in: added 'ro' to ALL_LINGUAS

2003-01-18 nalin
	* src/deepinvteaccess.c(update_private_data_if_needed): if the caret is past
	the end of the text, count unichars properly.  Compute the caret
	location correctly.
	* src/reflect.c: handle text-caret-moved signals and display the caret.

2003-01-18 nalin
	* src/iso2022.c: update copyright dates.
	* src/reflect.c: add.
	* src/Makefile.am: add reflect (noinst).
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_get_text): always return a
	string, even if it's zero-length.  Properly detect and handle requests
	that go right up to the last byte.

2003-01-18 Andras Timar  <timar@gnome.hu>

	* configure.in: Added "hu" to ALL_LINGUAS.

2003-01-17 nalin
	* src/deepinvte.c(deepinvte_terminal_set_size): emit a "text-modified" signal,
	because what you see changes when you resize the terminal.

2003-01-17 nalin
	* src/deepinvte.c(deepinvte_terminal_paint): don't draw cursors below or above the
	screen, correctly compute the clear area when drawing the cursor,
	if we're ignoring padding in general because we're monospaced, also
	ignore it when drawing the character under the cursor.
	* src/deepinvte.c(deepinvte_terminal_io_read): eliminate dead code.

2003-01-17 nalin
	* src/keymap.c(_deepinvte_keymap_map): if we don't find an entry for the
	requested key, and the terminal type is "xterm", retry using
	"xterm-xfree86", possible fix for #103713.
	* src/deepinvte.c(deepinvte_terminal_draw_row): fix handling of items with
	width != 1 when computing runs.

2003-01-17 nalin
	* src/iso2022.c: fix boneheaded "config.h" instead of "../config.h"
	include, pointed out by Dan Mills and Brian Cameron.

2003-01-16 nalin
	* configure.in: fix test for whether or not we need to check for termcap
	* src/Makefile.am: override default includes to not prepend "." to the
	include path, so that we can include the system <termcap.h> properly
	* src/keymap.c: define the ncurses scratch buffer for use when we're
	using termcap

2003-01-16 nalin
	* configure.in: actually disable attempts to build python bindings if
	pygtk-2.0 isn't found (#103676)

2003-01-14 nalin
	* src/keymap.c(_deepinvte_keymap_key_add_key_modifiers): if a key sequence
	which needs modifiers doesn't have a numeric part, add "1" as the
	numeric part before adding the modifiers.  Spotted by msw.

2003-01-13 nalin
	* src/ring.c, src/ring.h: add _deepinvte_ring_insert_preserve(), which
	scrolls lost items off the top instead of the bottom, as
	_deepinvte_ring_insert() does.
	* src/slowcat.c (catfile): check that we didn't read an EOF before
	attempting to write it.  Skip the more complicated checks and just
	check that the file pointer isn't stdin before closing it.
	* src/ssfe.c: cleanups.
	* src/deepinvte.c(deepinvte_sequence_handler_sf): add lines to the scrollback area
	when scrolling is restricted but the top line of the area is the
	topmost visible line (Red Hat #75900).

2003-01-13 nalin
	* src/nativeecho.c, src/utf8echo.c: don't switch terminal modes before
	or after echoing bytes -- doing so confuses me now.
	* src/deepinvte.c: make use of '?' to mark invalid data a compile-time define.
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_text_scrolled): properly
	handle scrolling events with delta less than the window size (more
	of #95901).
	* src/deepinvteaccess.c(deepinvte_terminal_accessible_finalize): disconnect
	from text-inserted, text-deleted, text-modified, text-scrolled,
	cursor-moved, window-title-changed on finalize.
	* src/deepinvte.c(deepinvte_terminal_key_press,deepinvte_terminal_key_release,
	deepinvte_terminal_button_press,deepinvte_terminal_button_release,
	deepinvte_terminal_motion_notify,deepinvte_terminal_focus_in,deepinvte_terminal_focus_out,
	deepinvte_terminal_scroll): track event modifiers in an object-local modifier
	variable.
	* src/deepinvte.c(deepinvte_terminal_key_press): always steal key events from the
	input method if the meta key is down (#96006).  Don't munge the cursor
	or keypad modes before passing them to the keymapping routines.  Stop
	overriding the cursor mode on NumLock (doesn't appear to work as
	documented in other terminals, needed to modify the keymap mode anyway
	(#96364)).
	* configure.in: define HAVE_XFT whenever HAVE_XFT2 is defined -- they're
	more or less compatible (#103130).

2003-01-10  Abel Cheung  <maddog@linux.org.hk>

	* configure.in: Added "zh_TW" to ALL_LINGUAS.

2003-01-10  Dmitry G. Mastrukov  <dmitry@taurussoft.org>

	* configure.in: Added Russian to ALL_LINGUAS.

2003-01-09  nalin
	* configure.in: disable the python bindings if we can't find python,
	from Brian Cameron.

2003-01-09  nalin
	* src/deepinvte.c: don't just skip reading data if selection is in progress --
	we wedge if we do that (#101739).  Instead, temporarily stop reading
	from the child pty.
	* src/deepinvte.c(deepinvte_terminal_open_font_xft): if we get NULL when matching
	fonts, use the desired pattern's name when displaying an error,
	preventing a NULL dereference (#96769).
	* configure.in: make building of python modules depend on configure
	having been run with --enable-python. make --enable-python the default.
	Fix an indentation error in the version check which chokes Python 2.2.2.
	* src/deepinvte.h, src/deepinvte.c: add new signals to DeepinvteTerminalClass (NOTE: may
	break ABI, so might as well add some padding)
	* src/deepinvteaccess.c: be more precise about locations in text_changed
	signals (part of #95901)
	* src/deepinvte.c: get more selective about when we consider it necessary to
	emit text-insert and text-delete events.

2003-01-07  nalin
	* src/deepinvte.c(deepinvte_terminal_key_press): Only suppress meta-sends-escape on
	Backspace if backspace is mapped to the delete sequence. (#100635)

2003-01-07  nalin
	* src/deepinvte.c(deepinvte_terminal_setup_background): Use a lookup table
	instead of a mess of floating point math when desaturating images.

2003-01-06  nalin
	* src/deepinvte.c(deepinvte_terminal_init): Add the periodic blinking refresh
	with the normal timeout instead of 0 to avoid wedging when we get
	created without focus.  Fix suggested by Dennis Haney (#102701).

2003-01-06  nalin
	* src/deepinvte.c: Use a simple XftPatternGetString/GetDouble pair instead
	of XftNameUnparse, which isn't in older versions of Xft (#101142).
	* src/deepinvte.c: Add a flag to DeepinvteTerminalPrivate which we can use to keep
	track of modifications, particularly if they remove text, and toggle
	it in several sequence handlers.
	* src/deepinvte.c(deepinvte_terminal_process_incoming): Also emit the "contents
	changed" signal when the modified flag is TRUE, not enough to fix
	#95901, but at least making some forward progress.

2003-01-05  Pauli Virtanen <pauli.virtanen@hut.fi>

	* configure.in (ALL_LINGUAS): Added "fi" (Finnish).

2003-01-04  Stanislav Visnovsky  <visnovsky@nenya.ms.mff.cuni.cz>

	* configure.in: (ALL_LINGUAS) Added sk (Slovak).
	* po/sk.po: Added Slovak translation.

2003-01-02  nalin
	* configure.in: look for libncurses or libtermcap
	* deepinvte.pc.in: include other libraries (ncurses, termcap, socket,
	whatever) in the list of libraries.
	* src/keymap.c(_deepinvte_keymap_map): for Home and End, consult libncurses
	or libtermcap if we have no hard-wired mapping and there's none in the
	termcap file.  Should fix #100472, even in cases where Home and End
	vary wildly from what I've got on my box.
	* src/keymap.c: rename cursor/fkey_normal to cursor/fkey_default,
	which makes a little more sense.

2003-01-02  Zbigniew Chyla  <cyba@gnome.pl>

	* configure.in: (ALL_LINGUAS) Added pl (Polish).

2002-12-22  Artis Trops  <hornet@navigator.lv>

	* configure.in: Added Latvian (lv) to ALL_LINGUAS.

2002-12-19  Yanko Kaneti <yaneti@declera.com>

	* configure.in: (ALL_LINGUAS) Added Bulgarian (bg).

2002-12-18  nalin
	* configure.in: complain if Xft2 and Xft aren't found.
	* src/deepinvte.c (deepinvte_terminal_paint): if we're not double-buffered, clear
	the drawing area before we draw text.
	* src/deepinvteapp.c: add -2 to toggle double-buffering.

2002-12-16  nalin
	* src/deepinvte.c (deepinvte_terminal_key_press): wire Shift+Home/Shift+End to
	scroll-to-top and scroll-to-bottom.

2002-12-13  nalin
	* src/buffer.c: add a short test program.
	* src/iso2022.c: use hard values instead of GDK defines in the 0 map.
	Add _deepinvte_iso2022_substitute_single() for performing a single mapping
	operation.
	* src/deepinvte.c: use _deepinvte_iso2022_substitute_single() instead of a local
	mapping table when mapping line-drawing charset data, simplifies	
	maintenance of the mapping.

2002-12-12  Pablo Saratxaga <pablo@mandrakesoft.com>
	* configure.in: Added Catalan (ca), Spanish (es)
	and Hebrew (he) to ALL_LINGUAS

2002-12-11  nalin
	* configure.in: define DEEPINVTE_USE_GNOME_PTY_HELPER if use of the helper
	is enabled at compile-time (enabled by default).
	* src/iso2022.c(_deepinvte_iso2022_substitute): force characters received in
	the line-drawing map to have width = 1 (more #99603), so that we can
	distinguish them from line-drawing characters received in eucXX, which
	have width = 2.
	* src/deepinvte.c(deepinvte_terminal_insert_char): when mapping from line-drawing
	to gunichars, force a width of 1.
	* src/deepinvte.c(deepinvte_terminal_process_incoming): extend the bounding box
	for updates one cell further to the right, in case the cursor is in
	a cell which contains a wide character.
	* src/pty.c(_deepinvte_pty_start_helper): spit out a warning if the helper
	isn't installed.
	* src/pty.c: don't compile in any gnome-pty-helper-specific code if
	DEEPINVTE_USE_GNOME_PTY_HELPER isn't defined.

2002-12-10  nalin
	* src/buffer.c, src/buffer.h: centralize buffer length sanity checks,
	add some utility functions for stuffing things into buffers and pulling
	them back out.
	* src/debug.c, src/debug.h: add a lifecycle debug class, for tracking
	down initialization order weirdness.
	* src/pty.c: try to check that we can run the pty helper before
	trying to run it, to avoid SIGPIPE failures when it's not installed.
	* src/deepinvte.c: never grab focus -- let the shell app deal with it.
	Return TRUE from mouse motion and press/release events to keep them
	from being passed up. (#101089)

2002-12-09  nalin
	* configure.in: add "uk" to the list of languages.
	* src/deepinvte.h: remove the alternate attribute bit -- it's no longer
	meaningful.
	* python/deepinvte.override: remove the alternate attribute, add the
	strikethrough attribute.
	* src/deepinvte.c (deepinvte_terminal_insert_char): perform drawing character set
	to Unicode mapping at insertion time if the alternate attribute is set,
	otherwise discarding the attribute.  If the character being inserted is
	a graphic character, force its width to 1 or 2 depending on the current
	codeset (#99603).
	* src/deepinvte.c (xlfd_from_pango_font_description): take advantage of
	XftXlfdParse if we were built with Xft, as it appears to handle family
	aliases.
	* src/deepinvte.c (deepinvte_terminal_draw_graphic): decide what to draw using
	Unicode code points (instead of reverse mappings to drawing set), and
	implement the double-thick versions of many of the existing glyphs.
	Return a boolean indicating whether or not we drew something.
	* src/deepinvte.c (deepinvte_terminal_draw_row): if deepinvte_terminal_draw_graphic()
	returns FALSE, try to draw the graphic character using the current font.
	* src/deepinvte.c (deepinvte_terminal_paint): if deepinvte_terminal_draw_graphic()
	returns FALSE, try to draw the graphic character using the current font.
	* src/caps.c: add the undocumented default 0 to the OSC set text
	parameters sequence (#100468).

2002-12-03  nalin
	* README: updates.
	* src/iso2022.c, src/iso2022.h: add a width mask for overriding widths
	for ambiguous Unicode characters, and _deepinvte_iso2022_get_width() for
	reading the width, using unused bits in Unicode in a manner similar to
	http://www.cl.cam.ac.uk/~mgk25/ucs/iso2022-wc.html
	* src/table.c,src/trie.c: strip out iso2022 widths when extracting
	parameters of control sequences.
	* src/deepinvte.c: heed iso2022 widths when inserting characters into the
	screen buffer, but clear then before storing them so that copy and
	paste will continue to work.
	* src/matcher.c, src/matcher.h: add matcher, a wrapper for table and
	trie, and move _deepinvte_table_narrow_encoding and _deepinvte_table_wide_encoding
	to this module.

2002-12-03  nalin
	* src/pty.c: if TIOCSCTTY is defined, use it, even if it's redundant.

2002-12-02  nalin
	* po: update-po
	* src/utf8echo.c: change the default from resetting to the terminal's
	default encoding before exiting to leaving it alone.  Don't mess with
	the terminal's encoding if stdout isn't connected to a terminal.
	* src/nativeecho.c: add, for printing random bytes.

2002-12-02  nalin
	* src/deepinvte.c: don't zero-fill rows, space-fill them.
	* src/deepinvte.c(deepinvte_terminal_is_word_char): Don't just fail if the
	word_chars array doesn't exist.

2002-12-02  nalin
	* acinclude.m4: add AC_CHECK_CC_OPT from ac-archive.
	* configure.in: check for cfmakeraw, sys/select.h, compiler support
	for -std= (#99698)
	* doc/boxes.txt: change reference to online Docbook reference to the
	charts at the Unicode web site.
	* src/dumpkeys.c: make a best-effort at making a terminal raw on systems
	where cfmakeraw() isn't available, from patch by Brian Cameron.  Wait
	for up to 1/50 of a second for more bytes we'll consider to be part of
	a sequence.
	* src/pty.c(getpt): ensure that the new terminal is opened in non-
	blocking mode.
	* src/trie.c: use g_unichar_digit_value() instead of subtracting '0'.
	* src/deepinvte.c: don't declare the xft_textitem member on non-Xft2 systems,
	because it uses an Xft2-specific type (#99685).
	* src/deepinvteapp.c: add $pkgdatadir/fonts to the font path for testing.

2002-11-25  nalin
	* src/deepinvte.c: fix mapping of Unicode code chars 0x252c and 0x2534 which
	incorrectly mixed them up (#99474).
	* src/iso2022.c: fix mapping of 'v' and 'w' from special graphics to
        Unicode, which masked the above bug.

2002-11-25  nalin
	* src/deepinvte.c: fix cd() to clear using the current colors.

2002-11-25  nalin
	* termcaps/xterm: add ta back in -- it's not a key sequence.

2002-11-25  nalin
	* src/deepinvte.c: fix cd() to clear to the right of the cursor on the current
	line instead of the entire line (#98844).

2002-11-25  nalin
	* src/deepinvte.c: add keyboard debug messages when we change keyboard modes.
	* termcaps/xterm: remove kh definition.

2002-11-25  nalin
	* src/keymap.c: make keypad arrow keys follow cursor mode (#98604).

2002-11-25  nalin
	* src/keymap.c: sort out when we add modifiers to keys (#98094).  Fix
	Alt+Tab.
	* termcaps/xterm: remove ta definition.

2002-11-25  nalin
	* src/debug.c, src/debug.h: add keyboard debugging class.
	* src/dumpkeys.c: refresh on Ctrl-L, reset on 'r'.
	* src/keymap.c, src/keymap.h: add more setting combinations, and a
	simplistic check for more complete coverage.
	* src/deepinvte.c: add debug messages for keyboard handling.  Improve
	detection of invalid coordinates as a signal that no text is selected
	or hilited (#98946).
	* termcaps/xterm.baseline: add a baseline copy of xterm from my termcap,
	so that I can diff it more easily.
	* termcaps/xterm: remove key definitions -- xterm's way more complicated
	than the capability strings suggest.
	
2002-11-22  nalin
	* configure.in: incorporate more correct check for the right version of
	gtk-doc (#99314).

2002-11-15  Hasbullah BIn Pit <sebol@ikhlas.com>

        * configure.in: Added "ms" to ALL_LINGUAS.

2002-11-11  nalin
	* src/deepinvte.c: ensure that when we select by line, we include all of the
	last line, even if it's past the edge of the screen.  Snap selection to
	the beginning or end of a line when selecting lines which don't exist.
	Only strip off whitespace if there's nothing but whitespace to the right
	of the selection.  Chuck the non-wrapping selection code.

2002-11-11  nalin
	* src/deepinvte.c: properly set the "selecting" flag again when we start
	selection (#97923).

2002-11-11  nalin
	* src/deepinvte.c: rework selection so that word- and line-based selection
	can wrap like XTerm does (#97057,#97719).

2002-11-07  nalin
	* src/deepinvte.h: doc fixes.
	* src/dumpkeys.c: use the older alternate-screen decset value.
	* src/deepinvte.c: fixup screwups on extending selection (#97118).

2002-11-05  nalin
	* src/deepinvte.c: handle end-of-line selection correctly.  Stop highlighting
	selection on click, but don't lose it until new text is selected
	(#97117).
	* python/deepinvte.override: fix binding for set_colors() to properly take a
	list of colors for the palette (#97682).
	* src/deepinvte.c, src/deepinvte.h: add increase-font-size and decrease-font-size
	to allow mimicking XTerm's behavior on Shift/Control+KP_Add/KP_Subtract
	* src/deepinvteapp.c: handle increase-font-size and decrease-font-size.

2002-11-05  Abi Brady  <morwen@evilmagic.org>
	* src/deepinvte.c: Add and implement the strikethrough attribute.
	Change underline to be drawn using the ascent, rather than
	arbritarily putting it two lines above the bottom of the
 	charcell - looks much better with large fonts.

2002-11-04  nalin
	* NEWS: be more verbose.
	* README: add more items to the TODO list so that I don't forget them.
	* src/deepinvte.c: ifdef out some of the selection code.

2002-10-30  nalin
	* src/buffer.c, src/iso2022.c, src/deepinvteaccess.c: add ident tags.
	* src/deepinvte.c: don't scroll-to-bottom if we're selecting (#97923).

2002-10-30  nalin
	* src/deepinvteapp.c: implement iconify, deiconify, raise, lower, maximize,
	restore, refresh, resize, and move signals.
	* src/deepinvte.c: add deepinvte_terminal_match_remove().
	* src/deepinvte.c (deepinvte_sequence_handler_cb): clear the current column in
	addition to columns to the left, spotted by Sam Varshavchik.
	* src/deepinvte.c:  Use g_array_set_size() to clear arrays instead of
	removing each element.  Properly initialize new columns with just the
	default colors and not other attributes (#96978).
	* src/deepinvte.c (deepinvte_sequence_handler_ta): revert to non-overwriting tabs,
	otherwise we got occasional drawing artifacts.

2002-10-30  Abi Brady  <morwen@evilmagic.org>

	* src/deepinvte.c, src/deepinvte.h : Support dim (halfbright) colours. All the
	infrastructure for this was here already (apart from making sure bold
	and half are mutually exclusive).  Add API set_color_dim, and let
	set_colors take a palette of size 24.

2002-10-29  Abi Brady  <morwen@evilmagic.org>
	* src/iso2022.c (_deepinvte_iso2022_map_[J4]): Map to UCS, not keysyms.
	(which differ > 0xff).

2002-10-28  Abi Brady  <morwen@evilmagic.org>
	* src/deepinvte.c: Add line-drawing representation for full block. Draw 
	U+23BA-23BD. Fix drawing of U+23BD (scan line 9) and U+2592 
	(checkerboard) to use bottom line of the charcell, not the top line of 
	the one below.
	* src/iso2022.c: Complete DEC Special Graphics to Unicode map.

2002-10-25  nalin
	* src/deepinvte.c (deepinvte_terminal_match_check_internal): snip off final
	newlines when we're matching, they're usually not wanted.

2002-10-24  nalin
	* src/pty.c, src/pty.h: replace the simpler pty_open() function with
	a logging version, adding the ability to specify a startup directory
	(Red Hat #76529).
	* src/deepinvte.c, src/deepinvte.h: replace the simpler fork_command() function with
	a logging version, adding the ability to specify a startup directory
	(Red Hat #76529).
	* src/deepinvteapp.c: modify call to handle new fork_command().
	* python/deepinvte.defs: update as above.
	* python/deepinvte.override: modify call to handle new fork_command(), adding
	an optional "directory" argument.

2002-10-23  nalin
	* src/deepinvte.c: refactor the selection code, cleaning up when selection is
	cleared/started/extended (#95783).

2002-10-22  nalin
	* src/deepinvte.c: rework how wide characters are stored to allow storing
	tabs (#95958).

2002-10-21  nalin
	* python/deepinvte.override: wrap deepinvte_terminal_get_text() and
	deepinvte_terminal_get_text_range().  Based on patch from ha shao (#96230).

2002-10-21  nalin
	* src/deepinvte.c, src/deepinvte.h: add a user pointer argument to get_text
	callbacks (#96230).
	* src/Makefile.am: bump shared library version because we changed
	a public function's signature.  Take the opportunity to replace padding
	fields which had previously been used up.

2002-10-21  jacob berkman  <jacob@ximian.com>
	* src/Makefile.am (EXTRA_DIST): include decset, osc, and window

2002-10-18 nalin
	* src/iso2022.c: use character constants instead of hex constants.
	* src/iso2022.txt: add more illustrations.
	* src/decset: scriptlet to save some typing.
	* src/deepinvte.c: zero-terminate window and icon title strings again.
	* src/decset, src/osc, src/window: add.

2002-10-18 nalin
	* src/keymap.c: add a mapping for the escape key.

2002-10-18 nalin
	* src/deepinvte.c: implement decset 42 (enable/disable NRC processing), but
	enable it by default.  Implement decset 44 (margin bell).
	* src/deepinvte.c: do not trust the event->string.  Use gdk_keyval_to_unicode
	and the built-in keymapping to cope with the weirdness.  Extend the
	range of characters we controlify from 0x40-0x60 to 0x40-0x7f so that
	lower-case ascii chars controlify (not a word, I know).
	* src/keymap.c: add map entries for GDK_Return and GDK_KP_Enter for
	GDK_CONTROL_MASK = cr, normal = lf.

2002-10-18 nalin
	* src/deepinvte.c: make sure that strings passed to a commit signal are zero-
	terminated (#96131).
	* python/Makefile.am: install the module in site-packages instead of a
	subdirectory, which doesn't work on my system.

2002-10-17 nalin
	* src/deepinvte.c: remove deepinvte_terminal_update_scroll_delta, which only did
	things deepinvte_terminal_adjust_adjustments already did and was only called
	immediately after.  Fill newly-added lines with the current attributes
	if the current background isn't the default color (Red Hat #73853).
	Implement ignored DECSET settings, so that we don't mistakenly complain
	about settings not being implemented yet when we actually just want to
	ignore them.
	* deepinvte.spec: 0.9.2

2002-10-17 nalin
	* src/deepinvte.c: force the first cursor redraw after focus-in to always be
	in the foreground color (Red Hat #75908).

2002-10-17 nalin
	* src/deepinvte.c (deepinvte_terminal_insert_char): force invalidation mode if
	we're in insert mode to get the entire line redrawn.  Spotted by msw.

2002-10-17 nalin
	* configure.in: clean up tests for wint_t.  Patch from Brian Cameron.

2002-10-17 nalin
	* src/pty.c: close a possible race on systems where pty initialization
	requires more than just opening the pty (for example, Solaris).  Spotted
	by Brian Cameron.
	* src/utf8echo.c: don't reset to iso-8859-1 unless -r is used.

2002-10-16 nalin
	* src/deepinvte.c: remove a bogus assertion for a case which we were already
	handling a little further down (incorrectly triggered by autowrap).

2002-10-16 nalin
	* src/deepinvte.c: adjust our adjustments whenever a line might scroll off
	the top of the buffer.  Fix computation of the new insertion delta to
	ensure that it never goes below the scroll delta, which should fix the
	resizing crashes (#94509, #95187, Red Hat #75871), and add some debug
	assertions to verify this.
	* configure.in, python/Makefile.am: build the python bindings as a
	library, not a binary with wacky ldflags.

2002-10-15 nalin
	* src/deepinvte.c: don't try to close the pty at finalize time if we didn't
	open it.  Patch from ha shao.
	* src/keymap.c, src/keymap.h: move the addition of modifiers into a
	separate function.  Add the function key strings from terminfo for
	fkey_sun and fkey_hp cases.  Make control+F1 = F13 only in vt220 mode.
	* src/deepinvte.c: apply modifiers to function keys in normal and legacy
	modes.

2002-10-14 nalin
	* src/deepinvte.c: add super-bogus bold text mode (Red Hat #74779).

2002-10-14 nalin
	* src/caps.c: recognize CSI-r (with no arguments) as resetting the
	scrolling region in XTerm emulation (Red Hat #75902).

2002-10-14 nalin
	* src/keymap.c: add mappings for GDK_Page_Up and GDK_Page_Down,
	missed in the conversion.
	* src/deepinvte.c: steal GDK_KP_{Add,Subtract,Multiply,Divide} from the
	input methods (Red Hat #75207).

2002-10-14 nalin
	* configure.in: more $pkglibdir -> $libexecdir fixing.
	* doc/Makefile.am: add rules for generating ps and text versions of the
	ctlseqs docs.
	* doc/reference/tmpl/deepinvte.sgml: add snippet for "commit".
	* python/python/deepinvte.defs: update to add a binding for
	deepinvte_terminal_fork_logged_command().
	* src/buffer.h: add a warning comment that these are private interfaces.
	Wrap declarations in G_BEGIN_DECLS/G_END_DECLS.
	* src/caps.h: add macros for the SS2/SS3 sequences.
	* src/marshal.list: add a marshaller for the "commit" signal.
	* src/keymap.c, src/keymap.h: move the getting-more-convoluted
	keypress-handling code to a shell that parses tables of static info.
	* src/deepinvte.c: use the keymap for most non-printable keys.  Add a "commit"
	signal to allow an app to just use the terminal for displaying data and
	grabbing input (missing functionality noted by ha shao).  Obey the
	application's desired meta-sends-escape setting.  Recognize HP function
	key mode.  Recognize and handle legacy XTerm function key mode.  Force
	a redraw if the child application tries to switch to 80/132 columns,
	even though we don't usually let them succeed.  Don't try to send
	keystrokes to the child pty when there is no child pty.  Don't convert
	final whitespace to newlines when copying text (Red Hat #74611).
	* python/cat.py: test program for running without a command.
	* termcaps/xterm: change the definitions for ku/kd/kl/kr to match
	XTerm in normal cursor mode instead of application cursor mode.

2002-10-11 nalin
	* src/deepinvte.c: properly distinguish cursor key mode and keypad key mode,
	obey application mode for cursor keys (#92941).
	* src/pty.c: reset signal handlers before exec() (Red Hat #75341).

2002-10-11 nalin
	* src/trie.c: change the typedef of wint_t here to match deepinvte.c (now
	a gunichar instead of a long).  Spotted by Brian Cameron.

2002-10-11 Brian Cameron <Brian.Cameron@sun.com>
	* configure.in: Changed to that wchar.h is included when checking for
	wint_t on Solaris.  This was needed because on Solaris wint_t is defined
	to be a long, and in deepinvte.c its definition was recently changed to be a
	gunichar.  This caused the compile to break on Solaris.

2002-10-10 nalin
	* configure.in, src/pty.c, gnome-pty-helper/Makefile.am: fix the bits
	I missed when fixing #95085.

2002-10-10 nalin
	* src/deepinvteapp.c, python/deepinvte-demo.py: allow specifying the scrollback
	buffer size.
	* src/deepinvte.c: if we don't have wint_t, typedef wint_t as a gunichar,
	not a long.

2002-10-09 nalin
	* src/buffer.c, src/buffer.h: add.
	* src/interpret.c, src/deepinvte.c: use _deepinvte_buffer structures instead of
	char arrays with separate lengths.  Use a scratch buffer for holding
	the results of conversions.
	* src/deepinvte.c: separate the pango and pangox drawing paths so that they're
	easier to tweak and compare to each other.
	* src/deepinvte.c: ditch the smooth scrolling change, which won't work right
	anyway (expose events don't get processed until after we finish
	processing a chunk of data unless we explicitly request it, so using a
	bbox is both simpler and faster).  Use a mask when creating the cursor
	we use for hiding the cursor.

2002-10-09 nalin
	* deepinvte.spec, gnome-pty-helper/Makefile.am: install gnome-pty-helper into
	the libexecdir, not pkglibdir (#95085).
	* src/deepinvte.c: obey smooth/jump scrolling options, default is jump scroll.

Mon Oct  7 14:53:12 2002  Owen Taylor  <otaylor@redhat.com>
	* src/deepinvte.c (deepinvte_font_match): Fix over-aggressive 
	Xft => Fc conversion - need to call XftDefaultSubstitute to pick up Xft
	X resources, not FcDefaultSubstitute.

2002-10-01  Stanislav Brabec  <sbrabec@suse.cz>

	* configure.in: Added cs to ALL_LINGUAS.

2002-09-24 nalin
	* src/deepinvte.c(deepinvte_terminal_set_word_chars,deepinvte_terminal_is_word_char):
	if the list of word characters is NULL or zero-length, try to guess
	with (g_unichar_isgraph() && !g_unichar_ispunct()), which seems to
	produce reasonable results (#77134).

2002-09-24 nalin
	* gnome-pty-helper/acinclude.m4: Fix HAVE_UT_UT_TV for cases where
	the static initializer might not work right (#93774, patch from
	Kalpesh Shah).

2002-09-24 nalin
	* README, gnome-pty-helper/README:  Doc fixups (mention gnome-terminal
	instead of profterm, note the proper permissions for gnome-pty-helper,
	#84505).

2002-09-20 nalin
	* src/ring.c: Fix a ring-buffer manipulation bug (Red Hat #74290) which
	might cause a new item to be inserted in the wrong location.

2002-09-19 nalin
	* src/interpret.c: Munge input data the way the terminal does so that
	conversion failures don't wedge us.

2002-09-19 Brian Cameron <Brian.Cameron@sun.com>
	* src/deepinvte.c: Backed out scrolldelay patches from 09-17 and 09-18 at
	Nalin's request.  Left in the patch which allows programs which 
	update the screen non-linearly like lynx to work properly.

2002-09-18 Brian Cameron <Brian.Cameron@sun.com>
	* src/deepinvte.c: Corrected a problem with yesterday's patch.  I am now
	properly calling g_source_remove on the scroll_delay timeout
	function.  This prevents DEEPINVTE from core dumping if you start up
	more than one DEEPINVTE gnome-terminal and exit from one of them.  Also
	made the deepinvte_scroll_timeout function a little cleaner by using
	the DEEPINVTE_IS_TERMINAL macro.

2002-09-17 Brian Cameron <Brian.Cameron@sun.com>
	* src/deepinvte.c: Fixed bug with my 09/11 speedup fix which caused programs
	that update the screen non-linearly like lynx to update incorrectly.
	Also included a speed improvement which delays the scroll-down for
	70ms.  Too fast to be noticeable to the user, but it speeds up DEEPINVTE
	greatly.

2002-09-13 nalin
	* src/pty.c: Fix typo which broke builds on systems where MSG_NOSIGNAL
	is defined.

2002-09-12 Brian Cameron <Brian.Cameron@sun.com>
	* configure.in : Added -lsocket to LIBS if socket is in libsocket,
	so DEEPINVTE will compile on Solaris.

2002-09-12  jacob berkman  <jacob@ximian.com>

	* src/pty.c: only use MSG_NOSIGNAL if it's defined

	* gnome-pty-helper/gnome-pty-helper.c (struct pty_info): remove
	master_fd and slave_fd fields
	(shutdown_pty): don't close master/slave fd's here...
	(pty_add): don't take master/slave fd args
	(open_ptys): ...close master/slave fd's right after passing them

	this fixes a hang after closing a window on os x, not sure why...

	* gnome-pty-helper/Makefile.am (install-exec-hook): remove
	trailing / after $DESTDIR

	* configure.in: AC_CHECK_FUNC() doesn't do AC_DEFINE(HAVE_FOO), so
	do that for socket() and socketpair() if they are found

2002-09-12 nalin
	* src/deepinvte.c(deepinvte_invalidate_cursor_once): Remove the invalidate_cells
	parameter, because the function is a big no-op if FALSE, in which case
	we should just not call it instead. (deepinvte_terminal_process_incoming):
	refresh the right number of rows after processing a block of data.

2002-09-12 Brian Cameron <Brian.Cameron@sun.com>
	* src/deepinvte.c Fixed minor error with my previous patch.  This just makes
	a warning go away.
  
2002-09-11 nalin
	* src/pty.c: Reorder definitions to avoid implicit declaration warnings.
	* configure.in: Check for socketpair().  Check for socket() in libc
	before poking around in libsocket.
	* gnome-pty-helper/configure.in: Check for openpty() in libutil as well,
	and do so before we check for other functions.

2002-09-11 nalin
	* configure.in, gnome-pty-helper/cofnigure.in: Test for sendmsg() with
	AC_CHECK_FUNCS instead of AC_TRY_COMPILE.
	* acconfig.h: Removed.
	* src/pty.c: Formatting.

2002-09-11 Brian Cameron <Brian.Cameron@sun.com>
	* configure.in: Added check for socket library and SendMsg
	check. 
	* acconfig.h: Added this file with a HAVE_SENDMSG definition.
	* gnome-pty-helper/configure.in: Added checks needed for the
	source code, including the SendMsg check.
	* src/pty.c: Corrected _deepinvte_pty_pipe_open so it works on
	Solaris.
	*src/deepinvte.c: Made some speed improvements so deepinvte_invalidate_cells
	is not called for every character in the while loop in 
	deepinvte_process_incoming, but only once when the while loop is done.

2002-09-11 nalin
	* gnome-pty-helper: Update from libzvt CVS.
	* python/Makefile.am: Fix some automake breakage.

2002-09-11 nalin
	* python/Makefile.am: Fix my broken merge of Jacob's patch to make
	inability to build python modules non-fatal.

2002-09-11 nalin
	* src/deepinvte.c: Skip lookups for padding information if we're pretty sure
	we're using a monospaced font.

2002-09-10 nalin
	* src/deepinvte.c: Fix from Brian Cameron for uninitialized GError in
	deepinvte_wc_from_unichar().
	* src/interpret.c, src/iso2022.c, src/pty.c, src/ring.h, src/table.c,
	src/table.h, src/trie.c, src/deepinvte.c, src/deepinvteaccess.c: Signed/unsigned
	int/size_t/gsize and pointer typecast warning fixes from Brian Cameron.
	* src/deepinvte.c: Avoid invalidating the cursor in the cursor blink
	timeout unless we have focus.

2002-09-10  Jacob Berkman  <jacob@ximian.com>
	* configure.in (ALL_LINGUAS: remove es until the file really gets
	added.  also it wasn't added alphabetically

2002-09-10 Pablo Gonzalo del Campo <pablodc@bigfoot.com>

        * configure.in: Added "es" to ALL_LINGUAS

2002-09-10 nalin
	* src/pty.c, src/pty.h: Add deepinvte_pty_close() and
	deepinvte_pty_open_with_logging(), breaking the ABI.
	* src/deepinvte.c, src/deepinvte.h: Add deepinvte_terminal_fork_logged_command(), breaking
	the ABI.
	* gnome-pty-helper/*: Swallow the pty helper bits of gnome-libs,
	but install into $pkglibdir instead of $sbindir so that existing
	packages don't suddenly start breaking.
	* src/termcap.c(_deepinvte_termcap_find_string_length): Fix signature to
	match the declaration in termcap.h.  From patch by Jacob Berkman.

2002-09-06 nalin
	* configure.in: Add $X_PRE_LIBS to the front of $X_LIBS, -lX11 and
	$X_EXTRA_LIBS to the end of $X_LIBS.  Remove some cruftiness and set
	CPPFLAGS when checking for Xft.  Check for the existence of wchar.h,
	because it might not exist.  Use an automake conditional to make
	compilation of the Python bindings non-critical.  From patch by
	Jacob Berkman.
	* src/pty.c: Silence compiler warning when exec() fails.  From patch
	by Jacob Berkman.
	* src/interpret.c, src/deepinvte.c: Stop including langinfo.h since we don't
	call nl_langinfo() any more.  Adapted from patch by Jacob Berkman.
	* src/caps.c: Fill in a couple of missing initializers.
	* src/deepinvte.c, src/deepinvte.h: Add accessor functions for use in language
	bindings.
	* python/deepinvte.defs: Add defs for the new accessor functions.
	* python/deepinvte-demo.py: Add a scrollbar to the sample window, handle
	more of the options the C version handles.  Stop expecting additional
	arguments with a signal that doesn't include any.
	* python/Makefile.am: We only have one target, so don't bother with
	target-specific primaries if we can avoid it (#92252).
	* deepinvte.pc.in: Note build dependencies on ATK, Pango, and PangoX.

2002-09-05 nalin
	* src/caps.c, src/caps.h, src/debug.c, src/debug.h, src/interpret.c,
	src/iso2022.c, src/iso2022.h, src/pty.c, src/reaper.c, src/ring.c,
	src/ring.h, src/table.c, src/table.h, src/termcap.c, src/termcap.h,
	src/trie.c, src/trie.h, src/utf8echo.c, src/deepinvte.c, src/deepinvteaccess.c,
	src/deepinvteapp.c: prefix library-internal interfaces with underscores so
	that gtk-doc doesn't guess they're public.
	* src/deepinvte.c: return FALSE from focus-in/focus-out/expose handlers.

2002-09-05 nalin
	* src/caps.h, src/debug.h, src/iso2022.h, src/marshal.h, src/ring.h,
	src/table.h, src/termcap.h, src/trie.h: add giant warnings about how
	these headers define library-internal interfaces.
	* deepinvte.spec: 0.8.18

2002-09-05 nalin
	* docs/reference: first pass at writing documentation
	* src/termcap.c: fix how'd-that-ever-work in deepinvte_termcap_strip(), patch
	from Brian Cameron.  Take \\e as an alias for \\E, which is already
	an alias for Escape.
	* src/deepinvte.c(deepinvte_terminal_get_cursor): Return an absolute cursor position
	instead of a relative position.

2002-09-04  jacob berkman  <jacob@ximian.com>

	* src/deepinvte.c (deepinvte_default_substitute): only compile the FC_HINT_STYLE
	part if FC_HINT_STYLE is defined

2002-09-04 nalin
	* src/deepinvte.c: Add missing <fontconfig/fontconfig.h> include for Xft2,
	spotted by Jacob Berkman.

2002-09-04 Brian Cameron <Brian.Cameron@sun.com>
	* src/deepinvte.c: Avoid double color deallocations with Xft.
	* configure.in: Added stropts.h check for Solaris.
	* src/deepinvte.c: Do not send data to the slave if the length is zero.
	Some shells on Solaris do not handle this well.
	* src/pty.c: Added ptem/ldterm/ttcompat ioctls so DEEPINVTE will work
	on Solaris.

2002-09-03 nalin
	* src/deepinvte.c: Avoid double color deallocations with Xft.

2002-09-03 nalin
	* src/deepinvte.c: Handle color allocation failures with Xft better.
	* src/deepinvte.h: Clean up typedef declarations.

2002-09-03 nalin
	* src/marshal.list, src/reaper.c, src/reaper.h, src/deepinvte.c: Modify the
	child-exited signal to pass a signed int and an unmodified exit status,
	allowing the callback to check for normal/abnormal exit status.

2002-09-02 nalin
	* src/deepinvte.c: Don't send zero-length strings to the child -- it may not
	be able to cope properly.  Spotted by Brian Cameron.

2002-08-30 nalin
	* src/deepinvte.c: Handle cursor exposes correctly for multicolumn characters,
	no matter which cell the cursor is in.  Fix autoscrolling boundary
	checks for when allocation.y != 0.

2002-08-30 nalin
	* src/deepinvte.c(deepinvte_terminal_insert_char): Wrap correctly to avoid screwing
	up multicolumn characters.

2002-08-30 nalin
	* src/deepinvte.c: Get smarter about when it's necessary to start messing
	with our adjustments (Red Hat #73091).  Change the way we clear the
	screen so that all of the contents of the current screen become
	scrollback data.

2002-08-30 nalin
	* src/deepinvte.c: Register DeepinvteTerminalEraseBinding with GObject as an
	enumerated type.
	* python/deepinvte.defs: Update.
	* python/deepinvte.overrides: Ignore deepinvte_terminal_get_text_range().

2002-08-30 nalin
	* src/deepinvte.c: Restore the focus-in/focus-out handlers -- the defaults
	don't quite DTRT for us because they miss our im_context (#72946).  When
	setting the cursor location for the input method, make the Y coordinate
	relative to the window, not the scrollback buffer.  When resizing the
	scrollback buffer, clamp the cursor to the set of possible locations,
	not the visible locations.

2002-08-30 nalin
	* src/deepinvte.c: Initialize the pty master fd to -1 to avoid spurious
	window resizes on fd 0.
	* src/debug.c, src/debug.h: Add a "pty" debug message class.

2002-08-30 nalin
	* src/iso2022.c: Fix a how'd-that-ever-work bug (not returning anything
	from deepinvte_iso2022_new()), spotted by Brian Cameron.
	* configure.in: Use -Wall when building with gcc in maintainer mode.
	* src/interpret.c, src/ring.h, src/table.c, src/trie.c, src/deepinvte.c,
	src/deepinvteaccess.c: Warning cleanups.

2002-08-29 nalin
	* src/deepinvte.c: Clean up bookkeeping for mouse autoscrolling and adjustment
	change notifications.  Reset the scrolling and insertion deltas when
	clearing the history.
	* src/interpret.c: Don't dump data on incomplete conversion errors,
	which we're going to retry anyway.
	* src/iso2022.txt: Add iso-2022-kr examples (no workee -- uses GR).

2002-08-28 nalin
	* src/deepinvte.c, src/deepinvte.h: Add deepinvte_terminal_copy_primary and
	deepinvte_terminal_paste_primary(), because I really want to let
	profterm decide default values for key bindings.

2002-08-28  Gustavo Noronha Silva  <kov@debian.org>
	* configure.in (ALL_LINGUAS): added pt_BR

2002-08-27 nalin
	* src/deepinvte.c: Stop autoscrolling on button release.

2002-08-27 nalin
	* src/deepinvte.c: When autoscrolling, clamp the new boundary to what the user
	can see.

2002-08-27 nalin
	* src/deepinvte.c: Implement autoscroll (Red Hat #70481).

2002-08-27 nalin
	* src/deepinvte.c: Only perform cr-lf substitutions when pasting text, not
	when inputting from a live user (Red Hat #72639).  Bind GDK_ISO_Left_Tab
	to kB.  Formatting changes.
	* termcaps/xterm: Bind kB to back-tab (Red Hat #70340).

2002-08-27 nalin
	* src/deepinvte.c: Don't tamper with the scrolling offsets -- they're updated
	when we handle adjustment_changed notifications.  Scroll instead of just
	moving the cursor down when soft-wrapping to the next line.  Avoid
	emitting adjustment_changed when only the value has changed, likewise
	for the value and the other fields of the adjustment.

2002-08-27 nalin
	* src/deepinvte.c: Keep cursor position and scrolling offsets from going
	wonky when you resize, especially on the alternate screen.  Suppress
	duplicate adjustment_changed notifications.
	* src/deepinvteapp.c: Set the MIN_SIZE geometry hints so that we can resize
	to unreasonably-small dimensions.
	* src/ring.c, src/ring.h: Add deepinvte_ring_new_with_delta().

2002-08-26 nalin
	* src/deepinvte.c: Add padding spaces after full lines as well -- spotted by
	both notting and pjones.

2002-08-26 nalin
	* src/deepinvte.c: Don't deadlock when substitution fails, spotted by msw.

2002-08-26 nalin
	* src/deepinvte.c: If GDK_USE_XFT is set, check the value of GDK_USE_XFT, not
	DEEPINVTE_USE_XFT.  Spotted by hp.

2002-08-25 nalin
	* src/deepinvte.c: Heed the reverse-video setting when painting character
	cells again.  Make selection and matching coordinates global, fixing
	the selecting-while-scrolling case.  Prevent overdraws into the padding
	area on the right.

2002-08-25 nalin
	* src/deepinvte.c: Make nd() move right but not wrap -- according to Strang
	it's undefined, but xterm doesn't wrap it.  Separate do/DO from sf/SF
	and up/UP from sr/SR, because the scrolling behavior is supposed to be
	different.  Add support for decset/decreset 7 (wraparound mode) and
	1051 (Sun keyboard).  Add support for DECALN.  Remove some type checks
	from run-time which the compiler can catch with certainty.

2002-08-25  Kjartan Maraas  <kmaraas@gnome.org>
	* configure.in: Added Norwegian (no) to ALL_LINGUAS.
	
2002-08-25  Pablo Saratxaga <pablo@mandrakesoft.com>
	* configure.in: Added Vietnamese (vi) to ALL_LINGUAS

2002-08-22 nalin
	* src/caps.c: Bind ENQ to "return-terminal-status".
	* src/iso2022.c: Fix an off-by-one which incorrectly triggered an
	assertion.
	* src/deepinvte.c: Implement send-primary/secondary-device-attributes.  Bind
	shift+insert to "paste PRIMARY".  Guard against NULL window/icon title
	when telling the child app what they are.  Prevent DO(), up(), and UP()
	from scrolling.

2002-08-22 nalin
	* src/deepinvteapp.c: Set geometry hints using the initial font setup.
2002-08-22 nalin
	* src/deepinvte.c, src/deepinvte.h: Make use of the visible bell a separate option
	from use of the audible bell, allowing both/neither to be used.  Open
	fonts right away again -- profterm reads the metrics right after calling
	set_font(), so we have to open fonts ASAP.  Rework the Xft/Pango/Xlib
	decision code to be more consistent.  Watch for style changes and reset
	our font to the new style's font when we're already using the old
	style's font.
2002-08-21 nalin
	* src/iso2022.c(deepinvte_iso2022_substitute): Take a deepinvte_table as an
	additional argument, and don't mess with text that's part of a control
	sequence, even if it's in shifted-out text.
	* src/table.c(deepinvte_table_match): Speed up for the no-arguments-requested
	case, which just became much more common.
2002-08-21 nalin
	* src/deepinvte.c(deepinvte_terminal_draw_rows): Cap the maximum number of
	characters we draw in a single call to deepinvte_terminal_draw_cells at a
	reasonable number.
2002-08-21 nalin
	* src/table.c: Don't overwrite the original pattern pointers before
	freeing the old value.
	* src/deepinvte.c: Use the same pango context whenever possible, to save on
	PangoX startup time.
2002-08-20 nalin
	* src/deepinvte.c: Unref the output channel one more time when we're done
	sending data to the child.  Free the background data GDK property when
	we're finished with it.  Don't retrieve the pango context when drawing
	unless Xft has already been disabled.  Don't try to use the pango layout
	to draw unless it's valid.  Don't try to use the XftDraw item to draw
	unless it's valid.
2002-08-20 nalin
	* src/deepinvte.c: Dispose of the updated substitution context properly when
	processing blocks of input text.  Spotted by Arjan van de Ven.
2002-08-20 nalin
	* src/ring.c: Debug when rows get freed.
	* src/deepinvte.c: Maybe-release pango contexts after unreffing layouts which
	refer to them.  Decide on how we want to draw fonts before deciding
	which fonts to draw, to avoid spurious font loading.  Remove output tags
	when the output tag's callback is about to return FALSE.
2002-08-20 nalin
	* src/deepinvte.c: Don't leak the hintstyle and rgba settings.  Patch from
	Arjan van de Ven.  Free PangoX contexts when we're done with them,
	spotted by Arjan van de Ven.
2002-08-19 nalin
	* src/deepinvte.c: Load fonts just-in-time to avoid spurious reloads.  Don't
	override the focus_in and focus_out event handlers -- the defaults DTRT.
	* src/debug.c, src/debug.h: Add a RING debug class.
2002-08-19 nalin
	* src/iso2022.c: Handle override maps which don't affect the font
	palette correctly, resetting at newlines and escape marks.  Process
	bogon data correctly.
	* src/iso2022.txt: Add some sample text.
2002-08-19 nalin
	* src/deepinvte.c: Fixup some fontconfig/Xft mixups.  Set the hint style
	instead of hinting when reading the GTK hint style setting (spotted
	by katzj and otaylor).
2002-08-19 nalin
	* src/deepinvte.h, src/deepinvte.c: Use gssize instead of ssize_t.  Perform
	substitutions while processing.  Use PangoX contexts when we're using
	the PangoX fontmap and when doing PangoX rendering.
2002-08-19 nalin
	* src/mkunitables.sh,src/unitable.*: Add.
	* src/iso2022.c, src/iso2022.h: Use unitables.
	* src/caps.c: Remove sequences for designating character sets.  Switch
	to using a second passed-in buffer for storing results in case the
	caller doesn't want substitutions done in-place.
	* src/debug.c, src/debug.h: Add a substitution debug flag.
	* src/interpret.c: Perform substitution.
	* src/table.c, src/table.h: Use gssize instead of ssize_t.
	* src/termcap.c, src/termcap.h: Use gssize instead of ssize_t.
	* src/utf8echo.c: Use strtol, allowing users to specify code points in
	hex format.
2002-08-14 nalin
	* src/deepinvte.c(deepinvte_terminal_configure_toplevel): repaint the entire window
	to ensure that any overdraw area we're not paying attention to at least
	gets cleared to the background.
	* src/deepinvte.c(deepinvte_terminal_locale_encoding): don't try to second-guess
	the local encoding, just use the current charset as returned by
	g_get_charset().
2002-08-14 nalin
	* src/deepinvte.c(deepinvte_terminal_reset): drop pending incoming data on reset.
	* src/deepinvte.c: give reprocessing of pending input data a higher priority
	than reading it from the child to prevent backlogs on corrupt or invalid
	multibyte data from building up and whacking us exponentially.
2002-08-13 nalin
	* src/deepinvte.c(deepinvte_sequence_handler_delete_lines): initialize lines added
	to the current default colors.  Spotted by jrb.
	* src/deepinvte.c(deepinvte_terminal_set_font): don't try to pick up GTK Xft
	settings unless we're using FontConfig.  Patch from otaylor.
2002-08-11 nalin
	* src/deepinvte.c: reorder set/reset processing for decset so that 1049
	properly represents the combination of 1047 and 1048 (#90027).
2002-08-11 nalin
	* src/caps.c: properly escape a sequence which had a bare '%' in it.
2002-08-11 nalin
	* src/deepinvte.c: change Xft-related defaults match whichever version of GTK
	we were built with (hopefully).
2002-08-11 nalin
	* src/deepinvte.c: don't bother with cursor blinking or freezing/thawing
	updates when the widget isn't realized.  Patch from Gustavo Giráldez.
2002-08-08 nalin
	* src/deepinvte.c: take extra steps to make sure that the cursor doesn't go
	back into negative scrollback space.
2002-08-08 nalin
	* src/deepinvte.c(deepinvte_terminal_invalidate_all): rewrite.
2002-08-08 nalin
	* src/deepinvte.c(deepinvte_terminal_paint,deepinvte_terminal_draw_cells): fill in the
	background color when drawing the cursor, even if it's going to end up
	as the default background color, spotted by Peter Jones.  Draw the
	cursor correctly if it's over a graphic character.
2002-08-07 nalin
	* src/deepinvte.c(deepinvte_terminal_draw_cells): once again, avoid drawing NULs.
	* src/deepinvte.c: add a small pad to each edge (#89048).
	* src/deepinvteapp.c: handle widget padding.
2002-08-07 nalin
	* src/interpret.c: look for $pkgdatadir/termcap/$TERM first, as the
	widget does, before consulting /etc/termcap.
	* src/ring.c(deepinvte_ring_free): check for a non-NULL removal function
	before calling it.
	* src/deepinvte.c(deepinvte_terminal_key_press): add an option for doing
	VT220-style or Sun/PC-style modified function keys.  Default to VT220
	for now, though, pending feedback.
	* src/deepinvte.c(deepinvte_terminal_reset): scroll to the bottom when resetting.
2002-08-07 nalin
	* src/deepinvte.c(deepinvte_terminal_draw_cells): don't trust XftDrawString32() to
	advance linearly for monospaced fonts (#90164).

2002-08-07 nalin
	* src/deepinvte.c(deepinvte_terminal_reset): reset the default setting as well
	(#89506).

2002-08-07 nalin
	* src/deepinvte.c(deepinvte_terminal_draw_cells): perform Xft remapping for Xft1,
	switch back to PangoX.
2002-08-06 nalin
	* src/deepinvte.c(deepinvte_terminal_set_encoding,
	deepinvte_sequence_handler_local_charset): use g_get_charset() instead of
	nl_langinfo() to determine the default codeset, and to check if it's
	UTF-8.  Patch from Hidetoshi Tajima.
	* src/deepinvte.c(deepinvte_terminal_set_encoding): don't leak conversion
	descriptors when changing the encoding fails.  Patch from Hidetoshi
	Tajima.
	* src/deepinvte.c(deepinvte_terminal_send): don't read past the converted string
	when performing paste substitutions.
	* src/deepinvte.c: rework the straight-Pango rendering routines to call
	normal Pango instead of PangoX.
	* src/deepinvte.c(deepinvte_terminal_ensure_cursor): speed up the "add many cells"
	case a bit.
2002-08-05 nalin
	* src/deepinvte.c(deepinvte_cell_is_between): sort the two endpoints correctly and
	provide a boolean to control whether or not the endpoint is "in".
	* src/deepinvte.c(deepinvte_cell_draw_rows): check if a cell is selected using
	the right indicator.
	* src/deepinvte.c(deepinvte_terminal_get_text): when adding a newline to the end
	of a returned line, don't show it as being in the rightmost column.
	* src/deepinvte.c(xlfd_from_pango_font_description): turn the DPI, pixel size,
	and added info into wildcards.
	* src/deepinvte.c(deepinvte_terminal_draw_cells): go back to drawing individual
	cells when using Xlib.
	* src/deepinvte.c: Compute right-side padding as well as left.
	* src/deepinvte.c(deepinvte_terminal_init): disable use of PangoX by default.
	* src/deepinvteapp.c: add -D to add the same patterns profterm does to test
	dingus hiliting.

2002-08-03  Havoc Pennington  <hp@redhat.com>

	* src/deepinvte.c (deepinvte_terminal_setup_background): add a gdk_flush()
	before the error trap pop, just for paranoia, may help with 
	#89049

2002-08-02 nalin
	* src/deepinvte.c(deepinvte_terminal_send): Substitute carriage returns for
	newlines when pasting text to the child, fixing weird paste behavior
	in pico and friends.

2002-08-02  Christophe Merlet  <christophe@merlet.net>

	* configure.in: Added fr to ALL_LINGUAS.

2002-08-01  nalin
	* src/pty.c, src/pty.h: Expose deepinvte_pty_set_size() and get_size() to
	localize terminal ioctl usage.
	* src/ring.c(deepinvte_ring_validate): Don't repeatedly compute the same
	value when we know it won't change.
	* src/deepinvte.c(deepinvte_wc_from_unichar): Implement for the non-STDC_ISO_10646
	case, heavily based on patch from Hidetoshi Tajima.
	* src/deepinvte.c(deepinvte_terminal_ensure_cursor): Don't initialize the local
	data unless we have to.
	* src/deepinvte.c(deepinvte_terminal_process_incoming): Don't insert NUL characters
	into the display, matching behavior of xterm.
	* src/deepinvte.c: Clean up use of various G_PRIORITY values throughout to
	allow for simpler tuning.  Rewrite rendering code to use per-paint
	PangoLayouts when they're needed, use Xft2's DrawCharSpec function when
	available, and to cut down on X requests.  Don't paint on expose events
	if the window isn't realized, drawable, and at least partially visible.
	Don't deselect previous selection when the user clicks unless there's
	also a drag first.
2002-07-31  nalin
	* src/pty.c: Include <termios.h> if available, per patch from Hidetoshi
	Tajima.
	* src/trie.c: Include missing <wchar.h>, spotted by Hidetoshi Tajima.
	* src/deepinvte.c: Initialize new lines created in insert_lines() to the
	current default attributes like al() does.
2002-07-30  nalin
	* configure.in: Check for wint_t and attempt to allow compiles even
	when wint_t isn't defined (this type is used only debug code, so it
	shouldn't break anything).
	* src/caps.c: Remove "te" and "ti", which are logical, in the same way
	"so" is, from the known capabilities lists.  Add a "is a key" field to
	the termcap list so that we don't match against keystrokes in case
	they're also control sequences.
	* src/interpret.c: Use tables instead of tries.  Don't add key sequences
	to the table.
	* src/pty.c: Fix incorrect invocation in sample.
	* src/reaper.c: Include stdlib.h to quiet compiler warning.
	* src/trie.c, src/trie.h: Remove the unused precomputing routines.
	* src/utf8echo.c: Switch to link with tables instead of tries.
	* src/deepinvte.c: Switch to using tables instead of tries.  Map
	cursor-backward to LE instead of le, which handles parameters right.
	Don't add key sequences to the parsing table.  Tune updates so that
	they occur less often when we're processing large amounts of data from
	the child.  Add a 'status-line-changed' signal.  Implement fs() and
	fix ts().  Add ::get_status_line() to get the contents of the status
	line.  Obey it() when setting default tabstops.  Implement
	cursor_next_line(), cursor_lower_left(), cursor_preceding_line(),
	cursor_horizontal_and_vertical_position(), erase_characters(), and
	insert_blank_characters().  Implement nw().

2002-07-26  nalin
	* src/deepinvte.c: Initialize new lines added for al().  Spotted by jrb.

2002-07-25  Ole Laursen  <olau@hardworking.dk>

	* configure.in: Added Danish translation.

2002-07-25  nalin
	* README: Note that bold isn't broken any more.
	* termcaps/xterm: Note that k; was added.
	* src/pty.c: Set the proper number of columns in the window size.
	* src/ring.h: Change macro argument names to hopefully not step on
	application code.
	* src/deepinvte.c: Set the terminal size to the default size as specified in
	termcap at init-time.
2002-07-24  nalin
	* src/pty.c: Add private deepinvte_pty_set_size() function.
	* src/pty.c, src/pty.h: deepinvte_pty_open() takes size arguments now.
	* src/deepinvte.c: Open the PTY with the proper initial size.
2002-07-23  nalin
	* src/ring.c, ring.h: Expose the ring implementation and convert several
	simple functions into macros.
	* src/deepinvteapp.c: Pass all long options on to gtk_init().
2002-07-23  nalin
	* src/deepinvte.c: Fix realize/unrealize to be properly reversible.  Use the
	font from the default style unless we're explicitly given one.
	* src/deepinvteapp.c: Don't set base size or minimum size geometry hints when
	sizing the terminal widget.
2002-07-22  nalin
	* src/pty.c(deepinvte_pty_ptsname): Fix an incorrect logic check.
2002-07-19  nalin
	* src/deepinvte.c(deepinvte_terminal_set_color_internal): If we're changing the
	background color, apply it to the widget's window as well, from msw.
2002-07-19  nalin
	* src/deepinvte.c: Undo the scrolling changes -- there too many combinations
	of circumstances that cause them to not work right.
2002-07-18  nalin
	* src/deepinvte.c: Fudge the repaint line count by one when scrolling regions
	to ensure that the old cursor gets repainted.  Calculate the area which
	needs to be repainted when reverse-scrolling correctly.
2002-07-18  nalin
	* src/deepinvte.c: Implement enough of set-mode and reset-mode to allow
	toggling of insert mode using this sequence.  Move all scrolling into
	deepinvte_terminal_scroll_region and use gdk_draw_drawable to avoid repainting
	from scratch whenever possible.
2002-07-17  nalin
	* configure.in: Actually set ALL_LINGUAS so translations get installed.
	* README: Document the weirdness that is cursor movement around wide
	characters.
	* src/deepinvte.defs: Bind set_color_bold().
	* src/debug.c: Suppress warnings when $DEEPINVTE_DEBUG_FLAGS isn't set.
	* src/pty.c, src/reaper.c, src/termcap.c, src/trie.c: Provide for
	debug messages in the test program.
	* src/interpret.c, src/trie.c: Use libc stdio instead of g_print for
	printing what might be part of a multibyte sequence because g_print
	checks for validity.
	* src/interpret.c, src/trie.c, src/utf8echo.c, src/deepinvte.c: Use gunichar
	instead of wchar_t in places where a gunichar is expected.  Provide a
	means for converting from wchar_t to gunichar for the sake of X11 calls
	which want a wchar_t.
	* src/trie.c: Provide deepinvte_trie_wide_encoding() for finding a giconv
	target which is hopefully compatible with gunichar.  Likewise provide
	deepinvte_trie_narrow_encoding() to find one compatible with iso-8859-1.
	* src/deepinvte.c: Fall back to ISO-8859-1 if we can't set things up for the
	current locale encoding at startup time.  Fall back to the current
	encoding if we can't perform a given dynamic switch.
2002-07-16  nalin
	* configure.in: Set GETTEXT_PACKAGE correctly, noted by menthos.

2002-07-16  nalin
	* src/deepinvte.c (deepinvte_terminal_set_colors): Guess at an appropriate bold
	version of the foreground color instead of hard-coding in a default.
	* src/deepinvte.c, src/deepinvte.h (deepinvte_terminal_set_color_bold): Add.

2002-07-16  nalin
	* src/trie.c: Correctly check for g_iconv_open() failure.
	* src/deepinvte.c (deepinvte_terminal_set_encoding): Try to give a meaningful
	error when g_iconv_open() fails, even though we're screwed.

2002-07-15  nalin
	* src/deepinvte.c: wrap the new Xft/fontconfig-specific code in HAVE_XFT
	* src/deepinvte.c: Revert some changes in how new cells were initialized,
	removing various cosmetic problems.
	* src/deepinvte.c (deepinvte_terminal_process_incoming): Discard the proper number
	of characters when we don't recognize a sequence, previously we left
	one byte that should have been removed.

2002-07-14  Havoc Pennington  <hp@pobox.com>
	* src/deepinvte.c (deepinvte_terminal_get_cursor_position): decrement spaces
	as we go through the loop, it was nice and infinite.

2002-07-13 nalin
	* src/deepinvte.c (deepinvte_terminal_get_text): Add the proper number of attribute
	structs to the attribute array to fix crashes which occurred when the
	buffer contains non-ASCII text (Red Hat #67930).
2002-07-12 nalin
	* src/deepinvte.c: Small optimization in the al() and dl() handlers.  al()
	doesn't move the cursor, per GNU termcap docs.  Check for a pixbuf in
	the bgfx check instead of pixmap, which was the wrong type.
2002-07-12 nalin
	* src/deepinvte.c: Add patch to heed Xft/fontconfig settings as kept by GTK.
	Based on patch from otaylor.
2002-07-12 nalin
	* src/slowcat.c: Added.
	* src/deepinvteapp.c: Add -a/-b flags to control audible bell and blinking
	cursors.  Only send "pwd" as an initial command if there wasn't a
	command specified on the command line.  Add a simple help message.
	* src/deepinvte.c: Bind F13-F35 per termcap.  Treat GDK_KP_Delete as
	GDK_Delete.  Map Ctrl+F1-F12 to F13-F24.  Fix dc() to ensure that the
	rows stays full and that newly-added cells get the default attributes.
	Fix cl() to clear all rows on the screen with the default attributes
	(bce).  Default to using Xft if available for consistency with GTK.
2002-07-11 nalin
	* src/deepinvte.c: Treat super, hyper, meta, and alt as modifiers when
	deciding to scroll-on-keypress.  Noted by jrb.
	* src/deepinvte.c: Always map \r and \n to cr and so, even when they're
	defined by the termcap.
	* src/deepinvte.c, src/deepinvte.h: Rework how default colors are set up, and add
	deepinvte_terminal_set_color_foreground and deepinvte_terminal_set_color_background.
	* src/deepinvte.h: Remove includes for local headers which apps are not
	likely to never use, cleaning up the namespace a little.
	* python/deepinvte.defs: Bind deepinvte_terminal_set_color_{fore,back}ground.
	* src/debug.h, src/ring.h: Use G_BEGIN_DECLS/G_END_DECLS.
	* src/reaper.h: Use G_BEGIN_DECLS/G_END_DECLS in the right place.
	* src/deepinvteapp.c: Add -B/-T flags to set background images and
	transparency.
2002-07-02 nalin
	* src/deepinvte.c: Make shift+button1 extend selection.
2002-07-01 nalin
	* src/deepinvte.c (deepinvte_terminal_draw_char): Draw unicode line-drawing code
	points natively as we do for the GR1 support, in case the current font
	doesn't include glyphs for them.
	* src/deepinvte.c: Test for g_iconv_open() failure properly (compare result
	to ((GIConv)-1), not NULL).
	* src/deepinvte.c: Rework recovery from illegal sequence errors in the input
	stream to be much more aggressive about it.
2002-06-25 nalin
	* src/deepinvte.c: Bind F10 to "k;", not "k0".
	* termcaps/xterm: Add "k;" defined as F10.
2002-06-25 nalin
	* src/deepinvte.c (deepinvte_terminal_reset_rowdata): Check for redundant resizes.
	* src/deepinvte.c (deepinvte_terminal_set_scrollback_lines): Keep the alternate
	screen buffer size the same as the window height, because xterm's
	alternate screen doesn't backscroll.
	* src/deepinvte.c (deepinvte_terminal_get_text): Don't append spaces to multicolumn
	characters when reading the screen's contents.
	* src/deepinvte.c: Don't overexpose neighboring cells any more.  Cleanups.
	* src/ring.h, src/ring.c: Add deepinvte_ring_max() to read a ring's maximum
	size.
2002-06-24 nalin
	* src/deepinvte.c (deepinvte_sequence_handler_decset_internal): Treat option 1049
	as a combination of 1047 and 1048.
	* src/deepinvte.c (deepinvte_terminal_finalize): When finalizing while holding the
	selection, throw the selection onto the clipboard without an owner so
	that it doesn't just disappear.
2002-06-19 nalin
	* src/deepinvte.c (deepinvte_sequence_handler_set_title_int): Fix a logic bug
	that got rid of the title always, not just when conversion failed.
2002-06-19 nalin
	* src/deepinvte.c: Clear the alternate screen when switching to it.
2002-06-18 nalin
	* src/deepinvte.c: Fix refs/derefs with IOChannels and sources.  Clean up
	I/O GIConv descriptors at finalize-time.
2002-06-18 nalin
	* src/deepinvte.c: Make cursor_visible a widget-wide (not per-screen) setting.
2002-06-18 nalin
	* autogen.sh: Correct automake version check to require 1.5, heads
	up from Glynn Foster.
2002-06-18 nalin
	* src/trie.c (deepinvte_trie_match, deepinvte_trie_match_x): Sort out greedy vs.
	non-greedy pattern matching.
	* src/deepinvte.c (deepinvte_sequence_handler_decset_internal): Make 1047 an alias
	for 47 (use alternate buffer), and handle cursor save/restore properly.
2002-06-14 nalin
	* src/deepinvte.c, src/deepinvte.h (deepinvte_terminal_fork_command): Add a parameter for
	passing in environment variables to add.
	* src/termcap.c: Preprocess out unused comment() and generate() funcs.
	* src/Makefile.am: Bump library version number.
	* deepinvte.spec: 0.4.0
2002-06-14 nalin
	* configure.in, python/Makefile.am: Handle cases where pygtk isn't
	installed in the prefix we're configuring for.
	* src/Makefile.am: Link libdeepinvte to its library dependencies.
2002-06-13 nalin
	* src/deepinvteaccess.c: Stop watching for hierarchy-changed signals -- the
	accessible container which is our parent handles it already (from msw).
2002-06-13 nalin
	* src/deepinvteaccess.c: Re-read cursor position immediately on "cursor-moved"
	events, and emit the "text-caret-moved" signal then as well.  Don't
	override the signal handlers for signals we emit, bad things can
	happen (from msw).
2002-06-12 nalin
	* src/deepinvte.c: Re-read the termcap when we change emulation, because
	the location of the file may have changed.
	* src/reaper.c: Also tell the parent the child died when the child
	dies due to an uncaught signal.
	* python/deepinvte.override (_wrap_deepinvte_terminal_fork_command): Handle default
	value for the command.
2002-06-12 msw
	* python/deepinvte.override (_wrap_deepinvte_terminal_fork_command): implement
2002-06-12 msw
	* acinclude.m4: added AM_CHECK_PYTHON_HEADERS from pygtk
	* configure.in: rewrote python checks to be more robust
	* python/Makefile.am (CFLAGS): include @PYTHON_INCLUDES@
2002-06-12 msw
	* src/deepinvte.c (deepinvte_terminal_get_accessible): turn the logic around
	to be the right way
2002-06-12 nalin
	* src/deepinvte.c: Cache the result of deepinvte_terminal_get_accessible() and
	unref it at finalize-time.  Add debug messages to log signals emitted
	by the widget.  Implement deepinvte_terminal_get_encoding and
	deepinvte_terminal_get_emulation, emit signals when these change.
	* src/deepinvteaccess.c: Emit a "text_caret_moved" signal when the cursor
	moves.
	* configure.in, src/Makefile.am: Add rules for building python modules.
2002-06-12 msw
	* src/deepinvteaccess.c (deepinvte_terminal_accessible_get_text): accept
	end_offset of -1, which means "until the end".
	* src/deepinvteaccess.c (deepinvte_terminal_accessible_new): never set the
	description to a NULL pointer
2002-06-10 nalin
	* Makefile.am, configure.in: Include gettext support.
	* src/deepinvte.c, src/deepinvte.h: Expose deepinvte_terminal_set_encoding().
	* src/deepinvte.c: Finish merging otaylor's Xft2 patch (oops).  Compute
	padding correctly.
	* src/pty.c, src/reaper.c, src/trie.c, src/deepinvte.c: Mark warnings for
	possible translation.
2002-06-07 nalin
	* src/deepinvte.c: Center characters in their cells, caching their extents.
2002-06-06 nalin
	* src/deepinvte.c, src/deepinvte.h: Add get_cursor_position(). Remove get_snapshot()
	and free_shapshot().
	* src/deepinvte.c: Fix a logic bug that caused us to scroll to the bottom
	even if the user just pressed and released a modifier key.  Fix saving
	of the font in set_font() in most cases, where we weren't saving the
	new font before.  Scroll-to-bottom on input method commits, which are
	also the result of keystrokes, when scroll-on-keystroke is enabled.
	* src/deepinvteaccess.c: Rework to use get_text() and get_cursor_position()
	instead of get_snapshot(), so that selection and accessibility both
	agree on what's visible (or "visible").
2002-06-05 nalin
	* configure.in: Check for pangoxft with Xft1 or Xft2, hopefully getting
	things right for either case.  Originally from patch by andersca.
	* src/reaper.c, src/reaper.h: Add a singleton object to watch for
	SIGCHLD when child processes quit.
	* src/deepinvte.c: Emit a "child-exited" signal when a child started with
	fork_command() exits.
	* src/deepinvte.c: Make a better guess at font metrics when using Xft by
	measuring the extents for a string of representative characters.
	* src/deepinvte.defs: Add.  Not very useful yet.
2002-05-31 nalin
	* src/deepinvte.c: Implement font setting using PangoX to convert Pango
	font descriptions to core font xlfds for use when drawing with Xlib.
2002-05-29 nalin
	* src/trie.c, src,deepinvte.c: Finish switching iconv to g_iconv.  I think
	this was a part of Hidetoshi Tajima's patch that I lost.  Free regexes
	when we're done with them.
2002-05-28 nalin
	* src/deepinvte.c: Fix matching when scrolling delta isn't zero.  Fix async
	background updating (report from Richard Neal Plana).  Fix cb() and ce()
	when the cursor is on a line without data (needed to create it) and when
	cells being cleared don't exist (needed to create them) (report from
	Garret LeSage).
	* src/deepinvte.c, src/deepinvteaccess.c: Always free the segment when freeing
	arrays and strings.

2002-05-24 nalin
	* autogen.sh: Call libtoolize. (#82836)
	* src/deepinvte.c: Fix stupid segfault in set_scrollback_lines.  (Patch
	from notting.)  Make another attempt to convert Pango font descriptions
	to xlfds.
	* src/deepinvteapp.c: Add -c, -f, -t command-line flags for easier testing.

2002-05-22 nalin
	* src/deepinvte.c: Fix hiliting of matched strings.

2002-05-21 nalin
	* src/deepinvte.c: Filter key release events through input methods.  (Patch
	from otaylor.)  When building with gcc, use -std=c99.

2002-05-21 nalin
	* autogen.sh, src/termcap.c, src/utf8echo.c, src/deepinvte.c: Patch from
	Hidetoshi Tajima to fix building on Solaris systems, remove use of
	syntax that might be specific to gcc, and fix an overrun in
	deepinvte_termcap_generate().  (#82433)

2002-05-18 andersca
	* src/deepinvte.c: Don't queue a background update if the background isn't
	transparent.

2002-05-16 nalin
	* src/deepinvte.c: Snip trailing whitespace off of copied lines, insert
	an end-of-line only when the copied line doesn't go to the right edge,
	don't overrun right edge, even in insert mode.  Fix displaying of
	underlined text.  Finish implementing matching.

2002-05-15 nalin
	* src/deepinvte.c: Send kI on insert key.  Don't send drag events when the
	child has only asked for click events.  Fix crashbugs in selection.
	When getting scroll events, send mouse 4/5 events to the child instead
	of performing a history scroll if the child wants mouse events.  Start
	adding match support, merging how selection views the buffer with how
	matching views the buffer, though matching doesn't work yet.

2002-05-14 nalin
	* src/deepinvte.c: Don't try to draw nul characters, most fonts can't.  Don't
	send motion-tracking events to the child unless we're dragging.  Fix
	ce so that it works even right after startup.  Make sure that repainting
	the entire window actually exposes the visible parts of the window.  Fix
	tab clearing to also allow removal of the current tabstop.  Implement
	save-mode and restore-mode.  Start on reverse-video mode.  Don't scroll
	on modifier keypress events.  Rework part of clipboard copy.
	* termcaps/xterm: Add missing F11/F12/End keysyms to bundled xterm
	termcap.
2002-05-13 nalin
	* src/debug.c: Add "ALL" as a debug flag, aliased to everything.
	* src/pty.c: Print debug info after redirecting stdio.
	* src/trie.c: When debugging, count only decision nodes.
	* src/deepinvte.c: Fix se, for real this time.  Add a mostly-ignored protected
	attribute.  Handle am, bw, ul flags properly.  Make cd clear the current
	line, too.  Make ce fill the current default attributes through the end
	of the line.  Handle cS.  Fix cv to work when we have a scrollback
	buffer.  Handle ll, mp.  Line wrap on nd.  Reset tab stops on hard
	reset only.  Handle soft-reset and full-reset.  Handle uc.  Initialize
	scrollback line count properly.  Tweak drawing of alternate 'a' to
	get rid of artifacts.  Reset insert mode, cursor visibility, and
	scrolling regions when resetting.
2002-05-10 nalin
	* src/deepinvte.c: Fix IC, which should *always* be done in insert mode,
	from otaylor.  Make delete mode do nothing.
2002-05-09 nalin
	* src/deepinvte.c: Fixes to usage of iconv, from otaylor.  Remap certain
	characters which are missing in the current Xft font to similar
	characters if they are in the font, from otaylor.  Change default
	emulation to "xterm", cleaning up confusion over what standout really
	means.  Reorganize some internals.  Complain when an application sends
	us a key-press sequence, as if we knew what to do with one of those.
	Implement bt, ct, st.  Reimplement ta.
	* src/debug.c, src/debug.h: Added.
2002-05-08 nalin
	* src/deepinvte.c: Implement mouse motion-event and any-event tracking.
2002-05-07 nalin
	* src/deepinvte.c: Implement the rest of the special graphics characters.
2002-05-06 nalin
	* src/deepinvte.c: Finish implementing window-manipulation sequences.  Rename
	signals to be more consistent.  Add thin wrappers for emitting signals,
	and use them everywhere.  Support pangox even when XFT isn't available.
	Try to provide bold text again.  Add signals for most of the window
	manipulation control sequences.  Start handling mouse button events.
	Hide the mouse cursor when we get keyboard events.  Use a different
	mouse cursor if the child is mouse-aware.  Handle eA() by treating it as
	as().
	* src/caps.c, src/caps.h: Export definitions of DEEPINVTE_CAP_CSI and friends.
2002-05-04 nalin
	* src/deepinvte.c: Implement device-status-report and dec-device-status-
	report.  Clamp location values in sequence_handler_cm() to the
	dimensions of the terminal window so that resize(1) will work right.
	Start handling window-manipulation sequences.
2002-05-03 nalin
	* src/termcap.c: Export a deepinvte_termcap_strip() function for preprocessing
	escape sequences and whatnot from capability values.
	* src/typescrypt: Removed.
	* src/deepinvte.c: Pass the hard-coded xterm-specific capabilities through
	deepinvte_termcap_strip(), which fixes a few weird bugs.  Discard invalid
	might-be-control-sequence sequences, like other emulators do.  Don't
	consider modifier keys, by themselves, to be enough to scroll-on-key.
	When snapshotting, actually snapshot all of a row instead of just the
	last character.  Don't run past the end of snapshot contents when
	reading them.
	* src/deepinvteaccess.c: Clamp offsets so that they always sort right.
2002-05-02 nalin
	* src/termcap.c: Fix handling of triple-digit escaped characters,
	which weren't being processed right if the first digit was '1' instead
	of '0'.
	* src/trie.c: Rework trie matching to return the address of the
	character which ended the match attempt, which should cut down on
	useless initial-substring checks.  Fix a subtle bug which caused
	intermittent off-by-somenumber errors in the return address.
	* src/deepinvte.c:  Remove several gdk_window_scroll() calls which apparently
	aren't buffered.  Convert invalid multibyte characters to '?' instead of
	just dropping them.  Provide a means of setting the backspace/delete
	bindings.  Add a poor xlfd_from_pango mapping function which would need
	serious work to be useful.  Get rid of warnings when we're transparent
	and the root window pixmap isn't as big as the root window because it's
	been tiled.  Setup bindings using the export functions.  Set the default
	terminal size to 80x24 instead of 60x18, which was originally chosen for
	debugging purposes.  Don't use $SHELL as the command to invoke when
	starting up a default command (as in the test app) -- libtool wrappers
	keep screwing this up.  Don't limit the number of characters we skip
	over in invalid multibyte sequences -- sometimes that's not enough.
	Hook up ts/te, ks/ke sequence handlers.
	* src/deepinvteaccess.h: Fix a crashbug due to mismatch between parent field
	in the object's structure and its inherited object's type.  Fix more
	crash bugs due to initialization weirdness.  More to go.
2002-05-01 nalin
	* src/deepinvte.c: Try @pkgdatadir@/termcap/$TERM when reading termcap files.
	This fixes the app on systems with no /etc/termcap, and also speeds up
	loads and reduces memory consumption for xterm-color at the expense of
	making on-the-fly emulation changes impossible.  Don't xor reverse with
	itself when drawing characters (this broke when snapshotting was added).
	* termcaps/Makefile.am, termcaps/xterm-color: include a default termcap
	for xterm-color.
	* src/termcap.c src/termcap.h: make _find_boolean return a gboolean
	instead of an int.
	
2002-04-30 nalin
	* src/deepinvte.c: Disconnect from toplevel window_configure events at
	finalize-time.

2002-04-30 18:06  nalin
	* src/deepinvte.c: Track and free idle task tags properly.  Change F11 and
	F12 capabilities from 'k;' and 'F1' to 'F1' and 'F2'.  Send a NUL on
	control space. (#80350)  Allow setting and checking of word characters,
	and change select-by-word behavior to use the word character list.
	Emit "contents_changed" signals whenever the visible contents change,
	and "cursor_moved" when the cursor moves.  Add snapshotting method.
	Scroll when auto-margin handling moves the cursor to the next line.
	Assume that the locale charset is actually ISO-8859-1 when we're in
	a UTF-8 locale, so we don't toggle from UTF-8 to UTF-8.  Treat
	GDK_KP_Page_Up as a GDK_Page_Up, ditto for GDK_KP_Page_Down and
	GDK_KP_Tab and GDK_KP_Space.  Add deepinvte_terminal_get_font().  Don't bother
	messing with ring buffers if we're resizing them to their current sizes.
	* src/pty.c, src/deepinvte.c: Return a pid from deepinvte_terminal_fork_command().
	* src/deepinvteaccess.c, src/deepinvteaccess.h: Add DeepinvteTerminalAccessible object
	type.  It might even work, mostly.

2002-04-29 14:25  nalin
	* src/deepinvte.c: Handle me() by resetting all attributes (including
	colors, which we weren't resetting before).

2002-04-29 10:57  nalin
	* src/deepinvte.c: Handle kb by treating it as a backspace.  Make pangox
	rendering the default.  Handle control-key sequences better, unless
	the input method is hiding the modifiers from us.  Set the default
	TERM variable to "xterm-color".
	* src/deepinvte.c src/deepinvte.h: Get rid of deepinvte_terminal_set_core_font().

2002-04-26 19:14  nalin
	* src/deepinvte.c: Punt all changes to background images and transparency
	to an idle task.  Only insert newlines into the copy buffer when the
	last column in a given line doesn't have a character in it.
2002-04-26 17:35  notting
	* src/pty.c: use execlp/execvp

2002-04-26 12:09  nalin
	* src/Makefile.am, src/ring.c, ring.h: add a ring buffer for storing
	scrollback data.
	* src/deepinvte.c: use a ring buffer instead of a GArray to hold scrollback
	rows.  Fix a bug in that.  Try to preserve what the user sees when the
	scrollback size changes.
	* src/deepinvteapp.c: set a default scrollback buffer size of 100.
2002-04-26 00:49  nalin
	* Makefile.am: run autogen before tagging so that the tag is always
	correct.
	* README: update.
	* configure.in: add pangox to the list of GTK+ 2.0 modules we link with.
	* src/deepinvte.c, src/deepinvte.h: add deepinvte_terminal_set_scrollback_lines(), add
	some code to use pangox for rendering before trying core rendering,
	which should make font selection actually work.
	* deepinvte.spec: tweak description text.

2002-04-25 12:23  nalin

	* Makefile.am: Uncomment the tag target.

2002-04-25 12:22  nalin

	* HACKING, Makefile.am, configure.in: Add some targets for building
	tarballs in a hopefully-reproducible way.

2002-04-25 12:12  nalin

	* src/deepinvte.c: Let GDK_USE_XFT turn on Xft as well as
	DEEPINVTE_USE_XFT.

2002-04-25 01:45  nalin

	* src/deepinvte.c: Handle decoding errors
	better.

2002-04-25 00:49  nalin

	* deepinvte.spec: Include pkgconfig files in the package.

2002-04-25 00:43  nalin

	* src/deepinvte.c: src/deepinvte.c: Make multiple calls to
	set_background_transparent() and set_background_image() do the
	right thing.

2002-04-25 00:05  nalin

	* src/deepinvte.c: Reverse the sanity check in
	deepinvte_terminal_set_background_image_file() so that it rejects
	zero-length strings, not the other way around.

2002-04-24 23:54  nalin

	* src/trie.c: Demote some debug messages to being trie-specific
	debug messages.
	* src/deepinvte.h: Declare deepinvte_terminal_set_core_font() for non-Xft use.
	* src/deepinvte.c: Adjust idle priorities to make the terminal be more
	responsive. Fix a double-free that corrupted the heap on core font
	loads. Rework some pixbuf handling to only create new pixbufs when
	we need to modify what we are given. Revert a patch for profterm
	crackiness that's gone now.

2002-04-24 20:49  nalin

	* README: update to-do list.
	* autogen.sh: remove --disable-shared.
	* src/pty.c: remove a memory leak.
	* src/termcap.c: fix a possible read-before-start-of-buffer.
	* src/trie.c: use iconv instead of mbrstowcs, even if it's just
	ASCII->W_CHAR_T.
	* src/deepinvte.c: fix a few memory leaks. Only reset the IM context when
	we're realized, which is the only time we actually have an IM context.
	Don't create a copy of a pixbuf if we don't need to desaturate it,
	just ref it and use it directly.

2002-04-23 19:40  nalin

	* src/deepinvte.c: Display UTF-8 preedit strings properly, fix
	copy (no, really this time), and reset IM contexts when pasting
	text in.

2002-04-23 18:01  nalin

	* src/pty.c: Print debug messages before redirecting stdio.
	* src/deepinvte.c: Fix displaying of highlighted multi-column text.
	Use the GTK global setting for cursor blinking to control das
	blinkencursor.
	* src/deepinvte.h: Remove function for setting blinking timeout.

2002-04-23 15:54  nalin

	* src/pty.c: Fix a compile warning.

2002-04-23 15:54  nalin

	* autogen.sh: Default to include optimization, even for debugging. 
	* configure.in: Move AM_CONFIG_HEADER to the top.
	* src/pty.c: Create non-login shells by default (when argv is NULL,
	otherwise it's up to the caller anyway.
	*  src/deepinvte.c: Add mostly-complete input method support.
	* src/deepinvte.h: Add deepinvte_terminal_im_append_menuitems().

2002-04-23 13:04  hp

	* src/deepinvte.c, src/deepinvte.h: add deepinvte_terminal_set_font

2002-04-22 17:00  hp

	* src/deepinvte.c: when setting background color, use allocated color,
	and don't overwrite with bg of None

2002-04-22 16:50  hp

	* src/deepinvte.c: use gdk_rgb_find_color to allocate X colors

2002-04-22 16:35  nalin

	* src/deepinvte.c, src/deepinvte.h, src/deepinvteapp.c: Add deepinvte_terminal_feed_child() to
	send UTF-8 strings to the child process, and actually apply Havoc's
	fix right this time.

2002-04-22 09:56  nalin

	* src/deepinvte.c: Prevent double-free of incoming buffer
	(patch from Havoc).

2002-04-16 01:43  nalin

	* README: Fix typo.
	* src/deepinvte.c: Make blinking cursors stay on while the user is typing,
	desaturate images using integer math.

2002-04-05 00:58  nalin

	* deepinvte.spec: Add less useless descriptions. 
	* src/deepinvte.c: Fix an uninitialized variable and missing declaration
	error.

2002-03-24 21:52  nalin

	* src/deepinvte.c: Ensure that there's a data row
	whenever we scroll forward, fixing strangeness when I suspend and
	resume vim.

2002-03-24 19:08  nalin

	* src/deepinvte.c: Copy to clipboard synchronously, which
	fixes a number of problems.  Implement background transparency.

2002-03-17 20:59  nalin

	* src/deepinvte.c: Rework backgrounds to take advantage of gdk's automatic
	drawing.
	* src/deepinvteapp.c: Try to enable transparency if no background
	image is present.

2002-03-17 20:58  nalin

	* autogen.sh, configure.in: Adjust warnings used when in maintainer
	mode.

2002-03-17 01:15  nalin

	* src/deepinvte.c: Draw the cursor as an unfilled box when the widget does
	not have focus.

2002-03-17 01:04  nalin

	* src/deepinvte.c: Fix handling of scroll-on-output to always scroll when
	only we're at the bottom of the buffer.
	* src/deepinvteapp.c: Disable scroll-on-output by default.

2002-03-17 00:45  nalin

	* src/deepinvte.c src/deepinvte.h: Rework tiling of background images, and
	implement a blinking cursor.
	* src/deepinvteapp.c: Set blinking cursor by default.

2002-03-14 02:58  nalin

	* src/caps.c: Corrections to some xterm control sequences.

2002-03-14 02:32  nalin

	* configure.in: Define PACKAGE correctly.
	* src/deepinvte.c src/deepinvteapp.c: Move most of the tear-down code into the
	widget finalize method; handle EOF and widget destruction correctly
	to prevent segfaults.

2002-03-14 00:48  nalin

	* configure.in: * configure.in: Define PACKAGE.

2002-03-14 00:18  nalin

	* configure.in: Disable gdk-pixbuf's deprecated functions.
	* deepinvte.c: Discard non-ascii bytes to clear logjams that
	happen when we pass invalid terminal data to iconv().

2002-03-13 23:07  nalin

	* src/iso8859mode.c, src/utf8mode.c, src/deepinvte.c, src/deepinvte.h:
	add missing includes
	* deepinvte.c deepinvte.h: implement background color setting, provide
	a function for setting the defaults, tile background images
	properly

2002-03-13 21:12  nalin

	* configure.in, deepinvte.pc.in, src/deepinvte.c: Remove gdk-pixbuf-xlib
	dependency by using just gdk-pixbuf. 
	* src/deepinvte.c: Perform background image desaturation locally.

2002-03-13 14:37  nalin

	* src/deepinvte.c: Don't add the widget's allocation offsets
	when generating expose events.

2002-03-13 14:22  nalin

	* src/deepinvteapp.c: Don't try to use transparency for now.

2002-03-13 13:29  andersca

	* src/deepinvte.c, src/deepinvte.h: Add more functions that profterm can use.

2002-03-13 12:51  andersca

	* .cvsignore, deepinvte.pc.in: Silent cvs and add gdk-pixbuf-xlib to
	depends in the .pc.in file

2002-03-13 12:37  andersca

	* src/.cvsignore: Sliff sloff

2002-03-13 12:37  andersca

	* src/.cvsignore: sssh

2002-03-13 12:19  nalin

	* configure.in: Add gdk-pixbuf-xlib-2.0 as a module requirement.

2002-03-13 01:21  nalin

	* src/deepinvte.c, deepinvte.h, deepinvteapp.c: * deepinvte.c: Add set_size,
	set_audible_bell, set_scroll_on_output, set_scroll_on_keystroke,
	copy_clipboard, paste_clipboard, set_background_image,
	set_background_image_file, and set_background_saturation.  Also
	added a broken set_background_transparent.

2002-03-12 22:35  nalin

	* src/deepinvte.h: adjust the name of a declared function (was _set_size,
	is _size_set)

2002-03-12 22:11  nalin

	* src/deepinvte.c: Get rid of a global copy of the parent class.
	* deepinvte.c: Implement ec, ic, and IC handlers.

2002-03-12 22:10  nalin

	* src/deepinvte.h: Fix a typo in a comment (we don't "omit" signals).

2002-03-12 15:48  nalin

	* src/caps.c: Recognize xterm cursor-character-absolute sequence.
	* src/deepinvte.c: Handle cursor-character-absolute.  Change the default font
	to "mono" 14 point when using Xft.

2002-03-12 15:22  nalin

	* src/deepinvte.c: Handle the ve (cursor visible) control sequence.

2002-03-12 15:19  nalin

	* src/deepinvte.c: Handle dec private mode set (cursor visibility).

2002-03-12 15:13  nalin

	* src/deepinvte.c, src/deepinvte.h, src/deepinvteapp.h: fix signed/unsigned problems
	(fixes from alexl)

2002-03-11 20:29  nalin

	* src/deepinvte.c: Make scroll-on-output scroll on control sequences, too.

2002-03-11 20:19  nalin

	* src/Makefile.am, src/iso8859mode.c, src/utf8mode.c:
	Add simple programs for moving a terminal in and out of UTF-8 mode.
	* src/deepinvte.c: Be more verbose about iconv() errors.  Implement dc and DC
	handlers.  Handle auto-wrapping (the "am" flag).  Remove scrolling
	cheats from the al handler, which made the window jump.

2002-03-11 02:39  andersca

	* src/deepinvte.c: Add a finalize handler and free our title strings
	there.

2002-03-11 02:05  nalin

	* Makefile.am, configure.in, src/deepinvte.c, src/deepinvte.h, src/deepinvteapp.c:
	Emit "window_title_changed" and "icon_title_changed" when the
	titles change, and store the new values in a public field so that a
	handler can retrieve the values (patch from Anders Carlsson).

2002-03-11 01:54  nalin

	* deepinvte.pc.in: Add deepinvte.pc, from Anders Carlsson.

2002-03-11 01:47  nalin

	* src/deepinvte.c: Fix a duplicate-idle-handler bug.

2002-03-11 01:32  nalin

	* README, src/deepinvte.c: Fix selection (except maybe the end-of-line
	stuff).

2002-03-10 23:44  nalin

	* src/deepinvte.c: Whoops, I broke selection.  Fix that.  Implement
	selection by lines.

2002-03-10 23:08  nalin

	* src/deepinvte.c: Move character rendering into a common function so
	that the cursor is always drawn the same as other characters (fixes
	previous glitches when using Xft and when the cursor was over an
	alternate charset character).

2002-03-10 03:31  nalin

	* src/deepinvte.c: Differentiate between single, double, and triple-click
	for selection (still need to do something with that info).

2002-03-10 03:16  nalin

	* stamp-h.in: remove this file

2002-03-10 03:15  nalin

	* configure.in: Don't check for pango because we never call pango
	directly.

2002-03-10 03:13  nalin

	* src/deepinvte.c: Deselect properly when something else is inserted into
	the clipboard.

2002-03-10 02:26  nalin

	* AUTHORS, HACKING, README, src/utf8echo.c, src/deepinvte.c: Fix
	wide-character handling (now handles mid-stream encoding changes
	correctly).  Updates to the meager docs.

2002-03-09 02:41  nalin

	* Makefile.am, deepinvte.spec, src/Makefile.am: Add a .spec file (make
	dist; rpm -ts deepinvte*.tar.gz; rpm --rebuild) to make building a
	package easier.

2002-03-09 02:24  nalin

	* src/deepinvte.c: skip over space columns when selecting

2002-03-09 02:20  nalin

	* src/pty.c, src/deepinvteapp.c: Use a login shell by default.

2002-03-09 02:10  nalin

	* src/deepinvte.c, src/deepinvte.h, src/deepinvteapp.c: Rework input queueing to allow for
	feeding without a pty.	Use gdk_window_scroll() in _al and _up
	handlers, and in the _do handler, because it's usually faster.

2002-03-08 02:52  nalin

	* src/deepinvte.c: Implement copy and almost-correct selection
	highlighting.

2002-03-07 21:30  nalin

	* src/deepinvte.c: Use a queue for pasting data.  Try to get dragging
	detected right (doesn't work).

2002-03-05 19:21  nalin

	* src/deepinvte.c: Mark the beginning of a selected area.

2002-03-05 19:17  nalin

	* src/deepinvte.c: Make pasting asynchronous.

2002-03-05 19:07  nalin

	* src/deepinvte.c: actually free clipboard data when finished with it

2002-03-05 19:02  nalin

	* src/deepinvte.c: Implement middle-button paste.

2002-03-05 18:55  nalin

	* src/deepinvte.c: Properly convert from utf-8 or wchar_t strings when
	sending data to the pseudo-terminal.

2002-03-04 19:53  nalin

	* src/deepinvte.c: Implement shift/pgup/pgdown scrolling.  Make
	scroll-on-keypress and -on-output easier to toggle.

2002-03-04 19:26  nalin

	* src/deepinvte.c: Spec out the rest of the alternate characters I
	haven't implemented yet.  Remove a function that can't be easily
	written (scroll_rows).	Correctly update the insertion delta when
	scrolling, to fix man(1) again.

2002-03-04 19:16  nalin

	* src/deepinvte.c: Discard redundant cursor-position exposes.

2002-03-04 18:57  nalin

	* src/termcap.c, src/termcap.h, src/deepinvte.c: Use ssize_t to measure string
	offsets in termcap, and don't assume that all capabilities have
	values.  This fixes some nasty crashes.

2002-03-04 11:53  nalin

	* src/deepinvte.c: add a missing bounds-check in the erase-in-row
	function

2002-03-04 01:13  nalin

	* README, src/deepinvte.c: Send the slave pty's erase character when the
	user hits backspace.

2002-03-04 00:59  nalin

	* src/deepinvte.c: Draw cursors to fill the entire cell.  Draw the blank
	alternate character (ooh, tough).  Remove a redundant expose.

2002-03-03 23:49  nalin

	* src/trie.c: stop using wcsnlen, which is a GNU extension

2002-03-03 23:43  nalin

	* src/caps.h, src/pty.h, src/termcap.h, src/trie.h, src/deepinvte.c,
	src/deepinvte.h: Add support for the line-drawing characters in the special
	characters and line-drawing character set. (See
	[http://vt100.net/docs/vt102-ug/table5-13.html].)

2002-03-03 21:57  nalin

	* src/pty.c, src/pty.h, src/deepinvte.c: Properly differentiate insertion
	delta (working screen) from scrolling delta.	Add environment setting
	to the pty code.

2002-02-27 21:54  nalin

	* src/trie.c, src/deepinvte.c, src/deepinvte.h: Make the Xft support use long-lived
	data items.  Clean up a lot of other Xft-related code.

2002-02-27 10:45  nalin

	* src/deepinvte.c: actually hook up the nd handler to the "nd" sequence

2002-02-27 00:05  nalin

	* autogen.sh, configure.in, src/deepinvte.c, src/deepinvte.h: - Add sub-optimal
	Xft rendering (set DEEPINVTE_USE_XFT to "1" to try it); still needs
	quite a bit of work to be useful.  Implement character-position-absolute
	and line-position-absolute, which I  think are the only sequences which
	emacs uses and which weren't implemented.

2002-02-25 12:43  nalin

	* src/Makefile.am: distcheck fixes

2002-02-25 12:41  nalin

	* README: add that line-drawing does not work to README

2002-02-25 12:40  nalin

	* configure.in, src/Makefile.am: tree fixups

2002-02-25 12:38  nalin

	* configure.in: fix autoconf reference file problem

2002-02-25 12:38  nalin

	* src/Makefile.in: remove stuff which should never have been added

2002-02-25 12:37  nalin

	* configure.ac, configure.in, src/Makefile.in: rename configure.ac
	to configure.in, remove 2.5isms

2002-02-25 12:35  nalin

	* doc/ctlseqs.ps, Makefile.in, aclocal.m4, config.h.in, configure:
	remove stuff that should never have been in there

2002-02-25 12:30  nalin

	* AUTHORS, ChangeLog, Makefile.am, NEWS, README, autogen.sh,
	configure.ac, COPYING, HACKING, Makefile.in, aclocal.m4,
	config.h.in, configure, stamp-h.in, doc/ctlseqs.ms, doc/ctlseqs.ps,
	doc/readme.txt, doc/vttest.tar.gz, src/Makefile.am,
	src/Makefile.in, src/caps.c, src/caps.h, src/interpret.c,
	src/marshal.list, src/pty.c, src/pty.h, src/termcap.c,
	src/termcap.h, src/trie.c, src/trie.h, src/typescript,
	src/utf8echo.c, src/deepinvte.c, src/deepinvte.h, src/deepinvteapp.c: Initial
	revision

2002-02-25 12:30  nalin

	* AUTHORS, ChangeLog, Makefile.am, NEWS, README, autogen.sh,
	configure.ac, COPYING, HACKING, Makefile.in, aclocal.m4,
	config.h.in, configure, stamp-h.in, doc/ctlseqs.ms, doc/ctlseqs.ps,
	doc/readme.txt, doc/vttest.tar.gz, src/Makefile.am,
	src/Makefile.in, src/caps.c, src/caps.h, src/interpret.c,
	src/marshal.list, src/pty.c, src/pty.h, src/termcap.c,
	src/termcap.h, src/trie.c, src/trie.h, src/typescript,
	src/utf8echo.c, src/deepinvte.c, src/deepinvte.h, src/deepinvteapp.c: imported from
	private cvs

Local Variables:
coding: utf-8
End:
vim: encoding=utf-8:
